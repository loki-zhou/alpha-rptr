{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.28684157990820464, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.10000000000000002, "total_loss": 0.0014719244448520663, "policy_loss": -0.00012338254606631029, "vf_loss": 0.5393574733527438, "vf_explained_var": -0.061125897111431245, "kl": 0.0077068655428691865, "entropy": 0.6864958316568406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 248.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 21841.522, "sample_time_ms": 11613.221, "load_time_ms": 26.002, "load_throughput": 153836.144, "learn_time_ms": 10195.328, "learn_throughput": 392.337, "synch_weights_time_ms": 6.972}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "40f87_00000", "date": "2023-09-21_12-21-25", "timestamp": 1695270085, "time_this_iter_s": 21.85452103614807, "time_total_s": 21.85452103614807, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 21.85452103614807, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.97741935483871, "ram_util_percent": 61.96129032258062}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.21359778344330768, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.007000000000000003, "total_loss": 0.0027074743317620407, "policy_loss": -0.002563590071194114, "vf_loss": 0.43899304680376044, "vf_explained_var": -0.28322808528619425, "kl": 0.026135816326499296, "entropy": 0.6627638776215815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 744.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 21891.362, "sample_time_ms": 11608.373, "load_time_ms": 25.001, "load_throughput": 159994.049, "learn_time_ms": 10250.502, "learn_throughput": 390.225, "synch_weights_time_ms": 7.487}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "40f87_00000", "date": "2023-09-21_12-21-47", "timestamp": 1695270107, "time_this_iter_s": 21.953225135803223, "time_total_s": 43.807746171951294, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 43.807746171951294, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.60322580645161, "ram_util_percent": 62.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22698219882083998, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.003, "total_loss": -0.03191542174036224, "policy_loss": -0.040046948138032966, "vf_loss": 0.2555622011272898, "vf_explained_var": -0.2677538385314326, "kl": 0.027019886362266363, "entropy": 0.6108256119393534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 1240.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 21996.627, "sample_time_ms": 11601.561, "load_time_ms": 24.334, "load_throughput": 164378.833, "learn_time_ms": 10363.078, "learn_throughput": 385.986, "synch_weights_time_ms": 7.654}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "40f87_00000", "date": "2023-09-21_12-22-09", "timestamp": 1695270129, "time_this_iter_s": 22.219139337539673, "time_total_s": 66.02688550949097, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 66.02688550949097, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.66451612903226, "ram_util_percent": 62.17419354838711}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.22621748342569317, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 0.00098, "total_loss": -0.04217065868320905, "policy_loss": -0.051594092734082934, "vf_loss": 0.43244376153715197, "vf_explained_var": -0.3888678173384359, "kl": 0.020844873472625626, "entropy": 0.5937938256970337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 1736.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 22030.513, "sample_time_ms": 11576.113, "load_time_ms": 24.25, "load_throughput": 164946.219, "learn_time_ms": 10422.661, "learn_throughput": 383.779, "synch_weights_time_ms": 7.489}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "40f87_00000", "date": "2023-09-21_12-22-31", "timestamp": 1695270151, "time_this_iter_s": 22.14514708518982, "time_total_s": 88.17203259468079, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 88.17203259468079, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.799999999999997, "ram_util_percent": 62.241935483870954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4204907985854774, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.00094, "total_loss": -0.053332492791777174, "policy_loss": -0.07324755753304471, "vf_loss": 0.17243622158533864, "vf_explained_var": -0.2495461869384012, "kl": 0.02947825765117044, "entropy": 0.5481214973955385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 2232.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 22120.032, "sample_time_ms": 11570.827, "load_time_ms": 24.206, "load_throughput": 165247.183, "learn_time_ms": 10516.814, "learn_throughput": 380.343, "synch_weights_time_ms": 7.986}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "40f87_00000", "date": "2023-09-21_12-22-54", "timestamp": 1695270174, "time_this_iter_s": 22.49010920524597, "time_total_s": 110.66214179992676, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 110.66214179992676, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.796875, "ram_util_percent": 62.22187500000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.351622877357107, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0008999999999999999, "total_loss": -0.043003147499891176, "policy_loss": -0.06246502644001251, "vf_loss": 0.2708427322307421, "vf_explained_var": -0.2617658915058259, "kl": 0.019194855622680702, "entropy": 0.5511242017870949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 2728.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 22196.727, "sample_time_ms": 11617.102, "load_time_ms": 24.338, "load_throughput": 164352.532, "learn_time_ms": 10547.132, "learn_throughput": 379.25, "synch_weights_time_ms": 7.989}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "40f87_00000", "date": "2023-09-21_12-23-16", "timestamp": 1695270196, "time_this_iter_s": 22.59319758415222, "time_total_s": 133.25533938407898, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 133.25533938407898, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.645161290322584, "ram_util_percent": 62.33548387096773}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3118947873703174, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0008599999999999998, "total_loss": -0.05618897332216523, "policy_loss": -0.07499452911501829, "vf_loss": 0.22080389389227476, "vf_explained_var": -0.15246291098094755, "kl": 0.01855157746275572, "entropy": 0.5482742269072802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 3224.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 22203.002, "sample_time_ms": 11610.406, "load_time_ms": 24.289, "load_throughput": 164680.403, "learn_time_ms": 10560.317, "learn_throughput": 378.777, "synch_weights_time_ms": 7.847}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "40f87_00000", "date": "2023-09-21_12-23-39", "timestamp": 1695270219, "time_this_iter_s": 22.2536563873291, "time_total_s": 155.50899577140808, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 155.50899577140808, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.448387096774194, "ram_util_percent": 62.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3137024421575329, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0008199999999999998, "total_loss": -0.0549307840157135, "policy_loss": -0.07528212416953524, "vf_loss": 0.22825546691855114, "vf_explained_var": -0.06131117069913495, "kl": 0.02007754434329399, "entropy": 0.524568006456379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 3720.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 22185.967, "sample_time_ms": 11602.583, "load_time_ms": 24.128, "load_throughput": 165780.105, "learn_time_ms": 10551.014, "learn_throughput": 379.11, "synch_weights_time_ms": 7.741}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "40f87_00000", "date": "2023-09-21_12-24-01", "timestamp": 1695270241, "time_this_iter_s": 22.080716848373413, "time_total_s": 177.5897126197815, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 177.5897126197815, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.519354838709678, "ram_util_percent": 62.222580645161266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31682873508262055, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.00078, "total_loss": -0.06089513820047761, "policy_loss": -0.08535837954203147, "vf_loss": 0.1749029248472183, "vf_explained_var": -0.10750339372504142, "kl": 0.01609596778237497, "entropy": 0.544080026628029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 4216.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 22145.48, "sample_time_ms": 11588.353, "load_time_ms": 24.003, "load_throughput": 166644.716, "learn_time_ms": 10524.912, "learn_throughput": 380.051, "synch_weights_time_ms": 7.767}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "40f87_00000", "date": "2023-09-21_12-24-22", "timestamp": 1695270262, "time_this_iter_s": 21.835580587387085, "time_total_s": 199.42529320716858, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 199.42529320716858, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.20322580645162, "ram_util_percent": 62.18064516129033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.29355040368353646, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0007399999999999999, "total_loss": -0.04294385024038474, "policy_loss": -0.06262553442100456, "vf_loss": 0.24910864955745637, "vf_explained_var": -0.2798192581582454, "kl": 0.012942732819633625, "entropy": 0.5673898767319417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 4712.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 22104.558, "sample_time_ms": 11574.409, "load_time_ms": 24.003, "load_throughput": 166647.787, "learn_time_ms": 10497.959, "learn_throughput": 381.026, "synch_weights_time_ms": 7.687}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "40f87_00000", "date": "2023-09-21_12-24-44", "timestamp": 1695270284, "time_this_iter_s": 21.74928379058838, "time_total_s": 221.17457699775696, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 221.17457699775696, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.24, "ram_util_percent": 62.29333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36307627291628913, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0006999999999999999, "total_loss": -0.04039769331481488, "policy_loss": -0.06493406073798635, "vf_loss": 0.1034588111609581, "vf_explained_var": -0.28069529069527505, "kl": 0.016148822986396697, "entropy": 0.552974438595195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 5208.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 22149.547, "sample_time_ms": 11584.617, "load_time_ms": 23.706, "load_throughput": 168736.998, "learn_time_ms": 10532.936, "learn_throughput": 379.761, "synch_weights_time_ms": 7.789}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "40f87_00000", "date": "2023-09-21_12-25-07", "timestamp": 1695270307, "time_this_iter_s": 22.304423570632935, "time_total_s": 243.4790005683899, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 243.4790005683899, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 30.378125, "ram_util_percent": 61.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4660650338797319, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0006600000000000002, "total_loss": -0.051496580228089325, "policy_loss": -0.0776326154319254, "vf_loss": 0.19701714057760733, "vf_explained_var": 0.03909917704520687, "kl": 0.017195941020022035, "entropy": 0.5991317626209028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 5704.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 22188.044, "sample_time_ms": 11586.542, "load_time_ms": 23.809, "load_throughput": 168007.034, "learn_time_ms": 10569.408, "learn_throughput": 378.451, "synch_weights_time_ms": 7.786}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "40f87_00000", "date": "2023-09-21_12-25-29", "timestamp": 1695270329, "time_this_iter_s": 22.340176105499268, "time_total_s": 265.81917667388916, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 265.81917667388916, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.735483870967737, "ram_util_percent": 61.58064516129032}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4221104126003, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.00062, "total_loss": -0.05118361978055609, "policy_loss": -0.07537276540366997, "vf_loss": 0.18088985611534408, "vf_explained_var": -0.17800103560570749, "kl": 0.015915099669538923, "entropy": 0.578926951534325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 6200.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 22189.46, "sample_time_ms": 11579.078, "load_time_ms": 23.911, "load_throughput": 167283.692, "learn_time_ms": 10578.284, "learn_throughput": 378.133, "synch_weights_time_ms": 7.687}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "40f87_00000", "date": "2023-09-21_12-25-51", "timestamp": 1695270351, "time_this_iter_s": 22.233309745788574, "time_total_s": 288.05248641967773, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 288.05248641967773, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.18387096774193, "ram_util_percent": 61.5290322580645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2945598635462023, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.00058, "total_loss": -0.0453735729867232, "policy_loss": -0.06613477275820309, "vf_loss": 0.13325492567532965, "vf_explained_var": 0.022490642964839935, "kl": 0.01366115271618391, "entropy": 0.5295045112049387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 6696.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 22207.369, "sample_time_ms": 11595.872, "load_time_ms": 24.211, "load_throughput": 165212.034, "learn_time_ms": 10578.999, "learn_throughput": 378.108, "synch_weights_time_ms": 7.687}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "40f87_00000", "date": "2023-09-21_12-26-13", "timestamp": 1695270373, "time_this_iter_s": 22.3232319355011, "time_total_s": 310.37571835517883, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 310.37571835517883, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.07741935483871, "ram_util_percent": 61.554838709677426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3176059646291598, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0005400000000000003, "total_loss": -0.04908572691290887, "policy_loss": -0.07162672524047535, "vf_loss": 0.0787933208198557, "vf_explained_var": -0.11258842339438777, "kl": 0.014836622112084743, "entropy": 0.5389054664560864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 7192.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 22178.946, "sample_time_ms": 11603.445, "load_time_ms": 24.108, "load_throughput": 165919.503, "learn_time_ms": 10543.405, "learn_throughput": 379.384, "synch_weights_time_ms": 7.387}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "40f87_00000", "date": "2023-09-21_12-26-36", "timestamp": 1695270396, "time_this_iter_s": 22.206908226013184, "time_total_s": 332.582626581192, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 332.582626581192, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 29.209677419354836, "ram_util_percent": 61.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3051592271714922, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0005000000000000002, "total_loss": -0.05946373455076208, "policy_loss": -0.08095346465462729, "vf_loss": 0.17003873315068982, "vf_explained_var": -0.18543534425477828, "kl": 0.01413842079935265, "entropy": 0.5445761449274517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 7688.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 22140.268, "sample_time_ms": 11578.367, "load_time_ms": 23.971, "load_throughput": 166866.243, "learn_time_ms": 10529.643, "learn_throughput": 379.88, "synch_weights_time_ms": 7.589}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "40f87_00000", "date": "2023-09-21_12-26-58", "timestamp": 1695270418, "time_this_iter_s": 22.205453395843506, "time_total_s": 354.7880799770355, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 354.7880799770355, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 28.112499999999997, "ram_util_percent": 61.559375}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33201116440637457, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0004600000000000001, "total_loss": -0.05166294277390285, "policy_loss": -0.07375993819263268, "vf_loss": 0.12582287025607883, "vf_explained_var": 0.006131145261949108, "kl": 0.014541177986483416, "entropy": 0.5239526199837846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.70967741935483, "num_grad_updates_lifetime": 8184.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 22149.039, "sample_time_ms": 11586.785, "load_time_ms": 23.975, "load_throughput": 166843.675, "learn_time_ms": 10529.792, "learn_throughput": 379.875, "synch_weights_time_ms": 7.589}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 2, "training_iteration": 17, "trial_id": "40f87_00000", "date": "2023-09-21_12-27-20", "timestamp": 1695270440, "time_this_iter_s": 22.34143376350403, "time_total_s": 377.12951374053955, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 377.12951374053955, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.480645161290326, "ram_util_percent": 61.49354838709677}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3056236399307607, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0004200000000000002, "total_loss": -0.04909819262121023, "policy_loss": -0.0677254783403764, "vf_loss": 0.13431717852701344, "vf_explained_var": -0.17956227713054226, "kl": 0.012256033453907881, "entropy": 0.5096614461752677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 8680.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 22207.053, "sample_time_ms": 11593.282, "load_time_ms": 24.074, "load_throughput": 166152.176, "learn_time_ms": 10581.41, "learn_throughput": 378.021, "synch_weights_time_ms": 7.689}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 2, "training_iteration": 18, "trial_id": "40f87_00000", "date": "2023-09-21_12-27-43", "timestamp": 1695270463, "time_this_iter_s": 22.660481214523315, "time_total_s": 399.78999495506287, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 399.78999495506287, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.4375, "ram_util_percent": 61.653125}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3099368952905699, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0003800000000000001, "total_loss": -0.0361529927683859, "policy_loss": -0.05343880289485476, "vf_loss": 0.09340570010470166, "vf_explained_var": -0.0742948993800148, "kl": 0.011375452989213034, "entropy": 0.4934297325990854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 9176.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 22310.65, "sample_time_ms": 11644.856, "load_time_ms": 24.174, "load_throughput": 165466.875, "learn_time_ms": 10633.43, "learn_throughput": 376.172, "synch_weights_time_ms": 7.592}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 2, "training_iteration": 19, "trial_id": "40f87_00000", "date": "2023-09-21_12-28-06", "timestamp": 1695270486, "time_this_iter_s": 22.870554208755493, "time_total_s": 422.66054916381836, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 422.66054916381836, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.990625, "ram_util_percent": 62.21875}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2724850994324492, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0003400000000000001, "total_loss": -0.042964256034352846, "policy_loss": -0.05993460430105305, "vf_loss": 0.12805029487372527, "vf_explained_var": -0.12808646610186947, "kl": 0.01116546129609397, "entropy": 0.5123025524399935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 9672.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 22379.779, "sample_time_ms": 11675.286, "load_time_ms": 24.174, "load_throughput": 165466.06, "learn_time_ms": 10672.126, "learn_throughput": 374.808, "synch_weights_time_ms": 7.595}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 2, "training_iteration": 20, "trial_id": "40f87_00000", "date": "2023-09-21_12-28-28", "timestamp": 1695270508, "time_this_iter_s": 22.44054889678955, "time_total_s": 445.1010980606079, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 445.1010980606079, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.793548387096777, "ram_util_percent": 62.129032258064534}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3041137726226401, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0003, "total_loss": -0.055117842181765984, "policy_loss": -0.07259236228081488, "vf_loss": 0.10152623512511773, "vf_explained_var": -0.18877686331829718, "kl": 0.011499172066046481, "entropy": 0.5185465173375222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 10168.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 22376.03, "sample_time_ms": 11666.301, "load_time_ms": 24.671, "load_throughput": 162133.482, "learn_time_ms": 10676.962, "learn_throughput": 374.638, "synch_weights_time_ms": 7.498}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 2, "training_iteration": 21, "trial_id": "40f87_00000", "date": "2023-09-21_12-28-51", "timestamp": 1695270531, "time_this_iter_s": 22.26691198348999, "time_total_s": 467.3680100440979, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 467.3680100440979, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.777419354838717, "ram_util_percent": 62.06451612903223}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.33133172305421005, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0002599999999999999, "total_loss": -0.054142673627563545, "policy_loss": -0.0746273293923643, "vf_loss": 0.1364154105765685, "vf_explained_var": -0.07106405640802076, "kl": 0.013478856606746959, "entropy": 0.5187952203015166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 10664.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 22351.221, "sample_time_ms": 11667.264, "load_time_ms": 24.568, "load_throughput": 162813.354, "learn_time_ms": 10651.393, "learn_throughput": 375.538, "synch_weights_time_ms": 7.298}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 2, "training_iteration": 22, "trial_id": "40f87_00000", "date": "2023-09-21_12-29-13", "timestamp": 1695270553, "time_this_iter_s": 22.091106414794922, "time_total_s": 489.4591164588928, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 489.4591164588928, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 28.425806451612896, "ram_util_percent": 62.04838709677419}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31290035559645585, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.0002200000000000001, "total_loss": -0.04022708651234185, "policy_loss": -0.05594147960965206, "vf_loss": 0.14249443502405718, "vf_explained_var": -0.10807102786437157, "kl": 0.010337543137090099, "entropy": 0.5104454675869595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 11160.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 22340.609, "sample_time_ms": 11673.638, "load_time_ms": 24.568, "load_throughput": 162814.302, "learn_time_ms": 10634.321, "learn_throughput": 376.141, "synch_weights_time_ms": 7.385}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 2, "training_iteration": 23, "trial_id": "40f87_00000", "date": "2023-09-21_12-29-35", "timestamp": 1695270575, "time_this_iter_s": 22.12820029258728, "time_total_s": 511.5873167514801, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 511.5873167514801, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 29.119354838709683, "ram_util_percent": 62.067741935483845}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3105238034660297, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.00018000000000000007, "total_loss": -0.048659997716435276, "policy_loss": -0.06389744190645645, "vf_loss": 0.08783967612356308, "vf_explained_var": -0.11926864279854682, "kl": 0.010027100746049336, "entropy": 0.5306161249116543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 11656.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 22330.599, "sample_time_ms": 11669.654, "load_time_ms": 24.168, "load_throughput": 165507.521, "learn_time_ms": 10628.797, "learn_throughput": 376.336, "synch_weights_time_ms": 7.383}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 2, "training_iteration": 24, "trial_id": "40f87_00000", "date": "2023-09-21_12-29-57", "timestamp": 1695270597, "time_this_iter_s": 22.224151134490967, "time_total_s": 533.8114678859711, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 533.8114678859711, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 32.854838709677416, "ram_util_percent": 61.55483870967742}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3363991869132846, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.00014000000000000001, "total_loss": -0.054919675730484264, "policy_loss": -0.06974033953479046, "vf_loss": 0.14640008680702699, "vf_explained_var": -0.09956303683500137, "kl": 0.00974882241632646, "entropy": 0.5395139319401595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 12152.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 22288.76, "sample_time_ms": 11656.353, "load_time_ms": 24.268, "load_throughput": 164825.087, "learn_time_ms": 10600.158, "learn_throughput": 377.353, "synch_weights_time_ms": 7.283}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 2, "training_iteration": 25, "trial_id": "40f87_00000", "date": "2023-09-21_12-30-19", "timestamp": 1695270619, "time_this_iter_s": 21.787489652633667, "time_total_s": 555.5989575386047, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 555.5989575386047, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.522580645161288, "ram_util_percent": 59.822580645161295}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30171499118929906, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 0.00010000000000000003, "total_loss": -0.05369275850300197, "policy_loss": -0.06371283226338076, "vf_loss": 0.2309449100341167, "vf_explained_var": -0.13810347297018574, "kl": 0.006582373175132531, "entropy": 0.5257364250719547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 12648.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 22243.964, "sample_time_ms": 11636.482, "load_time_ms": 24.305, "load_throughput": 164573.186, "learn_time_ms": 10575.599, "learn_throughput": 378.229, "synch_weights_time_ms": 6.978}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 2, "training_iteration": 26, "trial_id": "40f87_00000", "date": "2023-09-21_12-30-41", "timestamp": 1695270641, "time_this_iter_s": 21.75808811187744, "time_total_s": 577.3570456504822, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 577.3570456504822, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 30.213333333333335, "ram_util_percent": 59.82666666666666}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3432140526992659, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.960000000000002e-05, "total_loss": -0.04804810784492387, "policy_loss": -0.057979537437331016, "vf_loss": 0.12758506105972395, "vf_explained_var": -0.32289508045200377, "kl": 0.006530811317475528, "entropy": 0.5488166362648049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 13144.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 22199.284, "sample_time_ms": 11627.163, "load_time_ms": 24.284, "load_throughput": 164716.989, "learn_time_ms": 10540.26, "learn_throughput": 379.497, "synch_weights_time_ms": 7.178}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 2, "training_iteration": 27, "trial_id": "40f87_00000", "date": "2023-09-21_12-31-03", "timestamp": 1695270663, "time_this_iter_s": 21.89556646347046, "time_total_s": 599.2526121139526, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 599.2526121139526, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.661290322580644, "ram_util_percent": 59.81290322580645}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32458117078509063, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.92e-05, "total_loss": -0.026669366585631526, "policy_loss": -0.03752897833023341, "vf_loss": 0.10206924639116492, "vf_explained_var": -0.21700496274617412, "kl": 0.007143641436933871, "entropy": 0.5521098506306449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 13640.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 22110.382, "sample_time_ms": 11614.414, "load_time_ms": 24.284, "load_throughput": 164717.474, "learn_time_ms": 10464.105, "learn_throughput": 382.259, "synch_weights_time_ms": 7.178}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 2, "training_iteration": 28, "trial_id": "40f87_00000", "date": "2023-09-21_12-31-24", "timestamp": 1695270684, "time_this_iter_s": 21.771830558776855, "time_total_s": 621.0244426727295, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 621.0244426727295, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.551612903225806, "ram_util_percent": 59.84193548387096}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3664078450791778, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.88e-05, "total_loss": -0.05492635204967472, "policy_loss": -0.06973247988225334, "vf_loss": 0.11797205019261568, "vf_explained_var": -0.04844219129412405, "kl": 0.00974112340987764, "entropy": 0.5604835515541415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 14136.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 22003.828, "sample_time_ms": 11561.914, "load_time_ms": 24.184, "load_throughput": 165398.037, "learn_time_ms": 10410.052, "learn_throughput": 384.244, "synch_weights_time_ms": 7.178}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 2, "training_iteration": 29, "trial_id": "40f87_00000", "date": "2023-09-21_12-31-46", "timestamp": 1695270706, "time_this_iter_s": 21.80468487739563, "time_total_s": 642.8291275501251, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 642.8291275501251, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.133333333333333, "ram_util_percent": 59.84666666666668}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36961013592419123, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.839999999999999e-05, "total_loss": -0.05994056522233164, "policy_loss": -0.07380911564940752, "vf_loss": 0.1708160996316902, "vf_explained_var": -0.05669989989649865, "kl": 0.009120308672401515, "entropy": 0.55927944988493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 14632.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 21943.454, "sample_time_ms": 11546.209, "load_time_ms": 24.082, "load_throughput": 166102.333, "learn_time_ms": 10365.482, "learn_throughput": 385.896, "synch_weights_time_ms": 7.181}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 2, "training_iteration": 30, "trial_id": "40f87_00000", "date": "2023-09-21_12-32-08", "timestamp": 1695270728, "time_this_iter_s": 21.837803840637207, "time_total_s": 664.6669313907623, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 664.6669313907623, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.04193548387096, "ram_util_percent": 59.85806451612902}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3548208989142891, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.800000000000001e-05, "total_loss": -0.04711154127125478, "policy_loss": -0.05987588547251958, "vf_loss": 0.1142686317194133, "vf_explained_var": 0.004644948989152908, "kl": 0.008396982305967082, "entropy": 0.5372711650786861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 15128.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 21886.355, "sample_time_ms": 11532.134, "load_time_ms": 23.682, "load_throughput": 168908.067, "learn_time_ms": 10322.863, "learn_throughput": 387.489, "synch_weights_time_ms": 7.176}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 2, "training_iteration": 31, "trial_id": "40f87_00000", "date": "2023-09-21_12-32-30", "timestamp": 1695270750, "time_this_iter_s": 21.6959388256073, "time_total_s": 686.3628702163696, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 686.3628702163696, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 31.23333333333333, "ram_util_percent": 59.86000000000002}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35202104688411756, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.76e-05, "total_loss": -0.059364023261643466, "policy_loss": -0.0713962867223252, "vf_loss": 0.16887417450667389, "vf_explained_var": -0.08954322434240772, "kl": 0.007911358779202671, "entropy": 0.553142964239082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 15624.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 21867.719, "sample_time_ms": 11517.455, "load_time_ms": 23.682, "load_throughput": 168907.216, "learn_time_ms": 10318.81, "learn_throughput": 387.642, "synch_weights_time_ms": 7.372}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 2, "training_iteration": 32, "trial_id": "40f87_00000", "date": "2023-09-21_12-32-52", "timestamp": 1695270772, "time_this_iter_s": 21.903724193572998, "time_total_s": 708.2665944099426, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 708.2665944099426, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.487096774193553, "ram_util_percent": 59.86129032258063}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3421995708298299, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.719999999999999e-05, "total_loss": -0.049581159698596645, "policy_loss": -0.06100113224719309, "vf_loss": 0.21293544899972697, "vf_explained_var": -0.10726212626022677, "kl": 0.007505302377741523, "entropy": 0.5440238653531959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 16120.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 42.239999999999995, "position_changes_min": 42.0, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}}, "episode_reward_max": -635.5095288966203, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -640.3843844003908, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203], "episode_lengths": [33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47680628039914646, "mean_inference_ms": 3.079014779371337, "mean_action_processing_ms": 0.14311296617783875, "mean_env_wait_ms": 2.0289090916583206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.04998445510864258, "StateBufferConnector_ms": 0.04978179931640625, "ViewRequirementAgentConnector_ms": 0.20149946212768555}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 21866.395, "sample_time_ms": 11520.96, "load_time_ms": 23.579, "load_throughput": 169642.64, "learn_time_ms": 10314.07, "learn_throughput": 387.82, "synch_weights_time_ms": 7.386}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 2, "training_iteration": 33, "trial_id": "40f87_00000", "date": "2023-09-21_12-33-14", "timestamp": 1695270794, "time_this_iter_s": 22.115960121154785, "time_total_s": 730.3825545310974, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 730.3825545310974, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 29.474193548387095, "ram_util_percent": 59.845161290322594}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3378790037466153, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.68e-05, "total_loss": -0.04317275224246025, "policy_loss": -0.05462051629582411, "vf_loss": 0.12263784621421608, "vf_explained_var": 0.043604097178866784, "kl": 0.007529546517833369, "entropy": 0.48435394958622996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.6774193548387, "num_grad_updates_lifetime": 16616.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 21869.926, "sample_time_ms": 11531.136, "load_time_ms": 23.679, "load_throughput": 168928.135, "learn_time_ms": 10307.223, "learn_throughput": 388.077, "synch_weights_time_ms": 7.489}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 4, "training_iteration": 34, "trial_id": "40f87_00000", "date": "2023-09-21_12-33-36", "timestamp": 1695270816, "time_this_iter_s": 22.259467840194702, "time_total_s": 752.6420223712921, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 752.6420223712921, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 29.025806451612898, "ram_util_percent": 59.75161290322582}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.34748402192828154, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.639999999999997e-05, "total_loss": -0.035560733221861866, "policy_loss": -0.04607439044893028, "vf_loss": 0.10311500357103444, "vf_explained_var": -0.16412972791060323, "kl": 0.006915782737959044, "entropy": 0.5015327520067653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 17112.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 21911.005, "sample_time_ms": 11547.564, "load_time_ms": 24.079, "load_throughput": 166121.083, "learn_time_ms": 10331.47, "learn_throughput": 387.167, "synch_weights_time_ms": 7.492}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 4, "training_iteration": 35, "trial_id": "40f87_00000", "date": "2023-09-21_12-33-58", "timestamp": 1695270838, "time_this_iter_s": 22.19827389717102, "time_total_s": 774.8402962684631, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 774.8402962684631, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 29.938709677419357, "ram_util_percent": 59.803225806451614}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35496621700604597, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.599999999999999e-05, "total_loss": -0.03965918961236434, "policy_loss": -0.05215733553796458, "vf_loss": 0.10646897999780072, "vf_explained_var": 0.036932238167332064, "kl": 0.008222221686656228, "entropy": 0.48588051731067317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 17608.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 21944.517, "sample_time_ms": 11572.573, "load_time_ms": 24.079, "load_throughput": 166122.234, "learn_time_ms": 10339.77, "learn_throughput": 386.856, "synch_weights_time_ms": 7.696}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 4, "training_iteration": 36, "trial_id": "40f87_00000", "date": "2023-09-21_12-34-21", "timestamp": 1695270861, "time_this_iter_s": 22.094573736190796, "time_total_s": 796.9348700046539, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 796.9348700046539, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 30.893548387096775, "ram_util_percent": 59.845161290322565}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3594067334798315, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.559999999999999e-05, "total_loss": -0.036042494046869836, "policy_loss": -0.04648304495434962, "vf_loss": 0.09226866707491178, "vf_explained_var": -0.08346803438278937, "kl": 0.0068683605534879235, "entropy": 0.5021669567833024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 18104.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 21934.046, "sample_time_ms": 11561.822, "load_time_ms": 23.997, "load_throughput": 166690.008, "learn_time_ms": 10339.647, "learn_throughput": 386.86, "synch_weights_time_ms": 7.981}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 4, "training_iteration": 37, "trial_id": "40f87_00000", "date": "2023-09-21_12-34-42", "timestamp": 1695270882, "time_this_iter_s": 21.789854526519775, "time_total_s": 818.7247245311737, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 818.7247245311737, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 30.912903225806446, "ram_util_percent": 59.858064516129055}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3801216212131323, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.520000000000001e-05, "total_loss": -0.04321059419101315, "policy_loss": -0.05559029925432462, "vf_loss": 0.09640703385605687, "vf_explained_var": -0.09824096026920504, "kl": 0.008144898222114604, "entropy": 0.5103357755729268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 18600.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 21958.281, "sample_time_ms": 11569.334, "load_time_ms": 23.997, "load_throughput": 166688.352, "learn_time_ms": 10356.472, "learn_throughput": 386.232, "synch_weights_time_ms": 7.878}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 4, "training_iteration": 38, "trial_id": "40f87_00000", "date": "2023-09-21_12-35-04", "timestamp": 1695270904, "time_this_iter_s": 22.013205528259277, "time_total_s": 840.737930059433, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 840.737930059433, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 33.92333333333333, "ram_util_percent": 59.0}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38819545591550486, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.479999999999999e-05, "total_loss": -0.040483750478034056, "policy_loss": -0.053095464100073105, "vf_loss": 0.11488861193309628, "vf_explained_var": 0.05916671190531023, "kl": 0.00829644477807342, "entropy": 0.4887960350080844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 19096.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 21991.574, "sample_time_ms": 11584.958, "load_time_ms": 24.097, "load_throughput": 165996.331, "learn_time_ms": 10374.041, "learn_throughput": 385.578, "synch_weights_time_ms": 7.978}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 4, "training_iteration": 39, "trial_id": "40f87_00000", "date": "2023-09-21_12-35-27", "timestamp": 1695270927, "time_this_iter_s": 22.13895320892334, "time_total_s": 862.8768832683563, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 862.8768832683563, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 30.683870967741935, "ram_util_percent": 58.1032258064516}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.336086718996446, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.439999999999998e-05, "total_loss": -0.04581117732243823, "policy_loss": -0.055610631722130724, "vf_loss": 0.09672783096621354, "vf_explained_var": -0.1383660480139717, "kl": 0.006445946987841045, "entropy": 0.4834455878984544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 19592.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 22025.83, "sample_time_ms": 11588.823, "load_time_ms": 24.299, "load_throughput": 164612.586, "learn_time_ms": 10404.333, "learn_throughput": 384.455, "synch_weights_time_ms": 7.975}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 4, "training_iteration": 40, "trial_id": "40f87_00000", "date": "2023-09-21_12-35-49", "timestamp": 1695270949, "time_this_iter_s": 22.178361892700195, "time_total_s": 885.0552451610565, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 885.0552451610565, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.36774193548387, "ram_util_percent": 58.096774193548384}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3537345078263071, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.399999999999998e-05, "total_loss": -0.045697689282655295, "policy_loss": -0.05609195086259616, "vf_loss": 0.14080149683755852, "vf_explained_var": -0.03394991712224099, "kl": 0.006834684516232447, "entropy": 0.4898381150898434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 20088.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 22093.293, "sample_time_ms": 11620.748, "load_time_ms": 24.399, "load_throughput": 163939.1, "learn_time_ms": 10439.768, "learn_throughput": 383.15, "synch_weights_time_ms": 7.978}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 4, "training_iteration": 41, "trial_id": "40f87_00000", "date": "2023-09-21_12-36-11", "timestamp": 1695270971, "time_this_iter_s": 22.370564937591553, "time_total_s": 907.4258100986481, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 907.4258100986481, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 30.4375, "ram_util_percent": 58.0875}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39517714885333854, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.360000000000003e-05, "total_loss": -0.05175999396165172, "policy_loss": -0.06527316779266262, "vf_loss": 0.1115674118796784, "vf_explained_var": 0.06463258833654466, "kl": 0.008890220139285074, "entropy": 0.5068923156227796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 20584.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 22106.367, "sample_time_ms": 11636.156, "load_time_ms": 24.399, "load_throughput": 163941.022, "learn_time_ms": 10437.428, "learn_throughput": 383.236, "synch_weights_time_ms": 7.985}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 4, "training_iteration": 42, "trial_id": "40f87_00000", "date": "2023-09-21_12-36-33", "timestamp": 1695270993, "time_this_iter_s": 22.03646945953369, "time_total_s": 929.4622795581818, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 929.4622795581818, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.658064516129034, "ram_util_percent": 58.12580645161288}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3552790282654666, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.320000000000002e-05, "total_loss": -0.030039416246807144, "policy_loss": -0.04111844201331898, "vf_loss": 0.09248238702439854, "vf_explained_var": -0.13813827258925285, "kl": 0.007288742959544625, "entropy": 0.5003501202670797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 21080.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 22123.328, "sample_time_ms": 11646.88, "load_time_ms": 24.499, "load_throughput": 163274.28, "learn_time_ms": 10443.664, "learn_throughput": 383.007, "synch_weights_time_ms": 7.885}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 4, "training_iteration": 43, "trial_id": "40f87_00000", "date": "2023-09-21_12-36-56", "timestamp": 1695271016, "time_this_iter_s": 22.284565210342407, "time_total_s": 951.7468447685242, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 951.7468447685242, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 32.01935483870968, "ram_util_percent": 58.24516129032257}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3856262110414044, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.280000000000002e-05, "total_loss": -0.04435372122679837, "policy_loss": -0.0570402669977592, "vf_loss": 0.07537169605606206, "vf_explained_var": -0.0977271051416474, "kl": 0.00834831826729322, "entropy": 0.5178304469032634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 21576.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 22106.031, "sample_time_ms": 11636.031, "load_time_ms": 24.499, "load_throughput": 163273.486, "learn_time_ms": 10437.316, "learn_throughput": 383.24, "synch_weights_time_ms": 7.785}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 4, "training_iteration": 44, "trial_id": "40f87_00000", "date": "2023-09-21_12-37-18", "timestamp": 1695271038, "time_this_iter_s": 22.086499214172363, "time_total_s": 973.8333439826965, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 973.8333439826965, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 30.335483870967746, "ram_util_percent": 58.25483870967743}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3673923522113792, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.240000000000001e-05, "total_loss": -0.035277704446343705, "policy_loss": -0.0481750683842209, "vf_loss": 0.1281879753355057, "vf_explained_var": -0.025851664403753895, "kl": 0.00848364930582979, "entropy": 0.5166684989366801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 22072.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 22098.723, "sample_time_ms": 11643.322, "load_time_ms": 24.099, "load_throughput": 165983.686, "learn_time_ms": 10423.017, "learn_throughput": 383.766, "synch_weights_time_ms": 7.985}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 4, "training_iteration": 45, "trial_id": "40f87_00000", "date": "2023-09-21_12-37-40", "timestamp": 1695271060, "time_this_iter_s": 22.12720012664795, "time_total_s": 995.9605441093445, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 995.9605441093445, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 30.977419354838712, "ram_util_percent": 58.24193548387096}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40426788007419917, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.200000000000001e-05, "total_loss": -0.06293593980033972, "policy_loss": -0.07804010621675256, "vf_loss": 0.11346531990585068, "vf_explained_var": 0.02401071330232005, "kl": 0.009937658713012847, "entropy": 0.5481273402129451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 22568.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 22090.886, "sample_time_ms": 11638.545, "load_time_ms": 24.099, "load_throughput": 165984.178, "learn_time_ms": 10419.758, "learn_throughput": 383.886, "synch_weights_time_ms": 8.184}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 4, "training_iteration": 46, "trial_id": "40f87_00000", "date": "2023-09-21_12-38-02", "timestamp": 1695271082, "time_this_iter_s": 22.01620602607727, "time_total_s": 1017.9767501354218, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1017.9767501354218, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.154838709677424, "ram_util_percent": 58.241935483870975}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3939903525094832, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.160000000000003e-05, "total_loss": -0.03348621362332074, "policy_loss": -0.046198601626993845, "vf_loss": 0.14956947490422717, "vf_explained_var": 0.07538615058987372, "kl": 0.008360447659547762, "entropy": 0.5144448906423584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 23064.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 22125.857, "sample_time_ms": 11661.876, "load_time_ms": 24.199, "load_throughput": 165298.143, "learn_time_ms": 10431.787, "learn_throughput": 383.443, "synch_weights_time_ms": 7.696}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 4, "training_iteration": 47, "trial_id": "40f87_00000", "date": "2023-09-21_12-38-24", "timestamp": 1695271104, "time_this_iter_s": 22.141572952270508, "time_total_s": 1040.1183230876923, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1040.1183230876923, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 30.164516129032258, "ram_util_percent": 58.25483870967741}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.406336547806859, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.120000000000003e-05, "total_loss": -0.037229186729452905, "policy_loss": -0.05134390122369833, "vf_loss": 0.09655230488222573, "vf_explained_var": 0.022481417824183742, "kl": 0.009287282795655476, "entropy": 0.5314891482553175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 23560.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 22111.999, "sample_time_ms": 11661.671, "load_time_ms": 24.099, "load_throughput": 165984.671, "learn_time_ms": 10417.935, "learn_throughput": 383.953, "synch_weights_time_ms": 7.696}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 4, "training_iteration": 48, "trial_id": "40f87_00000", "date": "2023-09-21_12-38-46", "timestamp": 1695271126, "time_this_iter_s": 21.873594760894775, "time_total_s": 1061.991917848587, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1061.991917848587, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 29.573333333333334, "ram_util_percent": 58.28666666666667}}
{"custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40234596841037273, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.080000000000003e-05, "total_loss": -0.0389888264133685, "policy_loss": -0.052919186582702456, "vf_loss": 0.15016550668740586, "vf_explained_var": 0.040841018841151266, "kl": 0.009162366730963897, "entropy": 0.547699295224682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 24056.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -100.0, "portfolio_return_min": -100.0, "portfolio_return_max": -100.0, "position_changes_mean": 40.309999999999995, "position_changes_min": 38.23, "position_changes_max": 42.48, "max_drawdown_mean": -100.0, "max_drawdown_min": -100.0, "max_drawdown_max": -100.0}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}}, "episode_reward_max": -463.94474069421307, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -556.4060578423646, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635], "episode_lengths": [33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47770596048668745, "mean_inference_ms": 3.0780008786446906, "mean_action_processing_ms": 0.14308870702217796, "mean_env_wait_ms": 2.0305539862497204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.02499222755432129, "StateBufferConnector_ms": 0.024890899658203125, "ViewRequirementAgentConnector_ms": 0.27601122856140137}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 22088.964, "sample_time_ms": 11655.859, "load_time_ms": 24.096, "load_throughput": 166006.022, "learn_time_ms": 10400.817, "learn_throughput": 384.585, "synch_weights_time_ms": 7.593}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 4, "training_iteration": 49, "trial_id": "40f87_00000", "date": "2023-09-21_12-39-08", "timestamp": 1695271148, "time_this_iter_s": 21.907622814178467, "time_total_s": 1083.8995406627655, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1083.8995406627655, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 29.648387096774194, "ram_util_percent": 58.28387096774192}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36531785352816504, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 9.040000000000002e-05, "total_loss": -0.04615395045144514, "policy_loss": -0.057835676090513925, "vf_loss": 0.10536795109134889, "vf_explained_var": -0.04642541682527911, "kl": 0.0076847337018553525, "entropy": 0.4943708542494043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.64516129032258, "num_grad_updates_lifetime": 24552.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 22087.743, "sample_time_ms": 11653.312, "load_time_ms": 23.996, "load_throughput": 166697.13, "learn_time_ms": 10402.244, "learn_throughput": 384.532, "synch_weights_time_ms": 7.593}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 6, "training_iteration": 50, "trial_id": "40f87_00000", "date": "2023-09-21_12-39-30", "timestamp": 1695271170, "time_this_iter_s": 22.167157411575317, "time_total_s": 1106.0666980743408, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1106.0666980743408, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 31.719354838709684, "ram_util_percent": 58.241935483870975}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3801250254074412, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.999999999999999e-05, "total_loss": -0.05870813499824444, "policy_loss": -0.0713046388120875, "vf_loss": 0.13246370679999311, "vf_explained_var": -0.05350857696706249, "kl": 0.008285275136713574, "entropy": 0.4824166301517717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 25048.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 22058.451, "sample_time_ms": 11638.286, "load_time_ms": 23.893, "load_throughput": 167413.393, "learn_time_ms": 10387.883, "learn_throughput": 385.064, "synch_weights_time_ms": 7.689}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 6, "training_iteration": 51, "trial_id": "40f87_00000", "date": "2023-09-21_12-39-52", "timestamp": 1695271192, "time_this_iter_s": 22.078672409057617, "time_total_s": 1128.1453704833984, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1128.1453704833984, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 30.29677419354838, "ram_util_percent": 58.264516129032245}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36484978489217257, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.960000000000001e-05, "total_loss": -0.04745554528386903, "policy_loss": -0.05898614054322318, "vf_loss": 0.16776439882514457, "vf_explained_var": -0.018631541080051852, "kl": 0.007581114314992088, "entropy": 0.46757142822588643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 25544.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 22053.912, "sample_time_ms": 11641.547, "load_time_ms": 23.893, "load_throughput": 167412.224, "learn_time_ms": 10379.984, "learn_throughput": 385.357, "synch_weights_time_ms": 7.686}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 6, "training_iteration": 52, "trial_id": "40f87_00000", "date": "2023-09-21_12-40-14", "timestamp": 1695271214, "time_this_iter_s": 21.991084337234497, "time_total_s": 1150.136454820633, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1150.136454820633, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 31.070967741935487, "ram_util_percent": 58.26451612903227}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39324687113384565, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.919999999999999e-05, "total_loss": -0.04724263912677059, "policy_loss": -0.058363067852746274, "vf_loss": 0.1505183964994015, "vf_explained_var": -0.04560620013263918, "kl": 0.007312182555104675, "entropy": 0.4739631728058861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 26040.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 22001.823, "sample_time_ms": 11615.225, "load_time_ms": 23.896, "load_throughput": 167391.846, "learn_time_ms": 10354.216, "learn_throughput": 386.316, "synch_weights_time_ms": 7.683}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 6, "training_iteration": 53, "trial_id": "40f87_00000", "date": "2023-09-21_12-40-36", "timestamp": 1695271236, "time_this_iter_s": 21.763671159744263, "time_total_s": 1171.9001259803772, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1171.9001259803772, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 30.673333333333332, "ram_util_percent": 58.233333333333334}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3914062662590896, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.88e-05, "total_loss": -0.06053416966836179, "policy_loss": -0.07203065437539818, "vf_loss": 0.09690361677653968, "vf_explained_var": -0.13122555998063856, "kl": 0.007563321997361754, "entropy": 0.4921616960557238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 26536.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 21986.841, "sample_time_ms": 11615.989, "load_time_ms": 23.896, "load_throughput": 167391.345, "learn_time_ms": 10338.473, "learn_throughput": 386.904, "synch_weights_time_ms": 7.68}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 6, "training_iteration": 54, "trial_id": "40f87_00000", "date": "2023-09-21_12-40-58", "timestamp": 1695271258, "time_this_iter_s": 21.935678005218506, "time_total_s": 1193.8358039855957, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1193.8358039855957, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 30.83870967741935, "ram_util_percent": 58.25806451612904}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42940477404983773, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.84e-05, "total_loss": -0.04611696959135213, "policy_loss": -0.06050755186292771, "vf_loss": 0.10803771338185235, "vf_explained_var": 0.07827962117810403, "kl": 0.009468167697599174, "entropy": 0.47095605532728857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 27032.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 21929.502, "sample_time_ms": 11585.134, "load_time_ms": 23.9, "load_throughput": 167361.789, "learn_time_ms": 10312.088, "learn_throughput": 387.894, "synch_weights_time_ms": 7.677}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 6, "training_iteration": 55, "trial_id": "40f87_00000", "date": "2023-09-21_12-41-19", "timestamp": 1695271279, "time_this_iter_s": 21.553836345672607, "time_total_s": 1215.3896403312683, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1215.3896403312683, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 31.296666666666667, "ram_util_percent": 58.269999999999996}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3642609074952141, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.799999999999998e-05, "total_loss": -0.07523979179067312, "policy_loss": -0.08506993013706081, "vf_loss": 0.11107404104193612, "vf_explained_var": 0.03563595911668193, "kl": 0.00646520532906187, "entropy": 0.47769678474193616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 27528.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 21895.062, "sample_time_ms": 11569.35, "load_time_ms": 23.9, "load_throughput": 167363.125, "learn_time_ms": 10293.833, "learn_throughput": 388.582, "synch_weights_time_ms": 7.277}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 6, "training_iteration": 56, "trial_id": "40f87_00000", "date": "2023-09-21_12-41-41", "timestamp": 1695271301, "time_this_iter_s": 21.67077612876892, "time_total_s": 1237.0604164600372, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1237.0604164600372, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.81666666666667, "ram_util_percent": 58.260000000000005}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42740754614914617, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.759999999999999e-05, "total_loss": -0.045883897852975, "policy_loss": -0.05725944324160904, "vf_loss": 0.07957061096244762, "vf_explained_var": -0.055610070786168496, "kl": 0.007484832484995962, "entropy": 0.4824893142306997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 28024.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 21848.41, "sample_time_ms": 11545.824, "load_time_ms": 23.903, "load_throughput": 167342.258, "learn_time_ms": 10270.904, "learn_throughput": 389.45, "synch_weights_time_ms": 7.277}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 6, "training_iteration": 57, "trial_id": "40f87_00000", "date": "2023-09-21_12-42-03", "timestamp": 1695271323, "time_this_iter_s": 21.672078609466553, "time_total_s": 1258.7324950695038, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1258.7324950695038, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 31.074193548387097, "ram_util_percent": 58.264516129032245}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39977379245383127, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.719999999999998e-05, "total_loss": -0.04519004743516205, "policy_loss": -0.058016731814977025, "vf_loss": 0.1424458257313217, "vf_explained_var": 0.0398653655523254, "kl": 0.008436175375573788, "entropy": 0.4886907420211261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 28520.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 21829.484, "sample_time_ms": 11538.183, "load_time_ms": 24.003, "load_throughput": 166644.311, "learn_time_ms": 10259.718, "learn_throughput": 389.874, "synch_weights_time_ms": 7.377}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 6, "training_iteration": 58, "trial_id": "40f87_00000", "date": "2023-09-21_12-42-25", "timestamp": 1695271345, "time_this_iter_s": 21.68633008003235, "time_total_s": 1280.4188251495361, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1280.4188251495361, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.616666666666667, "ram_util_percent": 58.29999999999999}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3762787488859988, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.680000000000001e-05, "total_loss": -0.0432247194745991, "policy_loss": -0.05454009079286123, "vf_loss": 0.1425897865856607, "vf_explained_var": -0.08792502973829547, "kl": 0.007441061262861027, "entropy": 0.4864928277750169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 29016.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 21830.482, "sample_time_ms": 11528.416, "load_time_ms": 24.006, "load_throughput": 166623.127, "learn_time_ms": 10270.476, "learn_throughput": 389.466, "synch_weights_time_ms": 7.38}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 6, "training_iteration": 59, "trial_id": "40f87_00000", "date": "2023-09-21_12-42-47", "timestamp": 1695271367, "time_this_iter_s": 21.917540550231934, "time_total_s": 1302.336365699768, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1302.336365699768, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 29.68064516129032, "ram_util_percent": 58.29677419354837}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.432464377173493, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.64e-05, "total_loss": -0.05702526708069678, "policy_loss": -0.06918547411031238, "vf_loss": 0.05841203105275429, "vf_explained_var": -0.12249619766108451, "kl": 0.008002875195373925, "entropy": 0.4972447397848291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 29512.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 21830.277, "sample_time_ms": 11538.114, "load_time_ms": 23.906, "load_throughput": 167321.897, "learn_time_ms": 10260.577, "learn_throughput": 389.842, "synch_weights_time_ms": 7.377}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 6, "training_iteration": 60, "trial_id": "40f87_00000", "date": "2023-09-21_12-43-09", "timestamp": 1695271389, "time_this_iter_s": 22.164114952087402, "time_total_s": 1324.5004806518555, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1324.5004806518555, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.41935483870967, "ram_util_percent": 58.309677419354834}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.39285687906968014, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.6e-05, "total_loss": -0.04411083368224002, "policy_loss": -0.055905359357805745, "vf_loss": 0.08807478322752661, "vf_explained_var": -0.04694475353725495, "kl": 0.007760142497143954, "entropy": 0.4909211378544569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 30008.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 21842.324, "sample_time_ms": 11539.936, "load_time_ms": 23.909, "load_throughput": 167299.205, "learn_time_ms": 10270.898, "learn_throughput": 389.45, "synch_weights_time_ms": 7.378}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 6, "training_iteration": 61, "trial_id": "40f87_00000", "date": "2023-09-21_12-43-31", "timestamp": 1695271411, "time_this_iter_s": 22.199111461639404, "time_total_s": 1346.6995921134949, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1346.6995921134949, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 31.46129032258065, "ram_util_percent": 58.29999999999998}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4290990903072299, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.559999999999998e-05, "total_loss": -0.05196565718600346, "policy_loss": -0.06587439169109735, "vf_loss": 0.13373751477188162, "vf_explained_var": -0.01245054482452331, "kl": 0.00914920891270388, "entropy": 0.5118696409608087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 30504.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 21849.906, "sample_time_ms": 11539.527, "load_time_ms": 23.909, "load_throughput": 167299.539, "learn_time_ms": 10278.989, "learn_throughput": 389.143, "synch_weights_time_ms": 7.281}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 6, "training_iteration": 62, "trial_id": "40f87_00000", "date": "2023-09-21_12-43-53", "timestamp": 1695271433, "time_this_iter_s": 22.066874742507935, "time_total_s": 1368.7664668560028, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1368.7664668560028, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 31.316129032258065, "ram_util_percent": 58.30645161290323}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4218715881147692, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.520000000000004e-05, "total_loss": -0.052314605676539, "policy_loss": -0.06657531193547672, "vf_loss": 0.11533442829855747, "vf_explained_var": 0.07814853794632419, "kl": 0.009382173552085664, "entropy": 0.5268972892194025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 31000.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 21872.52, "sample_time_ms": 11556.744, "load_time_ms": 23.773, "load_throughput": 168257.752, "learn_time_ms": 10284.321, "learn_throughput": 388.942, "synch_weights_time_ms": 7.384}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 6, "training_iteration": 63, "trial_id": "40f87_00000", "date": "2023-09-21_12-44-15", "timestamp": 1695271455, "time_this_iter_s": 21.989809274673462, "time_total_s": 1390.7562761306763, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1390.7562761306763, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 29.86774193548387, "ram_util_percent": 58.29354838709678}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40890575038088905, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.479999999999997e-05, "total_loss": -0.04277628617708087, "policy_loss": -0.05529503785885848, "vf_loss": 0.10443827654460384, "vf_explained_var": -0.01538153966107676, "kl": 0.008235922348065226, "entropy": 0.500875306586104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 31496.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 21871.307, "sample_time_ms": 11553.052, "load_time_ms": 23.676, "load_throughput": 168945.146, "learn_time_ms": 10286.698, "learn_throughput": 388.852, "synch_weights_time_ms": 7.384}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 6, "training_iteration": 64, "trial_id": "40f87_00000", "date": "2023-09-21_12-44-37", "timestamp": 1695271477, "time_this_iter_s": 21.92457604408264, "time_total_s": 1412.680852174759, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1412.680852174759, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 29.564516129032267, "ram_util_percent": 58.31935483870967}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41994919219324667, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.440000000000003e-05, "total_loss": -0.051250652851341595, "policy_loss": -0.06417480749528735, "vf_loss": 0.13731807748967362, "vf_explained_var": -0.05640199852566565, "kl": 0.008500690365209927, "entropy": 0.5304805595547922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 31992.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 21910.003, "sample_time_ms": 11571.951, "load_time_ms": 23.572, "load_throughput": 169691.198, "learn_time_ms": 10306.396, "learn_throughput": 388.108, "synch_weights_time_ms": 7.587}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 6, "training_iteration": 65, "trial_id": "40f87_00000", "date": "2023-09-21_12-44-59", "timestamp": 1695271499, "time_this_iter_s": 21.938775539398193, "time_total_s": 1434.619627714157, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1434.619627714157, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 29.312903225806455, "ram_util_percent": 58.351612903225806}}
{"custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38251547070760883, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.400000000000001e-05, "total_loss": -0.050755594398886446, "policy_loss": -0.06329416377270865, "vf_loss": 0.17954972051008936, "vf_explained_var": 0.06560701924947, "kl": 0.008244026197189669, "entropy": 0.5183549129794682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 32488.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.99333333333334, "portfolio_return_min": -100.0, "portfolio_return_max": -99.98, "position_changes_mean": 39.04833333333333, "position_changes_min": 36.46, "position_changes_max": 42.48, "max_drawdown_mean": -99.99333333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -99.98}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -501.20380472192136, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47822044496607563, "mean_inference_ms": 3.079530685059048, "mean_action_processing_ms": 0.14301049993048234, "mean_env_wait_ms": 2.031507806846366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.05055665969848633, "StateBufferConnector_ms": 0.01659393310546875, "ViewRequirementAgentConnector_ms": 0.20067294438680014}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 21966.204, "sample_time_ms": 11613.799, "load_time_ms": 23.573, "load_throughput": 169688.795, "learn_time_ms": 10320.648, "learn_throughput": 387.573, "synch_weights_time_ms": 7.687}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 6, "training_iteration": 66, "trial_id": "40f87_00000", "date": "2023-09-21_12-45-21", "timestamp": 1695271521, "time_this_iter_s": 22.23381781578064, "time_total_s": 1456.8534455299377, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1456.8534455299377, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 39.23870967741936, "ram_util_percent": 57.896774193548396}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4139130090273196, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.360000000000001e-05, "total_loss": -0.05142864926000907, "policy_loss": -0.06343538290609778, "vf_loss": 0.12478671150071727, "vf_explained_var": 0.0229168719341678, "kl": 0.007897452512567021, "entropy": 0.45659600318439547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.61290322580645, "num_grad_updates_lifetime": 32984.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 21993.484, "sample_time_ms": 11627.595, "load_time_ms": 23.569, "load_throughput": 169710.938, "learn_time_ms": 10334.036, "learn_throughput": 387.07, "synch_weights_time_ms": 7.787}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 8, "training_iteration": 67, "trial_id": "40f87_00000", "date": "2023-09-21_12-45-43", "timestamp": 1695271543, "time_this_iter_s": 21.94585657119751, "time_total_s": 1478.7993021011353, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1478.7993021011353, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 28.780000000000005, "ram_util_percent": 57.499999999999986}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37134286163434865, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.32e-05, "total_loss": -0.043741198435928975, "policy_loss": -0.05446844432428348, "vf_loss": 0.1599831502554157, "vf_explained_var": -0.0744523317102463, "kl": 0.007052672835099353, "entropy": 0.45804310349687455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 33480.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 22026.755, "sample_time_ms": 11636.47, "load_time_ms": 23.473, "load_throughput": 170411.32, "learn_time_ms": 10358.425, "learn_throughput": 386.159, "synch_weights_time_ms": 7.79}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 8, "training_iteration": 68, "trial_id": "40f87_00000", "date": "2023-09-21_12-46-05", "timestamp": 1695271565, "time_this_iter_s": 22.01904582977295, "time_total_s": 1500.8183479309082, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1500.8183479309082, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 28.825806451612905, "ram_util_percent": 57.5225806451613}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42722273491803675, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.280000000000003e-05, "total_loss": -0.05422016191709366, "policy_loss": -0.0662865886566109, "vf_loss": 0.13565324837221734, "vf_explained_var": -0.018746208639875535, "kl": 0.007936037846366, "entropy": 0.4379840916803768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 33976.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 22047.406, "sample_time_ms": 11661.075, "load_time_ms": 23.469, "load_throughput": 170434.691, "learn_time_ms": 10354.474, "learn_throughput": 386.306, "synch_weights_time_ms": 7.79}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 8, "training_iteration": 69, "trial_id": "40f87_00000", "date": "2023-09-21_12-46-27", "timestamp": 1695271587, "time_this_iter_s": 22.124078512191772, "time_total_s": 1522.9424264431, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1522.9424264431, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 28.264516129032256, "ram_util_percent": 57.50322580645161}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4483763460790919, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.240000000000002e-05, "total_loss": -0.052638604579823875, "policy_loss": -0.06457916532470394, "vf_loss": 0.08780381309183975, "vf_explained_var": -0.07717116201116193, "kl": 0.007856315364049921, "entropy": 0.4614875466232338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 34472.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 22036.046, "sample_time_ms": 11652.898, "load_time_ms": 23.569, "load_throughput": 169711.453, "learn_time_ms": 10351.288, "learn_throughput": 386.425, "synch_weights_time_ms": 7.793}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 8, "training_iteration": 70, "trial_id": "40f87_00000", "date": "2023-09-21_12-46-49", "timestamp": 1695271609, "time_this_iter_s": 22.051517963409424, "time_total_s": 1544.9939444065094, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1544.9939444065094, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 29.103225806451615, "ram_util_percent": 57.53870967741935}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4530019738200691, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.200000000000003e-05, "total_loss": -0.046523053942608736, "policy_loss": -0.060672013851393376, "vf_loss": 0.09145820888525416, "vf_explained_var": -0.04971209721219155, "kl": 0.009310165882308562, "entropy": 0.4673472920492772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 34968.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 22142.426, "sample_time_ms": 11665.151, "load_time_ms": 23.569, "load_throughput": 169714.2, "learn_time_ms": 10445.413, "learn_throughput": 382.943, "synch_weights_time_ms": 7.795}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 8, "training_iteration": 71, "trial_id": "40f87_00000", "date": "2023-09-21_12-47-13", "timestamp": 1695271633, "time_this_iter_s": 23.260905027389526, "time_total_s": 1568.254849433899, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1568.254849433899, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 37.527272727272724, "ram_util_percent": 57.521212121212116}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4189627891586673, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.160000000000002e-05, "total_loss": -0.06801282044879402, "policy_loss": -0.08106096385275915, "vf_loss": 0.11809883248286261, "vf_explained_var": 0.0011457367049109552, "kl": 0.008583593308161016, "entropy": 0.45114161656989205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 35464.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 22173.859, "sample_time_ms": 11695.912, "load_time_ms": 23.569, "load_throughput": 169714.543, "learn_time_ms": 10445.986, "learn_throughput": 382.922, "synch_weights_time_ms": 7.995}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 8, "training_iteration": 72, "trial_id": "40f87_00000", "date": "2023-09-21_12-47-35", "timestamp": 1695271655, "time_this_iter_s": 22.38123893737793, "time_total_s": 1590.6360883712769, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1590.6360883712769, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 38.27741935483871, "ram_util_percent": 57.738709677419365}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4269972420748203, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.120000000000001e-05, "total_loss": -0.041578883739871786, "policy_loss": -0.052369502139270246, "vf_loss": 0.12337099265066846, "vf_explained_var": -0.0290192483413604, "kl": 0.007096811593199292, "entropy": 0.4392360016222923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 35960.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 22203.724, "sample_time_ms": 11712.327, "load_time_ms": 24.102, "load_throughput": 165960.371, "learn_time_ms": 10459.099, "learn_throughput": 382.442, "synch_weights_time_ms": 7.895}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 8, "training_iteration": 73, "trial_id": "40f87_00000", "date": "2023-09-21_12-47-57", "timestamp": 1695271677, "time_this_iter_s": 22.288447856903076, "time_total_s": 1612.92453622818, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1612.92453622818, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 34.912903225806446, "ram_util_percent": 57.86774193548389}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4391153585466166, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.079999999999999e-05, "total_loss": -0.053082610825977976, "policy_loss": -0.06479362641543811, "vf_loss": 0.12648600604264967, "vf_explained_var": -0.04630099765716061, "kl": 0.007702630193088599, "entropy": 0.4448180555576278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 36456.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 22217.381, "sample_time_ms": 11731.462, "load_time_ms": 24.099, "load_throughput": 165983.686, "learn_time_ms": 10453.724, "learn_throughput": 382.639, "synch_weights_time_ms": 7.896}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 8, "training_iteration": 74, "trial_id": "40f87_00000", "date": "2023-09-21_12-48-20", "timestamp": 1695271700, "time_this_iter_s": 22.061120748519897, "time_total_s": 1634.9856569766998, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1634.9856569766998, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 32.52903225806452, "ram_util_percent": 57.887096774193544}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43154703951891393, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.04e-05, "total_loss": -0.03937759953259956, "policy_loss": -0.05285535012139477, "vf_loss": 0.1204597644823333, "vf_explained_var": -0.03803952446868343, "kl": 0.00886630780811031, "entropy": 0.4519889890066078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 36952.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 22231.689, "sample_time_ms": 11740.771, "load_time_ms": 24.199, "load_throughput": 165298.794, "learn_time_ms": 10458.923, "learn_throughput": 382.449, "synch_weights_time_ms": 7.596}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 8, "training_iteration": 75, "trial_id": "40f87_00000", "date": "2023-09-21_12-48-42", "timestamp": 1695271722, "time_this_iter_s": 22.08285689353943, "time_total_s": 1657.0685138702393, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1657.0685138702393, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 34.8258064516129, "ram_util_percent": 57.94193548387095}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48207503884670233, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 8.000000000000002e-05, "total_loss": -0.041934830924278244, "policy_loss": -0.052558990868302284, "vf_loss": 0.094846319219458, "vf_explained_var": 0.019178601402428844, "kl": 0.006989086772669816, "entropy": 0.46312017023803725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 37448.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 22186.505, "sample_time_ms": 11709.809, "load_time_ms": 24.199, "load_throughput": 165299.283, "learn_time_ms": 10444.804, "learn_throughput": 382.966, "synch_weights_time_ms": 7.493}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 8, "training_iteration": 76, "trial_id": "40f87_00000", "date": "2023-09-21_12-49-03", "timestamp": 1695271743, "time_this_iter_s": 21.780973196029663, "time_total_s": 1678.849487066269, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1678.849487066269, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.75, "ram_util_percent": 58.05666666666666}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42696606478984317, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.96e-05, "total_loss": -0.04894384816326501, "policy_loss": -0.05986517548914098, "vf_loss": 0.0747062680029851, "vf_explained_var": -0.06689368861336861, "kl": 0.007186079999308393, "entropy": 0.4646850339467487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 37944.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 22174.944, "sample_time_ms": 11714.073, "load_time_ms": 24.299, "load_throughput": 164618.724, "learn_time_ms": 10428.874, "learn_throughput": 383.551, "synch_weights_time_ms": 7.499}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 8, "training_iteration": 77, "trial_id": "40f87_00000", "date": "2023-09-21_12-49-25", "timestamp": 1695271765, "time_this_iter_s": 21.831225156784058, "time_total_s": 1700.680712223053, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1700.680712223053, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 30.977419354838712, "ram_util_percent": 58.07741935483868}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4277316150105288, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.919999999999999e-05, "total_loss": -0.05406693294231269, "policy_loss": -0.06729097248640872, "vf_loss": 0.08728396678493629, "vf_explained_var": -0.0500742606818676, "kl": 0.008701439612436388, "entropy": 0.46752230919176535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 38440.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 22142.926, "sample_time_ms": 11712.186, "load_time_ms": 24.395, "load_throughput": 163966.017, "learn_time_ms": 10398.845, "learn_throughput": 384.658, "synch_weights_time_ms": 7.399}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 8, "training_iteration": 78, "trial_id": "40f87_00000", "date": "2023-09-21_12-49-47", "timestamp": 1695271787, "time_this_iter_s": 21.696861028671265, "time_total_s": 1722.3775732517242, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1722.3775732517242, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.47666666666667, "ram_util_percent": 58.10666666666666}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43365512505894704, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.879999999999999e-05, "total_loss": -0.05014481137116109, "policy_loss": -0.06438132763216872, "vf_loss": 0.14361549951812072, "vf_explained_var": -0.004325728863477707, "kl": 0.009364381046627682, "entropy": 0.5072742746241631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 38936.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 22109.936, "sample_time_ms": 11705.487, "load_time_ms": 24.415, "load_throughput": 163836.0, "learn_time_ms": 10372.536, "learn_throughput": 385.634, "synch_weights_time_ms": 7.399}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 8, "training_iteration": 79, "trial_id": "40f87_00000", "date": "2023-09-21_12-50-09", "timestamp": 1695271809, "time_this_iter_s": 21.79518461227417, "time_total_s": 1744.1727578639984, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1744.1727578639984, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 32.36451612903225, "ram_util_percent": 57.377419354838736}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40371755303274237, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.839999999999998e-05, "total_loss": -0.053874608683174535, "policy_loss": -0.06591175472409129, "vf_loss": 0.1668971384567539, "vf_explained_var": 0.07292096965735959, "kl": 0.00791470439922292, "entropy": 0.4713716207132224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 39432.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 22071.847, "sample_time_ms": 11697.224, "load_time_ms": 24.415, "load_throughput": 163836.0, "learn_time_ms": 10342.51, "learn_throughput": 386.753, "synch_weights_time_ms": 7.499}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 8, "training_iteration": 80, "trial_id": "40f87_00000", "date": "2023-09-21_12-50-31", "timestamp": 1695271831, "time_this_iter_s": 21.670625686645508, "time_total_s": 1765.843383550644, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1765.843383550644, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 31.546666666666667, "ram_util_percent": 56.94333333333336}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45673838843621556, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.799999999999997e-05, "total_loss": -0.04645671899807865, "policy_loss": -0.05970768466971593, "vf_loss": 0.10486801891332312, "vf_explained_var": -0.11697877150389456, "kl": 0.008718012203793495, "entropy": 0.49810070640617804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 39928.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 21919.586, "sample_time_ms": 11668.911, "load_time_ms": 24.415, "load_throughput": 163833.92, "learn_time_ms": 10218.561, "learn_throughput": 391.445, "synch_weights_time_ms": 7.399}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 8, "training_iteration": 81, "trial_id": "40f87_00000", "date": "2023-09-21_12-50-52", "timestamp": 1695271852, "time_this_iter_s": 21.73929190635681, "time_total_s": 1787.5826754570007, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1787.5826754570007, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 29.63870967741935, "ram_util_percent": 56.987096774193546}}
{"custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4005451069904431, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.76e-05, "total_loss": -0.0483010350872064, "policy_loss": -0.06014971004695311, "vf_loss": 0.2476212655366849, "vf_explained_var": -0.04882466252292356, "kl": 0.007785293264965627, "entropy": 0.5065661301656116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 40424.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.9725, "portfolio_return_min": -100.0, "portfolio_return_max": -99.9, "position_changes_mean": 38.2275, "position_changes_min": 35.42, "position_changes_max": 42.48, "max_drawdown_mean": -99.97375, "max_drawdown_min": -100.0, "max_drawdown_max": -99.9}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}}, "episode_reward_max": -381.9306348211175, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -473.18624750304014, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4784023506329159, "mean_inference_ms": 3.080166386701331, "mean_action_processing_ms": 0.14310924922250967, "mean_env_wait_ms": 2.0317448333205506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "MeanStdObservationFilterAgentConnector_ms": 0.037917494773864746, "StateBufferConnector_ms": 0.012445449829101562, "ViewRequirementAgentConnector_ms": 0.175553560256958}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 21832.897, "sample_time_ms": 11615.682, "load_time_ms": 24.315, "load_throughput": 164507.67, "learn_time_ms": 10185.205, "learn_throughput": 392.727, "synch_weights_time_ms": 7.296}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 8, "training_iteration": 82, "trial_id": "40f87_00000", "date": "2023-09-21_12-51-14", "timestamp": 1695271874, "time_this_iter_s": 21.513368606567383, "time_total_s": 1809.0960440635681, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1809.0960440635681, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 30.926666666666673, "ram_util_percent": 56.960000000000015}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4111276237714675, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.72e-05, "total_loss": -0.04258995479716349, "policy_loss": -0.05578502673198536, "vf_loss": 0.11988495870102797, "vf_explained_var": -0.06993051522201107, "kl": 0.008680218564717177, "entropy": 0.4594814239009734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.58064516129032, "num_grad_updates_lifetime": 40920.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 21766.879, "sample_time_ms": 11586.963, "load_time_ms": 23.918, "load_throughput": 167235.335, "learn_time_ms": 10148.305, "learn_throughput": 394.154, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 10, "training_iteration": 83, "trial_id": "40f87_00000", "date": "2023-09-21_12-51-36", "timestamp": 1695271896, "time_this_iter_s": 21.627267837524414, "time_total_s": 1830.7233119010925, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1830.7233119010925, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.45333333333333, "ram_util_percent": 57.00999999999999}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4476593326657049, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.68e-05, "total_loss": -0.03839923425262133, "policy_loss": -0.050336025337943985, "vf_loss": 0.1331414823615623, "vf_explained_var": -0.0066489793600574615, "kl": 0.007850849667079812, "entropy": 0.4326648369070984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 41416.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 21725.503, "sample_time_ms": 11562.828, "load_time_ms": 24.322, "load_throughput": 164461.227, "learn_time_ms": 10130.658, "learn_throughput": 394.841, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 10, "training_iteration": 84, "trial_id": "40f87_00000", "date": "2023-09-21_12-51-57", "timestamp": 1695271917, "time_this_iter_s": 21.64735198020935, "time_total_s": 1852.3706638813019, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1852.3706638813019, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 29.50967741935484, "ram_util_percent": 57.006451612903234}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44760165117200346, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.639999999999999e-05, "total_loss": -0.03653064469812483, "policy_loss": -0.0470722445846355, "vf_loss": 0.07452835541053285, "vf_explained_var": -0.04156268808630205, "kl": 0.006936065612920161, "entropy": 0.40438879125060573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 41912.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 21689.341, "sample_time_ms": 11545.23, "load_time_ms": 24.319, "load_throughput": 164482.832, "learn_time_ms": 10111.998, "learn_throughput": 395.57, "synch_weights_time_ms": 7.297}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 10, "training_iteration": 85, "trial_id": "40f87_00000", "date": "2023-09-21_12-52-19", "timestamp": 1695271939, "time_this_iter_s": 21.72123384475708, "time_total_s": 1874.091897726059, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1874.091897726059, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 30.94333333333333, "ram_util_percent": 57.01666666666666}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4257285437516628, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.600000000000003e-05, "total_loss": -0.03311390084291493, "policy_loss": -0.04428996995932633, "vf_loss": 0.09998728655233619, "vf_explained_var": 0.0405876825173055, "kl": 0.007352145158616698, "entropy": 0.41612543183709344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 42408.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 21668.165, "sample_time_ms": 11537.826, "load_time_ms": 24.318, "load_throughput": 164484.284, "learn_time_ms": 10098.125, "learn_throughput": 396.113, "synch_weights_time_ms": 7.397}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 10, "training_iteration": 86, "trial_id": "40f87_00000", "date": "2023-09-21_12-52-41", "timestamp": 1695271961, "time_this_iter_s": 21.570214986801147, "time_total_s": 1895.66211271286, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1895.66211271286, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 29.740000000000002, "ram_util_percent": 57.03}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41887153754191053, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.559999999999997e-05, "total_loss": -0.03499544533007147, "policy_loss": -0.046643765373324465, "vf_loss": 0.06796192528019028, "vf_explained_var": -0.1434542188240636, "kl": 0.007665198487504786, "entropy": 0.42761341530469155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 42904.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 21646.711, "sample_time_ms": 11520.929, "load_time_ms": 24.222, "load_throughput": 165141.457, "learn_time_ms": 10093.768, "learn_throughput": 396.284, "synch_weights_time_ms": 7.295}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 10, "training_iteration": 87, "trial_id": "40f87_00000", "date": "2023-09-21_12-53-02", "timestamp": 1695271982, "time_this_iter_s": 21.616739511489868, "time_total_s": 1917.27885222435, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1917.27885222435, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.616129032258065, "ram_util_percent": 57.01290322580644}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48378121621546244, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.520000000000001e-05, "total_loss": -0.048274313982185575, "policy_loss": -0.06257908780600936, "vf_loss": 0.10224884958194208, "vf_explained_var": -0.08669573140721168, "kl": 0.009412048202963711, "entropy": 0.4421882095836824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 43400.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 21640.839, "sample_time_ms": 11522.491, "load_time_ms": 24.225, "load_throughput": 165119.19, "learn_time_ms": 10086.231, "learn_throughput": 396.58, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 10, "training_iteration": 88, "trial_id": "40f87_00000", "date": "2023-09-21_12-53-24", "timestamp": 1695272004, "time_this_iter_s": 21.639143228530884, "time_total_s": 1938.9179954528809, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1938.9179954528809, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.006666666666668, "ram_util_percent": 57.03333333333333}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43278403661303944, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.48e-05, "total_loss": -0.04591713502973547, "policy_loss": -0.05642316314709118, "vf_loss": 0.10410123033028457, "vf_explained_var": 0.017981437906142202, "kl": 0.006910696632493154, "entropy": 0.424382304472308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 43896.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 21620.158, "sample_time_ms": 11505.445, "load_time_ms": 24.178, "load_throughput": 165438.648, "learn_time_ms": 10082.542, "learn_throughput": 396.725, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 10, "training_iteration": 89, "trial_id": "40f87_00000", "date": "2023-09-21_12-53-45", "timestamp": 1695272025, "time_this_iter_s": 21.588367462158203, "time_total_s": 1960.506362915039, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1960.506362915039, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 31.11666666666667, "ram_util_percent": 57.046666666666646}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3935121349810112, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.44e-05, "total_loss": -0.027010067460885752, "policy_loss": -0.03806346246569921, "vf_loss": 0.1157556845761475, "vf_explained_var": 0.016201528690515027, "kl": 0.00727033427936251, "entropy": 0.42134623463836407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 44392.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 21623.7, "sample_time_ms": 11503.823, "load_time_ms": 24.078, "load_throughput": 166124.866, "learn_time_ms": 10087.906, "learn_throughput": 396.514, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 10, "training_iteration": 90, "trial_id": "40f87_00000", "date": "2023-09-21_12-54-07", "timestamp": 1695272047, "time_this_iter_s": 21.707051038742065, "time_total_s": 1982.2134139537811, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1982.2134139537811, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.25483870967742, "ram_util_percent": 57.05806451612903}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43350008469555645, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.400000000000002e-05, "total_loss": -0.05139010213198133, "policy_loss": -0.06460547189600484, "vf_loss": 0.14598394126721448, "vf_explained_var": 0.1087744080972287, "kl": 0.008691865875635509, "entropy": 0.4426128771756926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 44888.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 21609.737, "sample_time_ms": 11502.329, "load_time_ms": 24.049, "load_throughput": 166324.637, "learn_time_ms": 10075.467, "learn_throughput": 397.004, "synch_weights_time_ms": 7.292}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 10, "training_iteration": 91, "trial_id": "40f87_00000", "date": "2023-09-21_12-54-29", "timestamp": 1695272069, "time_this_iter_s": 21.598665714263916, "time_total_s": 2003.812079668045, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2003.812079668045, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 31.093333333333337, "ram_util_percent": 57.07666666666664}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4826922216903298, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.360000000000003e-05, "total_loss": -0.04089977895003563, "policy_loss": -0.05339103129494282, "vf_loss": 0.12195979705035326, "vf_explained_var": -0.009117809514845572, "kl": 0.008216663275088812, "entropy": 0.4450706902651056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 45384.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 21621.305, "sample_time_ms": 11507.734, "load_time_ms": 24.115, "load_throughput": 165868.979, "learn_time_ms": 10081.66, "learn_throughput": 396.76, "synch_weights_time_ms": 7.196}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 10, "training_iteration": 92, "trial_id": "40f87_00000", "date": "2023-09-21_12-54-50", "timestamp": 1695272090, "time_this_iter_s": 21.629026412963867, "time_total_s": 2025.441106081009, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2025.441106081009, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 30.21666666666666, "ram_util_percent": 57.06666666666667}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45195698362564846, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.320000000000002e-05, "total_loss": -0.03191872409614359, "policy_loss": -0.04208467661186249, "vf_loss": 0.0901491604351078, "vf_explained_var": 0.0453050623257314, "kl": 0.006687694892254323, "entropy": 0.44041855597207624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 45880.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 21659.389, "sample_time_ms": 11522.832, "load_time_ms": 24.112, "load_throughput": 165890.464, "learn_time_ms": 10104.546, "learn_throughput": 395.861, "synch_weights_time_ms": 7.299}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 10, "training_iteration": 93, "trial_id": "40f87_00000", "date": "2023-09-21_12-55-12", "timestamp": 1695272112, "time_this_iter_s": 22.00911045074463, "time_total_s": 2047.4502165317535, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2047.4502165317535, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 32.45483870967742, "ram_util_percent": 55.97741935483869}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44034636498338753, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.280000000000002e-05, "total_loss": -0.04034534976967881, "policy_loss": -0.05192479693118179, "vf_loss": 0.0703247704528152, "vf_explained_var": -0.08759211688753098, "kl": 0.007619698119320158, "entropy": 0.46102375284798686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 46376.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 21694.733, "sample_time_ms": 11535.805, "load_time_ms": 23.709, "load_throughput": 168713.582, "learn_time_ms": 10127.322, "learn_throughput": 394.971, "synch_weights_time_ms": 7.296}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 10, "training_iteration": 94, "trial_id": "40f87_00000", "date": "2023-09-21_12-55-35", "timestamp": 1695272135, "time_this_iter_s": 22.000792503356934, "time_total_s": 2069.4510090351105, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2069.4510090351105, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 30.806451612903224, "ram_util_percent": 55.5516129032258}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45414037416659053, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.240000000000001e-05, "total_loss": -0.04841442324170437, "policy_loss": -0.0618239452263468, "vf_loss": 0.11489237058577279, "vf_explained_var": -0.019706649405340993, "kl": 0.008821749594523904, "entropy": 0.47279833503548174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 46872.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 21732.214, "sample_time_ms": 11548.084, "load_time_ms": 23.712, "load_throughput": 168689.493, "learn_time_ms": 10152.421, "learn_throughput": 393.995, "synch_weights_time_ms": 7.294}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 10, "training_iteration": 95, "trial_id": "40f87_00000", "date": "2023-09-21_12-55-57", "timestamp": 1695272157, "time_this_iter_s": 22.096043825149536, "time_total_s": 2091.54705286026, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2091.54705286026, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 27.9483870967742, "ram_util_percent": 55.535483870967724}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4680815622691185, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.2e-05, "total_loss": -0.04699686881471162, "policy_loss": -0.06078122087966485, "vf_loss": 0.06984434050372651, "vf_explained_var": 0.07083263800990197, "kl": 0.009071517714393084, "entropy": 0.5008508898317814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 47368.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 21773.279, "sample_time_ms": 11562.878, "load_time_ms": 23.713, "load_throughput": 168687.119, "learn_time_ms": 10178.689, "learn_throughput": 392.978, "synch_weights_time_ms": 7.297}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 10, "training_iteration": 96, "trial_id": "40f87_00000", "date": "2023-09-21_12-56-19", "timestamp": 1695272179, "time_this_iter_s": 21.980868101119995, "time_total_s": 2113.52792096138, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2113.52792096138, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 29.696774193548393, "ram_util_percent": 55.612903225806434}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40690768185642456, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.160000000000002e-05, "total_loss": -0.04454750838809677, "policy_loss": -0.05522014047845357, "vf_loss": 0.17065351753826102, "vf_explained_var": 0.09914022083244016, "kl": 0.007016010583638905, "entropy": 0.4729808201833117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 47864.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 21810.627, "sample_time_ms": 11583.71, "load_time_ms": 23.71, "load_throughput": 168704.76, "learn_time_ms": 10195.208, "learn_throughput": 392.341, "synch_weights_time_ms": 7.296}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 10, "training_iteration": 97, "trial_id": "40f87_00000", "date": "2023-09-21_12-56-41", "timestamp": 1695272201, "time_this_iter_s": 21.9901921749115, "time_total_s": 2135.5181131362915, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2135.5181131362915, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 28.87666666666667, "ram_util_percent": 55.64000000000001}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40009010351833796, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.12e-05, "total_loss": -0.04505720099757215, "policy_loss": -0.05615844949094143, "vf_loss": 0.13615867272470025, "vf_explained_var": -0.15577396401955235, "kl": 0.0073004985346798975, "entropy": 0.5022737513626775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 48360.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 21846.6, "sample_time_ms": 11589.894, "load_time_ms": 23.707, "load_throughput": 168728.344, "learn_time_ms": 10225.103, "learn_throughput": 391.194, "synch_weights_time_ms": 7.297}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 10, "training_iteration": 98, "trial_id": "40f87_00000", "date": "2023-09-21_12-57-03", "timestamp": 1695272223, "time_this_iter_s": 21.99816131591797, "time_total_s": 2157.5162744522095, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2157.5162744522095, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 29.33870967741936, "ram_util_percent": 55.69999999999999}}
{"custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43931253089178957, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.080000000000001e-05, "total_loss": -0.04141448531393713, "policy_loss": -0.053813853738134756, "vf_loss": 0.10580332104807659, "vf_explained_var": 0.032128631347610105, "kl": 0.008157228792788325, "entropy": 0.4873287178455822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 48856.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.912, "portfolio_return_min": -100.0, "portfolio_return_max": -99.49, "position_changes_mean": 37.45, "position_changes_min": 34.25, "position_changes_max": 42.48, "max_drawdown_mean": -99.91799999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -99.52}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}}, "episode_reward_max": -342.95932716537146, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -451.21716005702444, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47883493533427235, "mean_inference_ms": 3.080027847739698, "mean_action_processing_ms": 0.1432417595015391, "mean_env_wait_ms": 2.0327258001768818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010001659393310547, "MeanStdObservationFilterAgentConnector_ms": 0.050275325775146484, "StateBufferConnector_ms": 0.00995635986328125, "ViewRequirementAgentConnector_ms": 0.1904439926147461}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 21893.123, "sample_time_ms": 11614.278, "load_time_ms": 23.737, "load_throughput": 168512.604, "learn_time_ms": 10247.315, "learn_throughput": 390.346, "synch_weights_time_ms": 7.293}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 10, "training_iteration": 99, "trial_id": "40f87_00000", "date": "2023-09-21_12-57-25", "timestamp": 1695272245, "time_this_iter_s": 22.052602291107178, "time_total_s": 2179.5688767433167, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2179.5688767433167, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 29.925806451612896, "ram_util_percent": 55.69354838709678}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4410813494976009, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.039999999999999e-05, "total_loss": -0.03972494403640139, "policy_loss": -0.050792665536714444, "vf_loss": 0.1284008318137738, "vf_explained_var": 0.1973028824694695, "kl": 0.007278934898566909, "entropy": 0.4236087119507213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.54838709677419, "num_grad_updates_lifetime": 49352.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 21929.982, "sample_time_ms": 11633.318, "load_time_ms": 23.837, "load_throughput": 167805.385, "learn_time_ms": 10265.033, "learn_throughput": 389.672, "synch_weights_time_ms": 7.293}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 12, "training_iteration": 100, "trial_id": "40f87_00000", "date": "2023-09-21_12-57-47", "timestamp": 1695272267, "time_this_iter_s": 22.075636863708496, "time_total_s": 2201.644513607025, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2201.644513607025, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 29.745161290322578, "ram_util_percent": 55.72258064516129}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4490406467248836, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 7.000000000000001e-05, "total_loss": -0.046684080242900355, "policy_loss": -0.05799287669754361, "vf_loss": 0.14302846918919035, "vf_explained_var": -0.024740188352523312, "kl": 0.007436703764819748, "entropy": 0.43097704360561984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 49848.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 21973.33, "sample_time_ms": 11650.023, "load_time_ms": 23.866, "load_throughput": 167605.56, "learn_time_ms": 10291.648, "learn_throughput": 388.665, "synch_weights_time_ms": 7.393}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 12, "training_iteration": 101, "trial_id": "40f87_00000", "date": "2023-09-21_12-58-09", "timestamp": 1695272289, "time_this_iter_s": 22.034143686294556, "time_total_s": 2223.6786572933197, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2223.6786572933197, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 28.767741935483873, "ram_util_percent": 55.790322580645174}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44254727301097685, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.959999999999998e-05, "total_loss": -0.03724886371421763, "policy_loss": -0.0485770162550477, "vf_loss": 0.13886876124137593, "vf_explained_var": 0.017748255402811112, "kl": 0.007449723495186958, "entropy": 0.404292443406678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 50344.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 22017.609, "sample_time_ms": 11665.47, "load_time_ms": 23.9, "load_throughput": 167367.299, "learn_time_ms": 10320.546, "learn_throughput": 387.576, "synch_weights_time_ms": 7.393}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 12, "training_iteration": 102, "trial_id": "40f87_00000", "date": "2023-09-21_12-58-31", "timestamp": 1695272311, "time_this_iter_s": 22.071480989456177, "time_total_s": 2245.750138282776, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2245.750138282776, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 29.874193548387098, "ram_util_percent": 55.75806451612904}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4870701701710782, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.919999999999997e-05, "total_loss": -0.041193703949008315, "policy_loss": -0.0518968028857583, "vf_loss": 0.07605991804701907, "vf_explained_var": -0.17367981350229633, "kl": 0.007042301260611713, "entropy": 0.41559255357471203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 50840.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 22024.086, "sample_time_ms": 11659.883, "load_time_ms": 23.899, "load_throughput": 167370.805, "learn_time_ms": 10332.614, "learn_throughput": 387.124, "synch_weights_time_ms": 7.389}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 12, "training_iteration": 103, "trial_id": "40f87_00000", "date": "2023-09-21_12-58-53", "timestamp": 1695272333, "time_this_iter_s": 22.074910879135132, "time_total_s": 2267.825049161911, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2267.825049161911, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 29.451612903225804, "ram_util_percent": 55.764516129032245}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45300853543824726, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.879999999999996e-05, "total_loss": -0.027068249871879214, "policy_loss": -0.03963355893765839, "vf_loss": 0.11224068039202041, "vf_explained_var": -0.08452094021824098, "kl": 0.008266064339759523, "entropy": 0.42985923576258844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 51336.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 22013.335, "sample_time_ms": 11651.734, "load_time_ms": 24.0, "load_throughput": 166666.494, "learn_time_ms": 10329.912, "learn_throughput": 387.225, "synch_weights_time_ms": 7.489}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 12, "training_iteration": 104, "trial_id": "40f87_00000", "date": "2023-09-21_12-59-15", "timestamp": 1695272355, "time_this_iter_s": 21.894282817840576, "time_total_s": 2289.7193319797516, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2289.7193319797516, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 29.80666666666667, "ram_util_percent": 55.78666666666666}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44021167858473714, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.840000000000002e-05, "total_loss": -0.032790024447510197, "policy_loss": -0.04510916053644201, "vf_loss": 0.1423401718718871, "vf_explained_var": 0.006191083139950229, "kl": 0.00810199290064335, "entropy": 0.42816010712375563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 51832.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 22001.756, "sample_time_ms": 11652.447, "load_time_ms": 24.004, "load_throughput": 166640.339, "learn_time_ms": 10317.719, "learn_throughput": 387.683, "synch_weights_time_ms": 7.586}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 12, "training_iteration": 105, "trial_id": "40f87_00000", "date": "2023-09-21_12-59-37", "timestamp": 1695272377, "time_this_iter_s": 21.98028588294983, "time_total_s": 2311.6996178627014, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2311.6996178627014, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 28.209677419354836, "ram_util_percent": 55.81290322580645}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4230388090795567, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.800000000000001e-05, "total_loss": -0.03167004677497091, "policy_loss": -0.04149160920191677, "vf_loss": 0.1076506542777943, "vf_explained_var": -0.013433473605302072, "kl": 0.006459785925248982, "entropy": 0.40117921139444074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 52328.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 22002.832, "sample_time_ms": 11651.543, "load_time_ms": 24.007, "load_throughput": 166620.314, "learn_time_ms": 10319.799, "learn_throughput": 387.604, "synch_weights_time_ms": 7.483}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 12, "training_iteration": 106, "trial_id": "40f87_00000", "date": "2023-09-21_12-59-59", "timestamp": 1695272399, "time_this_iter_s": 21.99065375328064, "time_total_s": 2333.690271615982, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2333.690271615982, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 28.58064516129032, "ram_util_percent": 55.829032258064515}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4683834111257907, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.760000000000002e-05, "total_loss": -0.04759991894506158, "policy_loss": -0.05873096252100602, "vf_loss": 0.10086334872269823, "vf_explained_var": 0.06355099536238178, "kl": 0.007322442360149243, "entropy": 0.41821198796312653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 52824.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 21983.582, "sample_time_ms": 11646.351, "load_time_ms": 23.89, "load_throughput": 167435.949, "learn_time_ms": 10305.762, "learn_throughput": 388.132, "synch_weights_time_ms": 7.48}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 12, "training_iteration": 107, "trial_id": "40f87_00000", "date": "2023-09-21_13-00-21", "timestamp": 1695272421, "time_this_iter_s": 21.796693801879883, "time_total_s": 2355.486965417862, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2355.486965417862, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 31.690322580645162, "ram_util_percent": 56.06774193548385}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45596300585255506, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.720000000000001e-05, "total_loss": -0.033818754025795046, "policy_loss": -0.04597436212145934, "vf_loss": 0.11377115635531804, "vf_explained_var": 0.08902577274749356, "kl": 0.007996199017966934, "entropy": 0.428909245878458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 53320.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 21935.321, "sample_time_ms": 11630.241, "load_time_ms": 23.887, "load_throughput": 167454.833, "learn_time_ms": 10273.613, "learn_throughput": 389.347, "synch_weights_time_ms": 7.479}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 12, "training_iteration": 108, "trial_id": "40f87_00000", "date": "2023-09-21_13-00-42", "timestamp": 1695272442, "time_this_iter_s": 21.515260219573975, "time_total_s": 2377.002225637436, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2377.002225637436, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 30.29, "ram_util_percent": 56.109999999999985}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4807506931885596, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.68e-05, "total_loss": -0.05328049967459764, "policy_loss": -0.06470888217130953, "vf_loss": 0.06406299111380752, "vf_explained_var": -0.09249639210681762, "kl": 0.007520643082144749, "entropy": 0.43873126065779117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 53816.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 21905.839, "sample_time_ms": 11617.701, "load_time_ms": 23.788, "load_throughput": 168155.049, "learn_time_ms": 10256.571, "learn_throughput": 389.994, "synch_weights_time_ms": 7.481}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 12, "training_iteration": 109, "trial_id": "40f87_00000", "date": "2023-09-21_13-01-04", "timestamp": 1695272464, "time_this_iter_s": 21.75678062438965, "time_total_s": 2398.7590062618256, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2398.7590062618256, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 31.793333333333333, "ram_util_percent": 56.09666666666666}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4142872730810796, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.64e-05, "total_loss": -0.03484800614035433, "policy_loss": -0.044257561866317935, "vf_loss": 0.09468803227496063, "vf_explained_var": -0.08567341236818221, "kl": 0.00618935717893467, "entropy": 0.4422756524215783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 54312.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 21862.001, "sample_time_ms": 11594.468, "load_time_ms": 23.762, "load_throughput": 168332.539, "learn_time_ms": 10236.091, "learn_throughput": 390.774, "synch_weights_time_ms": 7.381}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 12, "training_iteration": 110, "trial_id": "40f87_00000", "date": "2023-09-21_13-01-26", "timestamp": 1695272486, "time_this_iter_s": 21.636292695999146, "time_total_s": 2420.3952989578247, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2420.3952989578247, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 31.03548387096774, "ram_util_percent": 56.1225806451613}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4692512505177048, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.599999999999999e-05, "total_loss": -0.048450763782321084, "policy_loss": -0.061148332368541176, "vf_loss": 0.1016140733394892, "vf_explained_var": -0.01958285884991769, "kl": 0.008353849479388942, "entropy": 0.45149881548939214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 54808.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 21819.197, "sample_time_ms": 11579.255, "load_time_ms": 23.766, "load_throughput": 168309.572, "learn_time_ms": 10208.5, "learn_throughput": 391.83, "synch_weights_time_ms": 7.278}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 12, "training_iteration": 111, "trial_id": "40f87_00000", "date": "2023-09-21_13-01-47", "timestamp": 1695272507, "time_this_iter_s": 21.605101346969604, "time_total_s": 2442.0004003047943, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2442.0004003047943, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 30.169999999999998, "ram_util_percent": 56.04333333333331}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.502672832579382, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.559999999999997e-05, "total_loss": -0.05698973433332397, "policy_loss": -0.07027390827123224, "vf_loss": 0.09277575480706629, "vf_explained_var": 0.0897130653742821, "kl": 0.00874067287788521, "entropy": 0.4880501504747137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 55304.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 21774.504, "sample_time_ms": 11564.809, "load_time_ms": 23.666, "load_throughput": 169019.694, "learn_time_ms": 10178.253, "learn_throughput": 392.995, "synch_weights_time_ms": 7.378}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 12, "training_iteration": 112, "trial_id": "40f87_00000", "date": "2023-09-21_13-02-09", "timestamp": 1695272529, "time_this_iter_s": 21.624894380569458, "time_total_s": 2463.6252946853638, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2463.6252946853638, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 31.166666666666664, "ram_util_percent": 56.10666666666667}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48241518311683207, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.520000000000004e-05, "total_loss": -0.04106165199717056, "policy_loss": -0.05258128244566897, "vf_loss": 0.09256154333706945, "vf_explained_var": 0.10289697697566401, "kl": 0.007578845515632976, "entropy": 0.46109960552665497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 55800.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 21732.224, "sample_time_ms": 11557.874, "load_time_ms": 24.085, "load_throughput": 166076.519, "learn_time_ms": 10142.585, "learn_throughput": 394.377, "synch_weights_time_ms": 7.282}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 12, "training_iteration": 113, "trial_id": "40f87_00000", "date": "2023-09-21_13-02-31", "timestamp": 1695272551, "time_this_iter_s": 21.651078462600708, "time_total_s": 2485.2763731479645, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2485.2763731479645, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 30.7516129032258, "ram_util_percent": 56.09032258064515}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4735047860191234, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.480000000000002e-05, "total_loss": -0.04632760317960469, "policy_loss": -0.057821666717230866, "vf_loss": 0.08969121891254138, "vf_explained_var": 0.06781441934647099, "kl": 0.007562203894598077, "entropy": 0.4690311237448646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 56296.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 21712.733, "sample_time_ms": 11560.692, "load_time_ms": 24.085, "load_throughput": 166081.615, "learn_time_ms": 10120.272, "learn_throughput": 395.246, "synch_weights_time_ms": 7.286}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 12, "training_iteration": 114, "trial_id": "40f87_00000", "date": "2023-09-21_13-02-53", "timestamp": 1695272573, "time_this_iter_s": 21.69836688041687, "time_total_s": 2506.9747400283813, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2506.9747400283813, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 30.369999999999997, "ram_util_percent": 56.16333333333332}}
{"custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44177566892317227, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.440000000000002e-05, "total_loss": -0.04693461899202497, "policy_loss": -0.05718089515123152, "vf_loss": 0.17616338167910375, "vf_explained_var": 0.1012435132457364, "kl": 0.006734920253049396, "entropy": 0.4926667319790971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 56792.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -99.60666666666668, "portfolio_return_min": -100.0, "portfolio_return_max": -97.52, "position_changes_mean": 36.815, "position_changes_min": 33.21, "position_changes_max": 42.48, "max_drawdown_mean": -99.66083333333334, "max_drawdown_min": -100.0, "max_drawdown_max": -97.84}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}}, "episode_reward_max": -298.20876741041553, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -425.8308005290093, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4790891295345601, "mean_inference_ms": 3.079503188037153, "mean_action_processing_ms": 0.1433820475169808, "mean_env_wait_ms": 2.0333956324772555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008334716161092123, "MeanStdObservationFilterAgentConnector_ms": 0.04189610481262207, "StateBufferConnector_ms": 0.008296966552734375, "ViewRequirementAgentConnector_ms": 0.15870332717895508}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 21674.343, "sample_time_ms": 11547.314, "load_time_ms": 23.981, "load_throughput": 166800.713, "learn_time_ms": 10095.464, "learn_throughput": 396.218, "synch_weights_time_ms": 7.187}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 12, "training_iteration": 115, "trial_id": "40f87_00000", "date": "2023-09-21_13-03-14", "timestamp": 1695272594, "time_this_iter_s": 21.596383094787598, "time_total_s": 2528.571123123169, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2528.571123123169, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 30.800000000000004, "ram_util_percent": 56.17666666666667}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41781174571764085, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.400000000000002e-05, "total_loss": -0.04677096259735164, "policy_loss": -0.057580120962924294, "vf_loss": 0.12455208764802064, "vf_explained_var": 0.03841855689402549, "kl": 0.0071089396130694545, "entropy": 0.44827173686315935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.51612903225806, "num_grad_updates_lifetime": 57288.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 21649.853, "sample_time_ms": 11545.511, "load_time_ms": 23.878, "load_throughput": 167519.708, "learn_time_ms": 10072.681, "learn_throughput": 397.114, "synch_weights_time_ms": 7.286}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 14, "training_iteration": 116, "trial_id": "40f87_00000", "date": "2023-09-21_13-03-36", "timestamp": 1695272616, "time_this_iter_s": 21.74575114250183, "time_total_s": 2550.316874265671, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2550.316874265671, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 29.916129032258066, "ram_util_percent": 56.17419354838709}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48107896024180996, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.360000000000001e-05, "total_loss": -0.05078838841948328, "policy_loss": -0.06280279951733386, "vf_loss": 0.10331375436902407, "vf_explained_var": 0.12614268316857277, "kl": 0.007903920935959657, "entropy": 0.4144048667362621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 57784.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 21634.336, "sample_time_ms": 11537.126, "load_time_ms": 23.994, "load_throughput": 166708.228, "learn_time_ms": 10065.529, "learn_throughput": 397.396, "synch_weights_time_ms": 7.289}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 14, "training_iteration": 117, "trial_id": "40f87_00000", "date": "2023-09-21_13-03-58", "timestamp": 1695272638, "time_this_iter_s": 21.64150071144104, "time_total_s": 2571.958374977112, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2571.958374977112, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 30.930000000000003, "ram_util_percent": 56.133333333333326}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4637899884293156, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.32e-05, "total_loss": -0.03217454317716822, "policy_loss": -0.04179520128602763, "vf_loss": 0.08861466520090377, "vf_explained_var": -0.05994165712787259, "kl": 0.006328755015388994, "entropy": 0.39860423179643767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 58280.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 21653.358, "sample_time_ms": 11537.515, "load_time_ms": 24.0, "load_throughput": 166666.66, "learn_time_ms": 10083.753, "learn_throughput": 396.678, "synch_weights_time_ms": 7.593}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 14, "training_iteration": 118, "trial_id": "40f87_00000", "date": "2023-09-21_13-04-19", "timestamp": 1695272659, "time_this_iter_s": 21.70647358894348, "time_total_s": 2593.6648485660553, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2593.6648485660553, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 30.658064516129027, "ram_util_percent": 56.19677419354838}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49228999256006173, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.280000000000001e-05, "total_loss": -0.030772504033408157, "policy_loss": -0.041125651258616634, "vf_loss": 0.13453574539838178, "vf_explained_var": 0.04777035501695449, "kl": 0.006808029033525509, "entropy": 0.40082879028012675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 58776.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 21677.79, "sample_time_ms": 11538.02, "load_time_ms": 24.1, "load_throughput": 165976.789, "learn_time_ms": 10107.78, "learn_throughput": 395.735, "synch_weights_time_ms": 7.591}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 14, "training_iteration": 119, "trial_id": "40f87_00000", "date": "2023-09-21_13-04-41", "timestamp": 1695272681, "time_this_iter_s": 22.00378704071045, "time_total_s": 2615.6686356067657, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2615.6686356067657, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 31.1, "ram_util_percent": 55.98999999999998}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4849367973004137, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.24e-05, "total_loss": -0.03909268401630764, "policy_loss": -0.04952731049401806, "vf_loss": 0.06495697349835668, "vf_explained_var": 0.0066644799324773974, "kl": 0.006866260529031878, "entropy": 0.4152074914665953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 59272.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 21708.222, "sample_time_ms": 11562.327, "load_time_ms": 24.025, "load_throughput": 166494.977, "learn_time_ms": 10113.783, "learn_throughput": 395.5, "synch_weights_time_ms": 7.787}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 14, "training_iteration": 120, "trial_id": "40f87_00000", "date": "2023-09-21_13-05-03", "timestamp": 1695272703, "time_this_iter_s": 21.940584897994995, "time_total_s": 2637.6092205047607, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2637.6092205047607, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 30.82903225806451, "ram_util_percent": 55.60322580645161}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5013349268345102, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.2e-05, "total_loss": -0.03556248542642401, "policy_loss": -0.048450296782257575, "vf_loss": 0.0999412571958777, "vf_explained_var": -0.08320239090150403, "kl": 0.008479219678358104, "entropy": 0.4130837756299203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 59768.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 21718.523, "sample_time_ms": 11569.641, "load_time_ms": 24.021, "load_throughput": 166518.277, "learn_time_ms": 10116.573, "learn_throughput": 395.391, "synch_weights_time_ms": 7.987}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 14, "training_iteration": 121, "trial_id": "40f87_00000", "date": "2023-09-21_13-05-25", "timestamp": 1695272725, "time_this_iter_s": 21.70711040496826, "time_total_s": 2659.316330909729, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2659.316330909729, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 31.493548387096773, "ram_util_percent": 55.59999999999998}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47278544853531546, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.159999999999999e-05, "total_loss": -0.04885131802016516, "policy_loss": -0.05941005499907107, "vf_loss": 0.0934828360670156, "vf_explained_var": -0.09923449098583191, "kl": 0.006946099504701774, "entropy": 0.386747800835198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 60264.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 21753.27, "sample_time_ms": 11570.023, "load_time_ms": 24.018, "load_throughput": 166541.254, "learn_time_ms": 10150.945, "learn_throughput": 394.052, "synch_weights_time_ms": 7.884}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 14, "training_iteration": 122, "trial_id": "40f87_00000", "date": "2023-09-21_13-05-47", "timestamp": 1695272747, "time_this_iter_s": 21.97247314453125, "time_total_s": 2681.2888040542603, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2681.2888040542603, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 30.256666666666664, "ram_util_percent": 55.63}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4199512706048066, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.119999999999998e-05, "total_loss": -0.02729501638274204, "policy_loss": -0.0358491348771138, "vf_loss": 0.11598564780527545, "vf_explained_var": -0.039475425476989436, "kl": 0.005624703745340066, "entropy": 0.4028234301555541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 60760.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 21805.454, "sample_time_ms": 11595.492, "load_time_ms": 23.599, "load_throughput": 169498.673, "learn_time_ms": 10177.878, "learn_throughput": 393.009, "synch_weights_time_ms": 8.084}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 14, "training_iteration": 123, "trial_id": "40f87_00000", "date": "2023-09-21_13-06-09", "timestamp": 1695272769, "time_this_iter_s": 22.174915313720703, "time_total_s": 2703.463719367981, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2703.463719367981, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 29.954838709677418, "ram_util_percent": 55.564516129032256}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.501257877826931, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.079999999999999e-05, "total_loss": -0.04461100365170428, "policy_loss": -0.056842918094550825, "vf_loss": 0.11092256733231366, "vf_explained_var": 0.10533119846255548, "kl": 0.008046633330161417, "entropy": 0.4114378581965162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 61256.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 21852.85, "sample_time_ms": 11609.605, "load_time_ms": 23.599, "load_throughput": 169500.215, "learn_time_ms": 10210.664, "learn_throughput": 391.747, "synch_weights_time_ms": 8.582}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 14, "training_iteration": 124, "trial_id": "40f87_00000", "date": "2023-09-21_13-06-31", "timestamp": 1695272791, "time_this_iter_s": 22.172332525253296, "time_total_s": 2725.6360518932343, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2725.6360518932343, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 30.8375, "ram_util_percent": 55.6875}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4758662547495577, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.039999999999998e-05, "total_loss": -0.0464088267443942, "policy_loss": -0.05741650579030618, "vf_loss": 0.08591665629102217, "vf_explained_var": 0.06649684196998996, "kl": 0.007242196801425264, "entropy": 0.40788211499250704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 61752.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 21911.769, "sample_time_ms": 11630.199, "load_time_ms": 23.599, "load_throughput": 169500.386, "learn_time_ms": 10248.786, "learn_throughput": 390.29, "synch_weights_time_ms": 8.583}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 14, "training_iteration": 125, "trial_id": "40f87_00000", "date": "2023-09-21_13-06-54", "timestamp": 1695272814, "time_this_iter_s": 22.184547185897827, "time_total_s": 2747.820599079132, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2747.820599079132, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 30.65806451612903, "ram_util_percent": 55.67741935483872}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4319832701716692, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 6.0000000000000015e-05, "total_loss": -0.03230098511783346, "policy_loss": -0.04120765810441827, "vf_loss": 0.1841570780642571, "vf_explained_var": -0.04803516559543148, "kl": 0.005852350396501818, "entropy": 0.4181923070742238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 62248.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 21961.845, "sample_time_ms": 11650.834, "load_time_ms": 23.699, "load_throughput": 168785.548, "learn_time_ms": 10278.324, "learn_throughput": 389.169, "synch_weights_time_ms": 8.486}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 14, "training_iteration": 126, "trial_id": "40f87_00000", "date": "2023-09-21_13-07-16", "timestamp": 1695272836, "time_this_iter_s": 22.24549174308777, "time_total_s": 2770.06609082222, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2770.06609082222, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 29.522580645161288, "ram_util_percent": 55.74193548387097}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5219407230615616, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.960000000000001e-05, "total_loss": -0.03210033788420861, "policy_loss": -0.043347339853719476, "vf_loss": 0.0556116463567671, "vf_explained_var": 0.04689411903100629, "kl": 0.007401772830826557, "entropy": 0.43184612667368305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 62744.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 22014.395, "sample_time_ms": 11674.855, "load_time_ms": 23.699, "load_throughput": 168786.228, "learn_time_ms": 10306.754, "learn_throughput": 388.095, "synch_weights_time_ms": 8.483}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 14, "training_iteration": 127, "trial_id": "40f87_00000", "date": "2023-09-21_13-07-38", "timestamp": 1695272858, "time_this_iter_s": 22.167773485183716, "time_total_s": 2792.2338643074036, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2792.2338643074036, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 29.361290322580643, "ram_util_percent": 55.72903225806451}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4696544697508216, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.920000000000002e-05, "total_loss": -0.06270941778465415, "policy_loss": -0.07462353888286823, "vf_loss": 0.10163697536148492, "vf_explained_var": -0.07642249498636491, "kl": 0.007837997532903315, "entropy": 0.4470189899326332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 63240.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 22034.517, "sample_time_ms": 11712.952, "load_time_ms": 23.595, "load_throughput": 169524.021, "learn_time_ms": 10288.986, "learn_throughput": 388.765, "synch_weights_time_ms": 8.28}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 14, "training_iteration": 128, "trial_id": "40f87_00000", "date": "2023-09-21_13-08-00", "timestamp": 1695272880, "time_this_iter_s": 21.908623695373535, "time_total_s": 2814.142488002777, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2814.142488002777, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 33.30967741935484, "ram_util_percent": 55.07741935483869}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4971593273503165, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.8800000000000006e-05, "total_loss": -0.06077888464008743, "policy_loss": -0.07306285231419268, "vf_loss": 0.0620994255502498, "vf_explained_var": 0.08057743875730422, "kl": 0.008084122591754143, "entropy": 0.4750318091002203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 63736.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 21993.671, "sample_time_ms": 11705.575, "load_time_ms": 23.495, "load_throughput": 170245.659, "learn_time_ms": 10255.52, "learn_throughput": 390.034, "synch_weights_time_ms": 8.28}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 14, "training_iteration": 129, "trial_id": "40f87_00000", "date": "2023-09-21_13-08-22", "timestamp": 1695272902, "time_this_iter_s": 21.59263586997986, "time_total_s": 2835.735123872757, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2835.735123872757, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 30.97666666666667, "ram_util_percent": 54.846666666666685}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4482612045061204, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.84e-05, "total_loss": -0.033824881597895234, "policy_loss": -0.04298840984296065, "vf_loss": 0.12729199744776012, "vf_explained_var": 0.08837061795976854, "kl": 0.0060252168147280774, "entropy": 0.4422182074237254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 64232.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 21968.916, "sample_time_ms": 11686.844, "load_time_ms": 23.495, "load_throughput": 170245.832, "learn_time_ms": 10249.493, "learn_throughput": 390.263, "synch_weights_time_ms": 8.083}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 14, "training_iteration": 130, "trial_id": "40f87_00000", "date": "2023-09-21_13-08-43", "timestamp": 1695272923, "time_this_iter_s": 21.6930091381073, "time_total_s": 2857.4281330108643, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2857.4281330108643, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 31.28333333333334, "ram_util_percent": 54.93333333333332}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5096798054873943, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.800000000000001e-05, "total_loss": -0.02971633750900266, "policy_loss": -0.04132223931223815, "vf_loss": 0.11050295376128727, "vf_explained_var": 0.014024063824645935, "kl": 0.007634468983547618, "entropy": 0.4754371092684807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 64728.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 21958.721, "sample_time_ms": 11680.965, "load_time_ms": 23.496, "load_throughput": 170242.031, "learn_time_ms": 10245.076, "learn_throughput": 390.431, "synch_weights_time_ms": 8.283}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 14, "training_iteration": 131, "trial_id": "40f87_00000", "date": "2023-09-21_13-09-05", "timestamp": 1695272945, "time_this_iter_s": 21.606176614761353, "time_total_s": 2879.0343096256256, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2879.0343096256256, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 30.964516129032262, "ram_util_percent": 54.82903225806453}}
{"custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5027263979878156, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.7600000000000004e-05, "total_loss": -0.050577950983067915, "policy_loss": -0.06193169994437466, "vf_loss": 0.08630409519819002, "vf_explained_var": 0.04165150345333161, "kl": 0.007470037240103721, "entropy": 0.4654118356204802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 65224.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -98.6107142857143, "portfolio_return_min": -100.0, "portfolio_return_max": -92.07, "position_changes_mean": 36.29642857142857, "position_changes_min": 33.14, "position_changes_max": 42.48, "max_drawdown_mean": -98.86785714285715, "max_drawdown_min": -100.0, "max_drawdown_max": -93.66}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}}, "episode_reward_max": -271.80540610776194, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -404.54690961391054, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47928989048807596, "mean_inference_ms": 3.0787724389673667, "mean_action_processing_ms": 0.14348906035007697, "mean_env_wait_ms": 2.03392536903294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.050199031829833984, "StateBufferConnector_ms": 0.007111685616629464, "ViewRequirementAgentConnector_ms": 0.16463484082903182}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 21920.424, "sample_time_ms": 11682.142, "load_time_ms": 23.599, "load_throughput": 169496.447, "learn_time_ms": 10205.596, "learn_throughput": 391.942, "synch_weights_time_ms": 8.286}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 14, "training_iteration": 132, "trial_id": "40f87_00000", "date": "2023-09-21_13-09-27", "timestamp": 1695272967, "time_this_iter_s": 21.589401721954346, "time_total_s": 2900.62371134758, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2900.62371134758, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 31.046666666666663, "ram_util_percent": 54.856666666666676}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4964629991520797, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.719999999999999e-05, "total_loss": -0.04276473197763065, "policy_loss": -0.05431269679426013, "vf_loss": 0.09607422147922579, "vf_explained_var": 0.1618681789165543, "kl": 0.007597274061954858, "entropy": 0.40989956121531224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.48387096774194, "num_grad_updates_lifetime": 65720.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 21863.016, "sample_time_ms": 11653.326, "load_time_ms": 23.6, "load_throughput": 169494.735, "learn_time_ms": 10177.207, "learn_throughput": 393.035, "synch_weights_time_ms": 8.083}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 16, "training_iteration": 133, "trial_id": "40f87_00000", "date": "2023-09-21_13-09-48", "timestamp": 1695272988, "time_this_iter_s": 21.59886360168457, "time_total_s": 2922.2225749492645, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2922.2225749492645, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 30.82333333333333, "ram_util_percent": 54.75333333333332}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49127407996885236, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.68e-05, "total_loss": -0.043882284155716336, "policy_loss": -0.05466740989621969, "vf_loss": 0.14478789089292649, "vf_explained_var": 0.09495104332604716, "kl": 0.007091783540598018, "entropy": 0.40465916434843696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 66216.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 21811.108, "sample_time_ms": 11628.123, "load_time_ms": 23.6, "load_throughput": 169494.906, "learn_time_ms": 10151.105, "learn_throughput": 394.046, "synch_weights_time_ms": 7.48}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 16, "training_iteration": 134, "trial_id": "40f87_00000", "date": "2023-09-21_13-10-10", "timestamp": 1695273010, "time_this_iter_s": 21.654242038726807, "time_total_s": 2943.8768169879913, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2943.8768169879913, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 30.133333333333336, "ram_util_percent": 54.83333333333334}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4587500188199262, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.6399999999999995e-05, "total_loss": -0.023365074562588555, "policy_loss": -0.03151391199694884, "vf_loss": 0.13094116715458973, "vf_explained_var": -0.007157342929032541, "kl": 0.005356867797440513, "entropy": 0.38912962190806866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 66712.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 21759.806, "sample_time_ms": 11611.029, "load_time_ms": 23.6, "load_throughput": 169493.708, "learn_time_ms": 10117.099, "learn_throughput": 395.37, "synch_weights_time_ms": 7.48}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 16, "training_iteration": 135, "trial_id": "40f87_00000", "date": "2023-09-21_13-10-32", "timestamp": 1695273032, "time_this_iter_s": 21.67255473136902, "time_total_s": 2965.5493717193604, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2965.5493717193604, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 30.719354838709677, "ram_util_percent": 54.787096774193536}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46536497071745897, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.600000000000003e-05, "total_loss": -0.026033560374109525, "policy_loss": -0.03546564183359864, "vf_loss": 0.10612159553960326, "vf_explained_var": -0.06010473759904984, "kl": 0.006203436172693821, "entropy": 0.40221526173333966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 67208.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 21706.159, "sample_time_ms": 11578.816, "load_time_ms": 23.601, "load_throughput": 169485.66, "learn_time_ms": 10095.565, "learn_throughput": 396.214, "synch_weights_time_ms": 7.48}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 16, "training_iteration": 136, "trial_id": "40f87_00000", "date": "2023-09-21_13-10-53", "timestamp": 1695273053, "time_this_iter_s": 21.71004891395569, "time_total_s": 2987.259420633316, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2987.259420633316, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 30.546666666666667, "ram_util_percent": 54.86000000000001}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5289568124759582, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.560000000000002e-05, "total_loss": -0.04699824516841721, "policy_loss": -0.05902674298493132, "vf_loss": 0.06637023317988121, "vf_explained_var": -0.1266137279810444, "kl": 0.007915628268407505, "entropy": 0.40386067318820185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 67704.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 21641.428, "sample_time_ms": 11546.402, "load_time_ms": 23.601, "load_throughput": 169484.975, "learn_time_ms": 10063.249, "learn_throughput": 397.486, "synch_weights_time_ms": 7.58}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 16, "training_iteration": 137, "trial_id": "40f87_00000", "date": "2023-09-21_13-11-15", "timestamp": 1695273075, "time_this_iter_s": 21.523709297180176, "time_total_s": 3008.783129930496, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3008.783129930496, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 32.68333333333333, "ram_util_percent": 54.803333333333335}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5118384896627357, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.5200000000000014e-05, "total_loss": -0.04755701751151543, "policy_loss": -0.058002363047806635, "vf_loss": 0.11626231993338274, "vf_explained_var": -0.006440815185346911, "kl": 0.006869938567205603, "entropy": 0.40535518857500247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 68200.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 21609.862, "sample_time_ms": 11513.056, "load_time_ms": 24.098, "load_throughput": 165988.941, "learn_time_ms": 10064.745, "learn_throughput": 397.427, "synch_weights_time_ms": 7.466}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 16, "training_iteration": 138, "trial_id": "40f87_00000", "date": "2023-09-21_13-11-37", "timestamp": 1695273097, "time_this_iter_s": 21.59103012084961, "time_total_s": 3030.374160051346, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3030.374160051346, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 30.625806451612902, "ram_util_percent": 54.903225806451616}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45125167342203276, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.4800000000000024e-05, "total_loss": -0.036241381248879816, "policy_loss": -0.045123898814762795, "vf_loss": 0.10156415972573261, "vf_explained_var": 0.010680173313425433, "kl": 0.005841884138824281, "entropy": 0.3794305954849528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 68696.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 21620.83, "sample_time_ms": 11514.27, "load_time_ms": 24.198, "load_throughput": 165304.82, "learn_time_ms": 10074.596, "learn_throughput": 397.038, "synch_weights_time_ms": 7.366}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 16, "training_iteration": 139, "trial_id": "40f87_00000", "date": "2023-09-21_13-11-58", "timestamp": 1695273118, "time_this_iter_s": 21.703348636627197, "time_total_s": 3052.077508687973, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3052.077508687973, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 31.276666666666667, "ram_util_percent": 54.813333333333325}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5179767171221394, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.4400000000000014e-05, "total_loss": -0.0318505750779408, "policy_loss": -0.04288608982155453, "vf_loss": 0.06969096195403367, "vf_explained_var": 0.01183183238871636, "kl": 0.007261593685832806, "entropy": 0.4025371873210515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 69192.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 21615.153, "sample_time_ms": 11509.468, "load_time_ms": 24.198, "load_throughput": 165305.96, "learn_time_ms": 10073.822, "learn_throughput": 397.069, "synch_weights_time_ms": 7.465}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 16, "training_iteration": 140, "trial_id": "40f87_00000", "date": "2023-09-21_13-12-20", "timestamp": 1695273140, "time_this_iter_s": 21.636252880096436, "time_total_s": 3073.7137615680695, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3073.7137615680695, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 31.88333333333333, "ram_util_percent": 54.80666666666668}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49359236549465885, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.4000000000000005e-05, "total_loss": -0.042102541437470206, "policy_loss": -0.05274534191759754, "vf_loss": 0.14181989305577572, "vf_explained_var": 0.11490061530663122, "kl": 0.006998267666720947, "entropy": 0.40440086293364724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 69688.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 21615.416, "sample_time_ms": 11511.284, "load_time_ms": 24.1, "load_throughput": 165972.192, "learn_time_ms": 10072.67, "learn_throughput": 397.114, "synch_weights_time_ms": 7.065}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 16, "training_iteration": 141, "trial_id": "40f87_00000", "date": "2023-09-21_13-12-42", "timestamp": 1695273162, "time_this_iter_s": 21.608810424804688, "time_total_s": 3095.322571992874, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3095.322571992874, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 30.40645161290322, "ram_util_percent": 53.983870967741936}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49330621945761866, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.36e-05, "total_loss": -0.03462383570149541, "policy_loss": -0.044614907068711136, "vf_loss": 0.11692980235074496, "vf_explained_var": -0.05977992124615177, "kl": 0.006570785446628507, "entropy": 0.41043305030513194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 70184.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 21633.413, "sample_time_ms": 11509.847, "load_time_ms": 24.1, "load_throughput": 165972.848, "learn_time_ms": 10091.999, "learn_throughput": 396.354, "synch_weights_time_ms": 7.066}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 16, "training_iteration": 142, "trial_id": "40f87_00000", "date": "2023-09-21_13-13-03", "timestamp": 1695273183, "time_this_iter_s": 21.769389867782593, "time_total_s": 3117.0919618606567, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3117.0919618606567, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 33.940000000000005, "ram_util_percent": 54.17999999999999}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5233755864263061, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.32e-05, "total_loss": -0.03589761555967045, "policy_loss": -0.046770828214785946, "vf_loss": 0.06046273451553838, "vf_explained_var": 0.009145664832284373, "kl": 0.007155338024806469, "entropy": 0.4234097992340403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 70680.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 21654.883, "sample_time_ms": 11530.132, "load_time_ms": 24.1, "load_throughput": 165973.341, "learn_time_ms": 10093.084, "learn_throughput": 396.311, "synch_weights_time_ms": 7.166}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 16, "training_iteration": 143, "trial_id": "40f87_00000", "date": "2023-09-21_13-13-25", "timestamp": 1695273205, "time_this_iter_s": 21.81376624107361, "time_total_s": 3138.9057281017303, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3138.9057281017303, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 31.993548387096773, "ram_util_percent": 54.28064516129031}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4738637296663177, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.279999999999999e-05, "total_loss": -0.046811902324759194, "policy_loss": -0.05777648822855084, "vf_loss": 0.11100873989879244, "vf_explained_var": 0.0037682550328393136, "kl": 0.007212170748581943, "entropy": 0.424981162372616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 71176.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 21654.616, "sample_time_ms": 11531.513, "load_time_ms": 24.001, "load_throughput": 166663.018, "learn_time_ms": 10091.36, "learn_throughput": 396.379, "synch_weights_time_ms": 7.242}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 16, "training_iteration": 144, "trial_id": "40f87_00000", "date": "2023-09-21_13-13-47", "timestamp": 1695273227, "time_this_iter_s": 21.650569677352905, "time_total_s": 3160.5562977790833, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3160.5562977790833, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 31.133333333333333, "ram_util_percent": 54.363333333333344}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4683453006549708, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.24e-05, "total_loss": -0.04116918293443779, "policy_loss": -0.05222669082145477, "vf_loss": 0.13985847269049695, "vf_explained_var": 0.0756391620924396, "kl": 0.007271454820114511, "entropy": 0.4685695546288644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 71672.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 21648.682, "sample_time_ms": 11530.537, "load_time_ms": 24.1, "load_throughput": 165974.983, "learn_time_ms": 10086.298, "learn_throughput": 396.578, "synch_weights_time_ms": 7.248}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 16, "training_iteration": 145, "trial_id": "40f87_00000", "date": "2023-09-21_13-14-09", "timestamp": 1695273249, "time_this_iter_s": 21.61219620704651, "time_total_s": 3182.1684939861298, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3182.1684939861298, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 30.458064516129035, "ram_util_percent": 54.23225806451612}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45021066270888815, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.199999999999999e-05, "total_loss": -0.07165405043539771, "policy_loss": -0.08178687875249213, "vf_loss": 0.08812684428337361, "vf_explained_var": 0.15398499213399425, "kl": 0.006666016734448832, "entropy": 0.4367107747783584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 72168.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 21637.564, "sample_time_ms": 11534.885, "load_time_ms": 24.099, "load_throughput": 165983.193, "learn_time_ms": 10070.835, "learn_throughput": 397.187, "synch_weights_time_ms": 7.345}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 16, "training_iteration": 146, "trial_id": "40f87_00000", "date": "2023-09-21_13-14-30", "timestamp": 1695273270, "time_this_iter_s": 21.59878945350647, "time_total_s": 3203.7672834396362, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3203.7672834396362, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 31.76, "ram_util_percent": 54.33666666666668}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5214132449078944, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.159999999999998e-05, "total_loss": -0.03705886988187088, "policy_loss": -0.04800836793325406, "vf_loss": 0.08738603432392401, "vf_explained_var": -0.059096464827176065, "kl": 0.007203792581467074, "entropy": 0.44837413121375347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 72664.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 21639.938, "sample_time_ms": 11538.584, "load_time_ms": 23.999, "load_throughput": 166672.29, "learn_time_ms": 10069.61, "learn_throughput": 397.235, "synch_weights_time_ms": 7.345}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 16, "training_iteration": 147, "trial_id": "40f87_00000", "date": "2023-09-21_13-14-52", "timestamp": 1695273292, "time_this_iter_s": 21.544461488723755, "time_total_s": 3225.31174492836, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3225.31174492836, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 30.886666666666663, "ram_util_percent": 54.230000000000004}}
{"custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.503101168260459, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.1199999999999984e-05, "total_loss": -0.04356760381309751, "policy_loss": -0.05499097511581626, "vf_loss": 0.10165374974660095, "vf_explained_var": -0.01829731909017409, "kl": 0.007514869572559001, "entropy": 0.47389831934725085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 73160.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -94.119375, "portfolio_return_min": -100.0, "portfolio_return_max": -62.64, "position_changes_mean": 35.868125, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -97.00874999999999, "max_drawdown_min": -100.0, "max_drawdown_max": -80.67}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}}, "episode_reward_max": -223.3248565851711, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -382.1190840628635, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47952916693688086, "mean_inference_ms": 3.0781575042300666, "mean_action_processing_ms": 0.14362111919661713, "mean_env_wait_ms": 2.03451284817016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251037120819092, "MeanStdObservationFilterAgentConnector_ms": 0.05016922950744629, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.15653520822525024}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 21638.734, "sample_time_ms": 11538.566, "load_time_ms": 23.602, "load_throughput": 169476.586, "learn_time_ms": 10068.805, "learn_throughput": 397.267, "synch_weights_time_ms": 7.46}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 16, "training_iteration": 148, "trial_id": "40f87_00000", "date": "2023-09-21_13-15-13", "timestamp": 1695273313, "time_this_iter_s": 21.579975605010986, "time_total_s": 3246.891720533371, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3246.891720533371, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 30.549999999999997, "ram_util_percent": 54.29666666666666}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4508182764834454, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.080000000000001e-05, "total_loss": -0.0505510458005442, "policy_loss": -0.059658800610416236, "vf_loss": 0.15017719355772338, "vf_explained_var": -0.02816397324204445, "kl": 0.0059869857033272465, "entropy": 0.4342355396478407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.45161290322581, "num_grad_updates_lifetime": 73656.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 21632.421, "sample_time_ms": 11539.068, "load_time_ms": 23.903, "load_throughput": 167345.429, "learn_time_ms": 10061.387, "learn_throughput": 397.56, "synch_weights_time_ms": 7.663}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 18, "training_iteration": 149, "trial_id": "40f87_00000", "date": "2023-09-21_13-15-35", "timestamp": 1695273335, "time_this_iter_s": 21.641188144683838, "time_total_s": 3268.532908678055, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3268.532908678055, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 30.190322580645162, "ram_util_percent": 54.23548387096774}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5225243262285667, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.040000000000002e-05, "total_loss": -0.037422573320180806, "policy_loss": -0.049030757540622874, "vf_loss": 0.08153666919397731, "vf_explained_var": 0.07522185567405916, "kl": 0.007637880981518034, "entropy": 0.3954126774183204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 74152.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 21630.534, "sample_time_ms": 11542.205, "load_time_ms": 23.906, "load_throughput": 167322.397, "learn_time_ms": 10056.162, "learn_throughput": 397.766, "synch_weights_time_ms": 7.762}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 18, "training_iteration": 150, "trial_id": "40f87_00000", "date": "2023-09-21_13-15-57", "timestamp": 1695273357, "time_this_iter_s": 21.61739492416382, "time_total_s": 3290.1503036022186, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3290.1503036022186, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 30.406666666666663, "ram_util_percent": 54.32000000000001}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4954742952099731, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.048240352894701514, "policy_loss": -0.05834073657564248, "vf_loss": 0.12759667669513053, "vf_explained_var": -0.050519143381426414, "kl": 0.006642056268856454, "entropy": 0.40104857681980055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 74648.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 604000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 21640.409, "sample_time_ms": 11541.404, "load_time_ms": 23.903, "load_throughput": 167343.593, "learn_time_ms": 10066.835, "learn_throughput": 397.344, "synch_weights_time_ms": 7.765}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "done": false, "episodes_total": 18, "training_iteration": 151, "trial_id": "40f87_00000", "date": "2023-09-21_13-16-18", "timestamp": 1695273378, "time_this_iter_s": 21.708536386489868, "time_total_s": 3311.8588399887085, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3311.8588399887085, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 30.966666666666665, "ram_util_percent": 54.26999999999999}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5406485069543123, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.96e-05, "total_loss": -0.04480272385896364, "policy_loss": -0.055119295968794293, "vf_loss": 0.07089745226286111, "vf_explained_var": -0.0018847305928507158, "kl": 0.006788136800658903, "entropy": 0.38583777346197634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 75144.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 21631.357, "sample_time_ms": 11543.487, "load_time_ms": 23.906, "load_throughput": 167324.066, "learn_time_ms": 10055.802, "learn_throughput": 397.78, "synch_weights_time_ms": 7.764}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "episodes_total": 18, "training_iteration": 152, "trial_id": "40f87_00000", "date": "2023-09-21_13-16-40", "timestamp": 1695273400, "time_this_iter_s": 21.679412126541138, "time_total_s": 3333.5382521152496, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3333.5382521152496, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 31.2741935483871, "ram_util_percent": 54.3451612903226}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4597835107706487, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.9199999999999997e-05, "total_loss": -0.030877049222791327, "policy_loss": -0.03865564712440016, "vf_loss": 0.10651712926975902, "vf_explained_var": -0.05643393339649323, "kl": 0.005114698632519433, "entropy": 0.3963807885565104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 75640.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 21616.885, "sample_time_ms": 11527.408, "load_time_ms": 23.806, "load_throughput": 168027.562, "learn_time_ms": 10057.408, "learn_throughput": 397.717, "synch_weights_time_ms": 7.763}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 18, "training_iteration": 153, "trial_id": "40f87_00000", "date": "2023-09-21_13-17-02", "timestamp": 1695273422, "time_this_iter_s": 21.667840003967285, "time_total_s": 3355.206092119217, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3355.206092119217, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 30.003333333333337, "ram_util_percent": 54.25666666666666}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5155064653485052, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.88e-05, "total_loss": -0.046259987812053656, "policy_loss": -0.057246838295067125, "vf_loss": 0.09026226301812718, "vf_explained_var": -0.054653200891710094, "kl": 0.007228197845937693, "entropy": 0.3906156506629721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 76136.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 21614.212, "sample_time_ms": 11532.565, "load_time_ms": 23.909, "load_throughput": 167303.209, "learn_time_ms": 10049.551, "learn_throughput": 398.028, "synch_weights_time_ms": 7.787}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "episodes_total": 18, "training_iteration": 154, "trial_id": "40f87_00000", "date": "2023-09-21_13-17-23", "timestamp": 1695273443, "time_this_iter_s": 21.62384271621704, "time_total_s": 3376.829934835434, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3376.829934835434, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 30.12666666666667, "ram_util_percent": 54.350000000000016}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5261626269127573, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.84e-05, "total_loss": -0.04834519779955548, "policy_loss": -0.057314951011757063, "vf_loss": 0.08939937829235269, "vf_explained_var": -0.11523762261194567, "kl": 0.005900123840957718, "entropy": 0.37627707734223337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 76632.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 21616.314, "sample_time_ms": 11532.906, "load_time_ms": 23.909, "load_throughput": 167301.207, "learn_time_ms": 10051.317, "learn_throughput": 397.958, "synch_weights_time_ms": 7.782}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "episodes_total": 18, "training_iteration": 155, "trial_id": "40f87_00000", "date": "2023-09-21_13-17-45", "timestamp": 1695273465, "time_this_iter_s": 21.63324213027954, "time_total_s": 3398.4631769657135, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3398.4631769657135, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 30.806451612903228, "ram_util_percent": 54.3032258064516}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5109512288604052, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.800000000000001e-05, "total_loss": -0.03930107521028408, "policy_loss": -0.04847736796270305, "vf_loss": 0.10984803229615453, "vf_explained_var": -0.020925336667606906, "kl": 0.006034769917306103, "entropy": 0.3879138093081213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 77128.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 21615.062, "sample_time_ms": 11528.144, "load_time_ms": 23.809, "load_throughput": 168000.977, "learn_time_ms": 10054.828, "learn_throughput": 397.819, "synch_weights_time_ms": 7.682}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 18, "training_iteration": 156, "trial_id": "40f87_00000", "date": "2023-09-21_13-18-07", "timestamp": 1695273487, "time_this_iter_s": 21.586355209350586, "time_total_s": 3420.049532175064, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3420.049532175064, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 30.07333333333333, "ram_util_percent": 54.37000000000001}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5340176318742095, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.7600000000000005e-05, "total_loss": -0.028761358426568368, "policy_loss": -0.03881506252125086, "vf_loss": 0.1510704604368056, "vf_explained_var": 0.10087717697024345, "kl": 0.0066097789256440494, "entropy": 0.3947930730158283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 77624.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 628000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 21617.063, "sample_time_ms": 11530.096, "load_time_ms": 23.906, "load_throughput": 167322.064, "learn_time_ms": 10054.775, "learn_throughput": 397.821, "synch_weights_time_ms": 7.686}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "done": false, "episodes_total": 18, "training_iteration": 157, "trial_id": "40f87_00000", "date": "2023-09-21_13-18-28", "timestamp": 1695273508, "time_this_iter_s": 21.564453601837158, "time_total_s": 3441.6139857769012, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3441.6139857769012, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 30.62333333333333, "ram_util_percent": 54.29999999999998}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5274032331822861, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.719999999999999e-05, "total_loss": -0.03383963751712731, "policy_loss": -0.04432937855979675, "vf_loss": 0.08112813664540168, "vf_explained_var": 0.031231614009987925, "kl": 0.0069014837966759135, "entropy": 0.413770972841209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 78120.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 21626.465, "sample_time_ms": 11536.335, "load_time_ms": 23.806, "load_throughput": 168023.86, "learn_time_ms": 10058.041, "learn_throughput": 397.692, "synch_weights_time_ms": 7.585}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "episodes_total": 18, "training_iteration": 158, "trial_id": "40f87_00000", "date": "2023-09-21_13-18-50", "timestamp": 1695273530, "time_this_iter_s": 21.674042224884033, "time_total_s": 3463.2880280017853, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3463.2880280017853, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 29.25333333333333, "ram_util_percent": 54.346666666666685}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5072154088486587, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.680000000000001e-05, "total_loss": -0.04628447416724803, "policy_loss": -0.055400815965831206, "vf_loss": 0.09266520045780306, "vf_explained_var": -0.054291102794870254, "kl": 0.005996429612986449, "entropy": 0.40498726790951145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 78616.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 21626.799, "sample_time_ms": 11537.002, "load_time_ms": 23.406, "load_throughput": 170896.141, "learn_time_ms": 10058.11, "learn_throughput": 397.689, "synch_weights_time_ms": 7.481}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 18, "training_iteration": 159, "trial_id": "40f87_00000", "date": "2023-09-21_13-19-12", "timestamp": 1695273552, "time_this_iter_s": 21.642552852630615, "time_total_s": 3484.930580854416, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3484.930580854416, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 28.9258064516129, "ram_util_percent": 54.28387096774192}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.526606205370157, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.640000000000001e-05, "total_loss": -0.06050071707596221, "policy_loss": -0.0699035135971386, "vf_loss": 0.07044135155006041, "vf_explained_var": 0.015463411327331297, "kl": 0.006186504376209945, "entropy": 0.42117397066566253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 79112.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 21627.462, "sample_time_ms": 11536.974, "load_time_ms": 23.503, "load_throughput": 170193.158, "learn_time_ms": 10058.902, "learn_throughput": 397.658, "synch_weights_time_ms": 7.284}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "episodes_total": 18, "training_iteration": 160, "trial_id": "40f87_00000", "date": "2023-09-21_13-19-33", "timestamp": 1695273573, "time_this_iter_s": 21.624032020568848, "time_total_s": 3506.5546128749847, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3506.5546128749847, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 30.783333333333324, "ram_util_percent": 54.37333333333335}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4694067524265378, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.600000000000001e-05, "total_loss": -0.03527950074508666, "policy_loss": -0.04601038419869222, "vf_loss": 0.09276055029007577, "vf_explained_var": -0.025297983038809993, "kl": 0.007059495392299133, "entropy": 0.4198487848644295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 79608.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 21622.222, "sample_time_ms": 11539.177, "load_time_ms": 23.603, "load_throughput": 169471.964, "learn_time_ms": 10051.359, "learn_throughput": 397.956, "synch_weights_time_ms": 7.284}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "done": false, "episodes_total": 18, "training_iteration": 161, "trial_id": "40f87_00000", "date": "2023-09-21_13-19-55", "timestamp": 1695273595, "time_this_iter_s": 21.65413737297058, "time_total_s": 3528.2087502479553, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3528.2087502479553, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 30.006666666666668, "ram_util_percent": 54.38666666666668}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49481654536700054, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.560000000000002e-05, "total_loss": -0.04161924471554812, "policy_loss": -0.05204031087980125, "vf_loss": 0.10374449954683622, "vf_explained_var": 0.0021697882442705094, "kl": 0.006854776749579103, "entropy": 0.4588160995514162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 80104.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 21618.647, "sample_time_ms": 11541.377, "load_time_ms": 23.6, "load_throughput": 169492.509, "learn_time_ms": 10045.586, "learn_throughput": 398.185, "synch_weights_time_ms": 7.285}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 18, "training_iteration": 162, "trial_id": "40f87_00000", "date": "2023-09-21_13-20-17", "timestamp": 1695273617, "time_this_iter_s": 21.6430926322937, "time_total_s": 3549.851842880249, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3549.851842880249, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 30.154838709677417, "ram_util_percent": 54.5}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5070628921591467, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.520000000000001e-05, "total_loss": -0.03875066081720081, "policy_loss": -0.047852112140668805, "vf_loss": 0.16511328117321095, "vf_explained_var": 0.05470164156248493, "kl": 0.0059818530014407855, "entropy": 0.41821689489147357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 80600.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 652000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 21618.747, "sample_time_ms": 11541.548, "load_time_ms": 23.7, "load_throughput": 168777.398, "learn_time_ms": 10045.609, "learn_throughput": 398.184, "synch_weights_time_ms": 7.19}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "done": false, "episodes_total": 18, "training_iteration": 163, "trial_id": "40f87_00000", "date": "2023-09-21_13-20-38", "timestamp": 1695273638, "time_this_iter_s": 21.66985774040222, "time_total_s": 3571.5217006206512, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3571.5217006206512, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 29.12333333333333, "ram_util_percent": 54.42666666666669}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5343736606620012, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.4800000000000005e-05, "total_loss": -0.032721699474120305, "policy_loss": -0.042188506121449115, "vf_loss": 0.09540926974507109, "vf_explained_var": -0.11854937732700378, "kl": 0.0062270064365618156, "entropy": 0.4615114569183319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 81096.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 21635.184, "sample_time_ms": 11542.299, "load_time_ms": 23.697, "load_throughput": 168800.662, "learn_time_ms": 10061.295, "learn_throughput": 397.563, "synch_weights_time_ms": 7.194}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "episodes_total": 18, "training_iteration": 164, "trial_id": "40f87_00000", "date": "2023-09-21_13-21-00", "timestamp": 1695273660, "time_this_iter_s": 21.788205862045288, "time_total_s": 3593.3099064826965, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3593.3099064826965, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 32.903225806451616, "ram_util_percent": 54.46451612903226}}
{"custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5022886305326416, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.44e-05, "total_loss": -0.042165069493480145, "policy_loss": -0.051358478891767936, "vf_loss": 0.13532107333171992, "vf_explained_var": -0.052032665980439034, "kl": 0.006044363717893328, "entropy": 0.45700163304084734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 81592.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -86.89500000000001, "portfolio_return_min": -100.0, "portfolio_return_max": -19.4, "position_changes_mean": 35.550555555555555, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -94.66722222222221, "max_drawdown_min": -100.0, "max_drawdown_max": -75.85}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -364.90416707219816, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47975065038777054, "mean_inference_ms": 3.0772070201649164, "mean_action_processing_ms": 0.14370403262040138, "mean_env_wait_ms": 2.034982795770108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005556477440728081, "MeanStdObservationFilterAgentConnector_ms": 0.05013677808973524, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.16136036978827584}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 21637.01, "sample_time_ms": 11541.373, "load_time_ms": 23.697, "load_throughput": 168798.794, "learn_time_ms": 10063.944, "learn_throughput": 397.458, "synch_weights_time_ms": 7.197}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 18, "training_iteration": 165, "trial_id": "40f87_00000", "date": "2023-09-21_13-21-22", "timestamp": 1695273682, "time_this_iter_s": 21.653472423553467, "time_total_s": 3614.96337890625, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3614.96337890625, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 30.79, "ram_util_percent": 54.45666666666668}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5113312035738942, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.399999999999999e-05, "total_loss": -0.04427240747252419, "policy_loss": -0.05483544037880136, "vf_loss": 0.09234991769546703, "vf_explained_var": 0.034073616347966657, "kl": 0.006949002626692332, "entropy": 0.40159387327730656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.41935483870968, "num_grad_updates_lifetime": 82088.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 21648.248, "sample_time_ms": 11548.979, "load_time_ms": 23.697, "load_throughput": 168800.832, "learn_time_ms": 10067.372, "learn_throughput": 397.323, "synch_weights_time_ms": 7.5}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "episodes_total": 20, "training_iteration": 166, "trial_id": "40f87_00000", "date": "2023-09-21_13-21-44", "timestamp": 1695273704, "time_this_iter_s": 21.699706315994263, "time_total_s": 3636.6630852222443, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3636.6630852222443, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 29.26774193548387, "ram_util_percent": 54.51290322580644}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5219791962675029, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.359999999999998e-05, "total_loss": -0.037633457722427745, "policy_loss": -0.04734991619836599, "vf_loss": 0.08147282285743483, "vf_explained_var": 0.09782209860221032, "kl": 0.006392302394101735, "entropy": 0.38920851358242575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 82584.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 21675.996, "sample_time_ms": 11569.84, "load_time_ms": 23.7, "load_throughput": 168778.077, "learn_time_ms": 10074.358, "learn_throughput": 397.048, "synch_weights_time_ms": 7.399}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "done": false, "episodes_total": 20, "training_iteration": 167, "trial_id": "40f87_00000", "date": "2023-09-21_13-22-05", "timestamp": 1695273725, "time_this_iter_s": 21.840951681137085, "time_total_s": 3658.5040369033813, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3658.5040369033813, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 34.42333333333333, "ram_util_percent": 54.70666666666668}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4801424764276993, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.32e-05, "total_loss": -0.03491877548156246, "policy_loss": -0.04286404203383192, "vf_loss": 0.13052340893961129, "vf_explained_var": 0.04445144546128089, "kl": 0.005222857763784709, "entropy": 0.37437180495790895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 83080.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 21678.928, "sample_time_ms": 11567.779, "load_time_ms": 23.799, "load_throughput": 168071.495, "learn_time_ms": 10079.247, "learn_throughput": 396.855, "synch_weights_time_ms": 7.502}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 20, "training_iteration": 168, "trial_id": "40f87_00000", "date": "2023-09-21_13-22-27", "timestamp": 1695273747, "time_this_iter_s": 21.704323768615723, "time_total_s": 3680.208360671997, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3680.208360671997, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 31.993548387096773, "ram_util_percent": 54.73225806451614}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5466258445634476, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.279999999999999e-05, "total_loss": -0.03679609879468297, "policy_loss": -0.04504562582963357, "vf_loss": 0.09089564940058475, "vf_explained_var": -0.10894772975194839, "kl": 0.005425802202984942, "entropy": 0.38393618713223165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 83576.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 676000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 21673.226, "sample_time_ms": 11564.803, "load_time_ms": 23.899, "load_throughput": 167371.139, "learn_time_ms": 10076.621, "learn_throughput": 396.958, "synch_weights_time_ms": 7.503}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "done": false, "episodes_total": 20, "training_iteration": 169, "trial_id": "40f87_00000", "date": "2023-09-21_13-22-49", "timestamp": 1695273769, "time_this_iter_s": 21.58650255203247, "time_total_s": 3701.7948632240295, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3701.7948632240295, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 31.26333333333333, "ram_util_percent": 54.659999999999975}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5182870442288057, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.239999999999999e-05, "total_loss": -0.04108674096501237, "policy_loss": -0.05015155950076728, "vf_loss": 0.08510600548658159, "vf_explained_var": -0.10175683902155969, "kl": 0.005963003262436364, "entropy": 0.3825948074339859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 84072.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 21670.439, "sample_time_ms": 11563.772, "load_time_ms": 23.799, "load_throughput": 168071.495, "learn_time_ms": 10074.968, "learn_throughput": 397.024, "synch_weights_time_ms": 7.503}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "episodes_total": 20, "training_iteration": 170, "trial_id": "40f87_00000", "date": "2023-09-21_13-23-10", "timestamp": 1695273790, "time_this_iter_s": 21.59715962409973, "time_total_s": 3723.3920228481293, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3723.3920228481293, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 31.14, "ram_util_percent": 54.67333333333334}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5183786546450949, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.2000000000000004e-05, "total_loss": -0.05502347057195185, "policy_loss": -0.06545650163189426, "vf_loss": 0.09559403688857152, "vf_explained_var": 0.042213399323724934, "kl": 0.006863193657164363, "entropy": 0.3827405601980225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 84568.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 21682.048, "sample_time_ms": 11567.358, "load_time_ms": 23.8, "load_throughput": 168070.653, "learn_time_ms": 10082.894, "learn_throughput": 396.711, "synch_weights_time_ms": 7.6}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 20, "training_iteration": 171, "trial_id": "40f87_00000", "date": "2023-09-21_13-23-32", "timestamp": 1695273812, "time_this_iter_s": 21.772253274917603, "time_total_s": 3745.164276123047, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3745.164276123047, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 32.274193548387096, "ram_util_percent": 54.661290322580626}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48576924778641234, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.16e-05, "total_loss": -0.033808014738643845, "policy_loss": -0.042258182375301274, "vf_loss": 0.10963542922399938, "vf_explained_var": -0.05508579049379595, "kl": 0.005556675271402042, "entropy": 0.36090681635804717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 85064.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 21688.877, "sample_time_ms": 11567.77, "load_time_ms": 23.799, "load_throughput": 168072.169, "learn_time_ms": 10089.316, "learn_throughput": 396.459, "synch_weights_time_ms": 7.594}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "episodes_total": 20, "training_iteration": 172, "trial_id": "40f87_00000", "date": "2023-09-21_13-23-54", "timestamp": 1695273834, "time_this_iter_s": 21.711411476135254, "time_total_s": 3766.875687599182, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3766.875687599182, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 30.416666666666668, "ram_util_percent": 54.69666666666669}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5320800013479686, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.120000000000001e-05, "total_loss": -0.05517112290404076, "policy_loss": -0.06410770703153121, "vf_loss": 0.08902753443427143, "vf_explained_var": 0.07237848038634946, "kl": 0.005878310025780214, "entropy": 0.3809980667767025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 85560.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 21683.2, "sample_time_ms": 11564.234, "load_time_ms": 23.799, "load_throughput": 168073.347, "learn_time_ms": 10087.082, "learn_throughput": 396.547, "synch_weights_time_ms": 7.688}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "done": false, "episodes_total": 20, "training_iteration": 173, "trial_id": "40f87_00000", "date": "2023-09-21_13-24-16", "timestamp": 1695273856, "time_this_iter_s": 21.61304807662964, "time_total_s": 3788.4887356758118, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3788.4887356758118, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 31.036666666666658, "ram_util_percent": 54.68333333333333}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4683700498313673, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.080000000000001e-05, "total_loss": -0.03761805335929121, "policy_loss": -0.04572362692617331, "vf_loss": 0.1874447104693841, "vf_explained_var": -0.01646620768212503, "kl": 0.005324662651783646, "entropy": 0.3811746855536776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 86056.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 21669.513, "sample_time_ms": 11560.721, "load_time_ms": 23.799, "load_throughput": 168073.347, "learn_time_ms": 10077.008, "learn_throughput": 396.943, "synch_weights_time_ms": 7.588}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 20, "training_iteration": 174, "trial_id": "40f87_00000", "date": "2023-09-21_13-24-37", "timestamp": 1695273877, "time_this_iter_s": 21.651336908340454, "time_total_s": 3810.140072584152, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3810.140072584152, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 30.79354838709677, "ram_util_percent": 54.72258064516129}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5270014855590078, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.039999999999999e-05, "total_loss": -0.03385937594312934, "policy_loss": -0.04257172249143907, "vf_loss": 0.09060877044835398, "vf_explained_var": -0.08715233567260927, "kl": 0.00573056149507087, "entropy": 0.3873419207070143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 86552.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 21670.316, "sample_time_ms": 11559.733, "load_time_ms": 23.799, "load_throughput": 168076.21, "learn_time_ms": 10078.902, "learn_throughput": 396.869, "synch_weights_time_ms": 7.585}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "episodes_total": 20, "training_iteration": 175, "trial_id": "40f87_00000", "date": "2023-09-21_13-24-59", "timestamp": 1695273899, "time_this_iter_s": 21.660528898239136, "time_total_s": 3831.8006014823914, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3831.8006014823914, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 31.286666666666672, "ram_util_percent": 54.75666666666666}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49240280549612736, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 4.000000000000001e-05, "total_loss": -0.03513248266667248, "policy_loss": -0.04372173117383594, "vf_loss": 0.05697799107668201, "vf_explained_var": -0.14581584786215135, "kl": 0.005651721810420447, "entropy": 0.3991246804474823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 87048.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 21664.635, "sample_time_ms": 11555.919, "load_time_ms": 23.896, "load_throughput": 167394.852, "learn_time_ms": 10077.137, "learn_throughput": 396.938, "synch_weights_time_ms": 7.487}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "episodes_total": 20, "training_iteration": 176, "trial_id": "40f87_00000", "date": "2023-09-21_13-25-21", "timestamp": 1695273921, "time_this_iter_s": 21.64388656616211, "time_total_s": 3853.4444880485535, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3853.4444880485535, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 30.383333333333333, "ram_util_percent": 54.68666666666668}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4846297984402026, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.9599999999999994e-05, "total_loss": -0.05359869490512797, "policy_loss": -0.06273044687493952, "vf_loss": 0.07901243069359372, "vf_explained_var": -0.18275100185025123, "kl": 0.006007473536629188, "entropy": 0.4004916463407778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 87544.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 21646.071, "sample_time_ms": 11538.899, "load_time_ms": 23.896, "load_throughput": 167395.353, "learn_time_ms": 10075.491, "learn_throughput": 397.003, "synch_weights_time_ms": 7.588}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 20, "training_iteration": 177, "trial_id": "40f87_00000", "date": "2023-09-21_13-25-42", "timestamp": 1695273942, "time_this_iter_s": 21.656296730041504, "time_total_s": 3875.100784778595, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3875.100784778595, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 29.59677419354839, "ram_util_percent": 54.66774193548386}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5357077946105311, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.919999999999999e-05, "total_loss": -0.048811196823202584, "policy_loss": -0.05877111847445532, "vf_loss": 0.09600867458333771, "vf_explained_var": -0.1492113468627776, "kl": 0.006551653054505907, "entropy": 0.4476531786663878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 88040.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 21681.367, "sample_time_ms": 11581.47, "load_time_ms": 24.196, "load_throughput": 165317.688, "learn_time_ms": 10067.892, "learn_throughput": 397.303, "synch_weights_time_ms": 7.513}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "episodes_total": 20, "training_iteration": 178, "trial_id": "40f87_00000", "date": "2023-09-21_13-26-04", "timestamp": 1695273964, "time_this_iter_s": 22.060291528701782, "time_total_s": 3897.1610763072968, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3897.1610763072968, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 30.238709677419354, "ram_util_percent": 54.68387096774194}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5284074966705614, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.879999999999999e-05, "total_loss": -0.054837801688981634, "policy_loss": -0.06475943591325514, "vf_loss": 0.06264833754093777, "vf_explained_var": 0.12199525414936004, "kl": 0.0065286408545965026, "entropy": 0.4241605725499891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 88536.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 21685.697, "sample_time_ms": 11585.078, "load_time_ms": 24.196, "load_throughput": 165316.711, "learn_time_ms": 10068.51, "learn_throughput": 397.278, "synch_weights_time_ms": 7.616}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "done": false, "episodes_total": 20, "training_iteration": 179, "trial_id": "40f87_00000", "date": "2023-09-21_13-26-26", "timestamp": 1695273986, "time_this_iter_s": 21.631799697875977, "time_total_s": 3918.7928760051727, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3918.7928760051727, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 30.726666666666667, "ram_util_percent": 54.730000000000004}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5252024179264423, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.84e-05, "total_loss": -0.04572201042995608, "policy_loss": -0.05529729060071986, "vf_loss": 0.10345195762197217, "vf_explained_var": -0.08780907827519602, "kl": 0.006297899933594061, "entropy": 0.4400107018769749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 89032.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 21685.04, "sample_time_ms": 11588.117, "load_time_ms": 24.295, "load_throughput": 164639.725, "learn_time_ms": 10064.815, "learn_throughput": 397.424, "synch_weights_time_ms": 7.613}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 20, "training_iteration": 180, "trial_id": "40f87_00000", "date": "2023-09-21_13-26-48", "timestamp": 1695274008, "time_this_iter_s": 21.58962392807007, "time_total_s": 3940.382499933243, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3940.382499933243, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 30.999999999999993, "ram_util_percent": 54.73666666666666}}
{"custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5625784051634611, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.8000000000000016e-05, "total_loss": -0.056387062660501065, "policy_loss": -0.06624197026253716, "vf_loss": 0.10230585496361938, "vf_explained_var": -0.05445632554831043, "kl": 0.006482090164165844, "entropy": 0.45365975256408414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 89528.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "sampler_results": {"episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -80.36850000000001, "portfolio_return_min": -100.0, "portfolio_return_max": 19.06, "position_changes_mean": 35.327, "position_changes_min": 32.79, "position_changes_max": 42.48, "max_drawdown_mean": -93.32699999999998, "max_drawdown_min": -100.0, "max_drawdown_max": -74.48}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}}, "episode_reward_max": -220.79148023077298, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -352.18498104261886, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4799447410830654, "mean_inference_ms": 3.0760655700506554, "mean_action_processing_ms": 0.1437972517310365, "mean_env_wait_ms": 2.0354131174404224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050008296966552734, "MeanStdObservationFilterAgentConnector_ms": 0.04512310028076172, "StateBufferConnector_ms": 0.004978179931640625, "ViewRequirementAgentConnector_ms": 0.18521785736083984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 724000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 21661.136, "sample_time_ms": 11577.99, "load_time_ms": 24.295, "load_throughput": 164640.856, "learn_time_ms": 10051.234, "learn_throughput": 397.961, "synch_weights_time_ms": 7.516}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "done": false, "episodes_total": 20, "training_iteration": 181, "trial_id": "40f87_00000", "date": "2023-09-21_13-27-09", "timestamp": 1695274029, "time_this_iter_s": 21.53215265274048, "time_total_s": 3961.9146525859833, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3961.9146525859833, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 31.43, "ram_util_percent": 54.763333333333335}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4954419927371125, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.7600000000000006e-05, "total_loss": -0.023655072245145996, "policy_loss": -0.031511613246684354, "vf_loss": 0.17389095247527886, "vf_explained_var": -0.07829394600083751, "kl": 0.005161582678311988, "entropy": 0.42973019398989215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38709677419355, "num_grad_updates_lifetime": 90024.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 21661.55, "sample_time_ms": 11585.524, "load_time_ms": 24.295, "load_throughput": 164640.371, "learn_time_ms": 10044.012, "learn_throughput": 398.247, "synch_weights_time_ms": 7.419}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "episodes_total": 22, "training_iteration": 182, "trial_id": "40f87_00000", "date": "2023-09-21_13-27-31", "timestamp": 1695274051, "time_this_iter_s": 21.715555429458618, "time_total_s": 3983.630208015442, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3983.630208015442, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 30.925806451612903, "ram_util_percent": 54.777419354838706}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5357322900165473, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.7199999999999996e-05, "total_loss": -0.017409312831718596, "policy_loss": -0.026916925212478213, "vf_loss": 0.08336712259634008, "vf_explained_var": 0.0810146085437267, "kl": 0.006254668486405818, "entropy": 0.35800344118427846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 90520.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 21676.83, "sample_time_ms": 11590.237, "load_time_ms": 24.199, "load_throughput": 165299.12, "learn_time_ms": 10054.773, "learn_throughput": 397.821, "synch_weights_time_ms": 7.322}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 22, "training_iteration": 183, "trial_id": "40f87_00000", "date": "2023-09-21_13-27-53", "timestamp": 1695274073, "time_this_iter_s": 21.76554250717163, "time_total_s": 4005.3957505226135, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4005.3957505226135, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 31.61333333333333, "ram_util_percent": 54.91666666666665}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4893063496678106, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.6800000000000014e-05, "total_loss": -0.04459296883038816, "policy_loss": -0.05230939843045968, "vf_loss": 0.1529324808751323, "vf_explained_var": -0.057504673037798174, "kl": 0.005070707580196479, "entropy": 0.36237944097768876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 91016.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 21697.548, "sample_time_ms": 11608.623, "load_time_ms": 24.196, "load_throughput": 165319.806, "learn_time_ms": 10057.008, "learn_throughput": 397.733, "synch_weights_time_ms": 7.422}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "episodes_total": 22, "training_iteration": 184, "trial_id": "40f87_00000", "date": "2023-09-21_13-28-15", "timestamp": 1695274095, "time_this_iter_s": 21.85951256752014, "time_total_s": 4027.2552630901337, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4027.2552630901337, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 32.08064516129032, "ram_util_percent": 55.29354838709677}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5508074062846361, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.640000000000001e-05, "total_loss": -0.04403268959985355, "policy_loss": -0.052364782170996244, "vf_loss": 0.06938247096108933, "vf_explained_var": -0.07745475105700954, "kl": 0.00548158236084399, "entropy": 0.35901959072197637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 91512.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 21696.755, "sample_time_ms": 11610.381, "load_time_ms": 24.196, "load_throughput": 165319.317, "learn_time_ms": 10054.455, "learn_throughput": 397.834, "synch_weights_time_ms": 7.424}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "done": false, "episodes_total": 22, "training_iteration": 185, "trial_id": "40f87_00000", "date": "2023-09-21_13-28-36", "timestamp": 1695274116, "time_this_iter_s": 21.65257954597473, "time_total_s": 4048.9078426361084, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4048.9078426361084, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 31.153333333333332, "ram_util_percent": 55.28666666666665}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5276654059548052, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 3.6e-05, "total_loss": -0.0285642612321798, "policy_loss": -0.035052591152223964, "vf_loss": 0.049819787188748556, "vf_explained_var": -0.03700234344409358, "kl": 0.004268871604367449, "entropy": 0.3611326739792862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 92008.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 21711.39, "sample_time_ms": 11624.921, "load_time_ms": 24.199, "load_throughput": 165298.631, "learn_time_ms": 10054.751, "learn_throughput": 397.822, "synch_weights_time_ms": 7.22}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 22, "training_iteration": 186, "trial_id": "40f87_00000", "date": "2023-09-21_13-28-58", "timestamp": 1695274138, "time_this_iter_s": 21.788246154785156, "time_total_s": 4070.6960887908936, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4070.6960887908936, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 30.593548387096774, "ram_util_percent": 55.17419354838711}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.528687052999533, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.5600000000000005e-05, "total_loss": -0.045267130151548755, "policy_loss": -0.05129077951570223, "vf_loss": 0.07008254169035823, "vf_explained_var": -0.016674564129883242, "kl": 0.007923154108299395, "entropy": 0.36889881051836476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 92504.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 748000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 748000, "timers": {"training_iteration_time_ms": 21712.147, "sample_time_ms": 11626.425, "load_time_ms": 24.198, "load_throughput": 165300.26, "learn_time_ms": 10054.105, "learn_throughput": 397.847, "synch_weights_time_ms": 7.119}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000}, "done": false, "episodes_total": 22, "training_iteration": 187, "trial_id": "40f87_00000", "date": "2023-09-21_13-29-20", "timestamp": 1695274160, "time_this_iter_s": 21.66287636756897, "time_total_s": 4092.3589651584625, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4092.3589651584625, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 31.856666666666666, "ram_util_percent": 55.21333333333333}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4863110096344063, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.5199999999999995e-05, "total_loss": -0.03967787063823292, "policy_loss": -0.04576309709309792, "vf_loss": 0.07745807361413515, "vf_explained_var": -0.035630378631814834, "kl": 0.008003266139156568, "entropy": 0.3482572941950733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 93000.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 21674.002, "sample_time_ms": 11581.905, "load_time_ms": 23.901, "load_throughput": 167353.609, "learn_time_ms": 10060.812, "learn_throughput": 397.582, "synch_weights_time_ms": 7.184}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "episodes_total": 22, "training_iteration": 188, "trial_id": "40f87_00000", "date": "2023-09-21_13-29-41", "timestamp": 1695274181, "time_this_iter_s": 21.674842834472656, "time_total_s": 4114.033807992935, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4114.033807992935, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 30.374193548387087, "ram_util_percent": 55.22903225806451}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4702525737304841, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.479999999999999e-05, "total_loss": -0.029017646662748208, "policy_loss": -0.034310738452580654, "vf_loss": 0.1000998958648603, "vf_explained_var": -0.004072397947311401, "kl": 0.006957142967265472, "entropy": 0.3681659717713633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 93496.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 21670.696, "sample_time_ms": 11577.639, "load_time_ms": 23.898, "load_throughput": 167374.812, "learn_time_ms": 10061.802, "learn_throughput": 397.543, "synch_weights_time_ms": 7.056}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 22, "training_iteration": 189, "trial_id": "40f87_00000", "date": "2023-09-21_13-30-03", "timestamp": 1695274203, "time_this_iter_s": 21.59576654434204, "time_total_s": 4135.629574537277, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4135.629574537277, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 31.666666666666668, "ram_util_percent": 55.22666666666666}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4878203299857916, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.439999999999998e-05, "total_loss": -0.027500000833007958, "policy_loss": -0.03240904392629501, "vf_loss": 0.22275859414930305, "vf_explained_var": 0.09709434379493037, "kl": 0.006435252308909712, "entropy": 0.37788701243698597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 93992.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 21686.258, "sample_time_ms": 11583.135, "load_time_ms": 23.902, "load_throughput": 167348.935, "learn_time_ms": 10071.862, "learn_throughput": 397.146, "synch_weights_time_ms": 7.059}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "episodes_total": 22, "training_iteration": 190, "trial_id": "40f87_00000", "date": "2023-09-21_13-30-25", "timestamp": 1695274225, "time_this_iter_s": 21.74521517753601, "time_total_s": 4157.374789714813, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4157.374789714813, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 32.20666666666667, "ram_util_percent": 55.20000000000002}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5341211913694297, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.4000000000000007e-05, "total_loss": -0.040573440727096184, "policy_loss": -0.04632951851477452, "vf_loss": 0.08611068847183619, "vf_explained_var": 0.06061533562118007, "kl": 0.007568676462226785, "entropy": 0.38905034166189933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 94488.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 764000, "timers": {"training_iteration_time_ms": 21703.659, "sample_time_ms": 11592.034, "load_time_ms": 23.902, "load_throughput": 167349.101, "learn_time_ms": 10080.263, "learn_throughput": 396.815, "synch_weights_time_ms": 7.059}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000}, "done": false, "episodes_total": 22, "training_iteration": 191, "trial_id": "40f87_00000", "date": "2023-09-21_13-30-47", "timestamp": 1695274247, "time_this_iter_s": 21.70618987083435, "time_total_s": 4179.080979585648, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4179.080979585648, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 29.687096774193545, "ram_util_percent": 55.26774193548388}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49753770289281685, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.3600000000000004e-05, "total_loss": -0.03857202162485449, "policy_loss": -0.04322956674431841, "vf_loss": 0.08210702783675984, "vf_explained_var": -0.11388009378025608, "kl": 0.00612258343713089, "entropy": 0.3763041065465058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 94984.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 21712.23, "sample_time_ms": 11596.169, "load_time_ms": 23.902, "load_throughput": 167348.601, "learn_time_ms": 10084.597, "learn_throughput": 396.645, "synch_weights_time_ms": 7.362}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 22, "training_iteration": 192, "trial_id": "40f87_00000", "date": "2023-09-21_13-31-08", "timestamp": 1695274268, "time_this_iter_s": 21.802242040634155, "time_total_s": 4200.883221626282, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4200.883221626282, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 30.81666666666667, "ram_util_percent": 55.22}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5615378063953211, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.3199999999999994e-05, "total_loss": -0.04569071432735889, "policy_loss": -0.05107289280344811, "vf_loss": 0.05977631605140144, "vf_explained_var": -0.019573865758795893, "kl": 0.007079769505511264, "entropy": 0.39573564752936363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 95480.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 772000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 772000, "timers": {"training_iteration_time_ms": 21701.963, "sample_time_ms": 11594.903, "load_time_ms": 23.999, "load_throughput": 166671.627, "learn_time_ms": 10075.498, "learn_throughput": 397.003, "synch_weights_time_ms": 7.262}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000}, "done": false, "episodes_total": 22, "training_iteration": 193, "trial_id": "40f87_00000", "date": "2023-09-21_13-31-30", "timestamp": 1695274290, "time_this_iter_s": 21.662174463272095, "time_total_s": 4222.545396089554, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4222.545396089554, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 31.299999999999997, "ram_util_percent": 55.30967741935484}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5189693571639157, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.2799999999999984e-05, "total_loss": -0.051867960110558345, "policy_loss": -0.05774294185527739, "vf_loss": 0.08304757897126218, "vf_explained_var": -0.07687161105775064, "kl": 0.0077256632517122645, "entropy": 0.4066999420643814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 95976.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 21680.46, "sample_time_ms": 11578.851, "load_time_ms": 24.002, "load_throughput": 166649.608, "learn_time_ms": 10070.144, "learn_throughput": 397.214, "synch_weights_time_ms": 7.062}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "episodes_total": 22, "training_iteration": 194, "trial_id": "40f87_00000", "date": "2023-09-21_13-31-52", "timestamp": 1695274312, "time_this_iter_s": 21.642483472824097, "time_total_s": 4244.187879562378, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4244.187879562378, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 30.026666666666664, "ram_util_percent": 55.32333333333333}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43065330443242866, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.240000000000001e-05, "total_loss": -0.03466537502977336, "policy_loss": -0.04003749519183804, "vf_loss": 0.2295126251861333, "vf_explained_var": -0.0019574754180446746, "kl": 0.007044173589196158, "entropy": 0.4474788348400785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 96472.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 21680.509, "sample_time_ms": 11577.035, "load_time_ms": 24.003, "load_throughput": 166648.118, "learn_time_ms": 10071.609, "learn_throughput": 397.156, "synch_weights_time_ms": 7.462}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 22, "training_iteration": 195, "trial_id": "40f87_00000", "date": "2023-09-21_13-32-13", "timestamp": 1695274333, "time_this_iter_s": 21.653067350387573, "time_total_s": 4265.8409469127655, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4265.8409469127655, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 30.49677419354839, "ram_util_percent": 55.3516129032258}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5741498729274157, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.200000000000001e-05, "total_loss": -0.03760503997393478, "policy_loss": -0.043006394698574195, "vf_loss": 0.08272451296779176, "vf_explained_var": 0.0751689727748594, "kl": 0.007102001452036549, "entropy": 0.401122153105755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 96968.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 21670.463, "sample_time_ms": 11573.149, "load_time_ms": 23.903, "load_throughput": 167344.928, "learn_time_ms": 10065.443, "learn_throughput": 397.399, "synch_weights_time_ms": 7.567}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "episodes_total": 22, "training_iteration": 196, "trial_id": "40f87_00000", "date": "2023-09-21_13-32-35", "timestamp": 1695274355, "time_this_iter_s": 21.687789916992188, "time_total_s": 4287.528736829758, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4287.528736829758, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 31.15666666666666, "ram_util_percent": 55.30333333333335}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5349154036131597, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.16e-05, "total_loss": -0.05357645755265689, "policy_loss": -0.05904902453743665, "vf_loss": 0.10303159055089758, "vf_explained_var": -0.11036904480668806, "kl": 0.007193105823260179, "entropy": 0.4468659912386248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 97464.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 788000, "timers": {"training_iteration_time_ms": 21659.236, "sample_time_ms": 11566.276, "load_time_ms": 23.892, "load_throughput": 167423.417, "learn_time_ms": 10061.105, "learn_throughput": 397.571, "synch_weights_time_ms": 7.563}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000}, "done": false, "episodes_total": 22, "training_iteration": 197, "trial_id": "40f87_00000", "date": "2023-09-21_13-32-57", "timestamp": 1695274377, "time_this_iter_s": 21.55063819885254, "time_total_s": 4309.07937502861, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4309.07937502861, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 31.39333333333333, "ram_util_percent": 55.38999999999999}}
{"custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5278243190879303, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.12e-05, "total_loss": -0.03914207035878433, "policy_loss": -0.044574009004845136, "vf_loss": 0.11355420055558844, "vf_explained_var": -0.013501037513056108, "kl": 0.007138220161929014, "entropy": 0.44396706310010725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 97960.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": -25.84727272727273, "portfolio_return_min": -100.0, "portfolio_return_max": 843.25, "position_changes_mean": 35.09227272727273, "position_changes_min": 32.65, "position_changes_max": 42.48, "max_drawdown_mean": -91.365, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}}, "episode_reward_max": -185.3377381591695, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -337.3803044491114, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4801127734597882, "mean_inference_ms": 3.0749429262686787, "mean_action_processing_ms": 0.14386924314226632, "mean_env_wait_ms": 2.0358230437747262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004546208815141158, "MeanStdObservationFilterAgentConnector_ms": 0.04102100025523792, "StateBufferConnector_ms": 0.004525618119673295, "ViewRequirementAgentConnector_ms": 0.19108165394176135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 21654.884, "sample_time_ms": 11568.068, "load_time_ms": 24.188, "load_throughput": 165368.528, "learn_time_ms": 10054.758, "learn_throughput": 397.822, "synch_weights_time_ms": 7.469}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 22, "training_iteration": 198, "trial_id": "40f87_00000", "date": "2023-09-21_13-33-18", "timestamp": 1695274398, "time_this_iter_s": 21.63134789466858, "time_total_s": 4330.710722923279, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4330.710722923279, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 30.70967741935484, "ram_util_percent": 55.325806451612905}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5358450499273115, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.0799999999999996e-05, "total_loss": -0.03268073084977767, "policy_loss": -0.03812293338330252, "vf_loss": 0.09709915845099115, "vf_explained_var": 0.1231302639409419, "kl": 0.007153898021728381, "entropy": 0.38277843840900927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98456.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 796000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 796000, "timers": {"training_iteration_time_ms": 21665.698, "sample_time_ms": 11575.712, "load_time_ms": 24.192, "load_throughput": 165346.201, "learn_time_ms": 10057.997, "learn_throughput": 397.693, "synch_weights_time_ms": 7.497}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000}, "done": false, "episodes_total": 24, "training_iteration": 199, "trial_id": "40f87_00000", "date": "2023-09-21_13-33-40", "timestamp": 1695274420, "time_this_iter_s": 21.705913305282593, "time_total_s": 4352.416636228561, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4352.416636228561, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 31.15666666666667, "ram_util_percent": 55.39999999999999}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4872218267992139, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 3.0399999999999994e-05, "total_loss": -0.04231054338836862, "policy_loss": -0.0472132382058208, "vf_loss": 0.12653119732520632, "vf_explained_var": 0.05729245562707224, "kl": 0.006439560945020763, "entropy": 0.3573983306846311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 98952.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 21654.705, "sample_time_ms": 11571.897, "load_time_ms": 24.088, "load_throughput": 166057.451, "learn_time_ms": 10050.926, "learn_throughput": 397.973, "synch_weights_time_ms": 7.493}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "episodes_total": 24, "training_iteration": 200, "trial_id": "40f87_00000", "date": "2023-09-21_13-34-02", "timestamp": 1695274442, "time_this_iter_s": 21.63528347015381, "time_total_s": 4374.051919698715, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4374.051919698715, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 30.17, "ram_util_percent": 55.37000000000002}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5202993651130988, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.9999999999999984e-05, "total_loss": -0.021385898612929704, "policy_loss": -0.026004821308766447, "vf_loss": 0.11149502376229653, "vf_explained_var": -0.0029127750425569474, "kl": 0.006067855371541928, "entropy": 0.34273662934860877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 99448.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 21652.812, "sample_time_ms": 11570.566, "load_time_ms": 24.085, "load_throughput": 166078.492, "learn_time_ms": 10050.468, "learn_throughput": 397.991, "synch_weights_time_ms": 7.493}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 24, "training_iteration": 201, "trial_id": "40f87_00000", "date": "2023-09-21_13-34-24", "timestamp": 1695274464, "time_this_iter_s": 21.687283992767334, "time_total_s": 4395.7392036914825, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4395.7392036914825, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 29.90322580645161, "ram_util_percent": 55.43225806451615}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5056194744463409, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.960000000000001e-05, "total_loss": -0.02299995068179053, "policy_loss": -0.027760189355420503, "vf_loss": 0.09693746335218631, "vf_explained_var": -0.08660025546146978, "kl": 0.006255862188809294, "entropy": 0.3690904032198652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 99944.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 21633.136, "sample_time_ms": 11557.99, "load_time_ms": 24.083, "load_throughput": 166092.467, "learn_time_ms": 10043.473, "learn_throughput": 398.269, "synch_weights_time_ms": 7.39}, "counters": {"num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "episodes_total": 24, "training_iteration": 202, "trial_id": "40f87_00000", "date": "2023-09-21_13-34-45", "timestamp": 1695274485, "time_this_iter_s": 21.605515003204346, "time_total_s": 4417.344718694687, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4417.344718694687, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 29.810000000000002, "ram_util_percent": 55.456666666666656}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5811182827718796, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.92e-05, "total_loss": -0.036747521756971706, "policy_loss": -0.041793983348197214, "vf_loss": 0.06026879457321258, "vf_explained_var": -0.060500099654159235, "kl": 0.006637609527672621, "entropy": 0.3663805368686876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 100440.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 812000, "timers": {"training_iteration_time_ms": 21627.765, "sample_time_ms": 11555.145, "load_time_ms": 24.049, "load_throughput": 166327.11, "learn_time_ms": 10040.883, "learn_throughput": 398.371, "synch_weights_time_ms": 7.587}, "counters": {"num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "done": false, "episodes_total": 24, "training_iteration": 203, "trial_id": "40f87_00000", "date": "2023-09-21_13-35-07", "timestamp": 1695274507, "time_this_iter_s": 21.60945963859558, "time_total_s": 4438.9541783332825, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4438.9541783332825, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 30.41666666666667, "ram_util_percent": 55.536666666666676}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5335016155675534, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.8799999999999992e-05, "total_loss": -0.031576495309925505, "policy_loss": -0.036325103058310736, "vf_loss": 0.11383066430778033, "vf_explained_var": -0.02877930744040397, "kl": 0.006238322525128042, "entropy": 0.3551108055417576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 100936.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 21627.924, "sample_time_ms": 11555.441, "load_time_ms": 24.049, "load_throughput": 166326.945, "learn_time_ms": 10040.647, "learn_throughput": 398.381, "synch_weights_time_ms": 7.786}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 24, "training_iteration": 204, "trial_id": "40f87_00000", "date": "2023-09-21_13-35-28", "timestamp": 1695274528, "time_this_iter_s": 21.647072553634644, "time_total_s": 4460.601250886917, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4460.601250886917, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 29.29677419354838, "ram_util_percent": 55.493548387096766}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5065299791974887, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.8399999999999992e-05, "total_loss": -0.028907968025680842, "policy_loss": -0.03377892868182596, "vf_loss": 0.05963065522167111, "vf_explained_var": -0.024516096038203084, "kl": 0.006406581843676027, "entropy": 0.34604114564436095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 101432.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000, "num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 820000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 21630.461, "sample_time_ms": 11558.089, "load_time_ms": 24.049, "load_throughput": 166328.594, "learn_time_ms": 10040.74, "learn_throughput": 398.377, "synch_weights_time_ms": 7.489}, "counters": {"num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "done": false, "episodes_total": 24, "training_iteration": 205, "trial_id": "40f87_00000", "date": "2023-09-21_13-35-50", "timestamp": 1695274550, "time_this_iter_s": 21.678460836410522, "time_total_s": 4482.279711723328, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4482.279711723328, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 31.016666666666666, "ram_util_percent": 55.58333333333334}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5615818435025792, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.8000000000000017e-05, "total_loss": -0.03075274818477356, "policy_loss": -0.03520736308981272, "vf_loss": 0.06139015679758403, "vf_explained_var": 0.03666587270075275, "kl": 0.005858074016249912, "entropy": 0.36341074637828336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 101928.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 21639.468, "sample_time_ms": 11557.27, "load_time_ms": 24.049, "load_throughput": 166327.275, "learn_time_ms": 10050.572, "learn_throughput": 397.987, "synch_weights_time_ms": 7.385}, "counters": {"num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "episodes_total": 24, "training_iteration": 206, "trial_id": "40f87_00000", "date": "2023-09-21_13-36-12", "timestamp": 1695274572, "time_this_iter_s": 21.779879570007324, "time_total_s": 4504.059591293335, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4504.059591293335, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 29.806451612903224, "ram_util_percent": 55.52903225806449}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5472877643882267, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.7600000000000017e-05, "total_loss": -0.03895262301704215, "policy_loss": -0.044100355508553256, "vf_loss": 0.1251766750093309, "vf_explained_var": 0.10188127273032742, "kl": 0.0067624235951504715, "entropy": 0.370095559365807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 102424.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 21643.204, "sample_time_ms": 11560.071, "load_time_ms": 24.061, "load_throughput": 166246.516, "learn_time_ms": 10051.392, "learn_throughput": 397.955, "synch_weights_time_ms": 7.488}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 24, "training_iteration": 207, "trial_id": "40f87_00000", "date": "2023-09-21_13-36-34", "timestamp": 1695274594, "time_this_iter_s": 21.588968753814697, "time_total_s": 4525.64856004715, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4525.64856004715, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 31.173333333333336, "ram_util_percent": 55.606666666666676}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5757601007578834, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.7200000000000007e-05, "total_loss": -0.04105600746744688, "policy_loss": -0.0459140447785631, "vf_loss": 0.06765448467265214, "vf_explained_var": -0.11193198338150978, "kl": 0.006388504598720294, "entropy": 0.38820302372257554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 102920.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 21642.291, "sample_time_ms": 11557.518, "load_time_ms": 23.763, "load_throughput": 168325.615, "learn_time_ms": 10053.328, "learn_throughput": 397.878, "synch_weights_time_ms": 7.491}, "counters": {"num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "episodes_total": 24, "training_iteration": 208, "trial_id": "40f87_00000", "date": "2023-09-21_13-36-55", "timestamp": 1695274615, "time_this_iter_s": 21.62301754951477, "time_total_s": 4547.271577596664, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4547.271577596664, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 29.82, "ram_util_percent": 55.616666666666674}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5644010134461906, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.68e-05, "total_loss": -0.02814171860048983, "policy_loss": -0.03232271941470249, "vf_loss": 0.05008562918256728, "vf_explained_var": -0.24709854299022305, "kl": 0.005499246618576286, "entropy": 0.3898280926289097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 103416.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000, "num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 836000, "timers": {"training_iteration_time_ms": 21659.335, "sample_time_ms": 11572.085, "load_time_ms": 23.763, "load_throughput": 168325.952, "learn_time_ms": 10055.805, "learn_throughput": 397.78, "synch_weights_time_ms": 7.49}, "counters": {"num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000}, "done": false, "episodes_total": 24, "training_iteration": 209, "trial_id": "40f87_00000", "date": "2023-09-21_13-37-17", "timestamp": 1695274637, "time_this_iter_s": 21.876317739486694, "time_total_s": 4569.147895336151, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4569.147895336151, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 34.045161290322575, "ram_util_percent": 55.680645161290315}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5559706584580483, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.639999999999999e-05, "total_loss": -0.03113248800077746, "policy_loss": -0.03623139687002667, "vf_loss": 0.08409516784482665, "vf_explained_var": -0.008169966599633616, "kl": 0.006703537172168272, "entropy": 0.3840385012088283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 103912.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 21674.999, "sample_time_ms": 11584.093, "load_time_ms": 23.864, "load_throughput": 167618.956, "learn_time_ms": 10059.256, "learn_throughput": 397.644, "synch_weights_time_ms": 7.394}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 24, "training_iteration": 210, "trial_id": "40f87_00000", "date": "2023-09-21_13-37-39", "timestamp": 1695274659, "time_this_iter_s": 21.791919469833374, "time_total_s": 4590.9398148059845, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4590.9398148059845, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 31.203225806451616, "ram_util_percent": 55.66774193548388}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5320057663165273, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.6000000000000002e-05, "total_loss": -0.03534570802449091, "policy_loss": -0.040715510956532294, "vf_loss": 0.09372244083562926, "vf_explained_var": -0.09619320688709136, "kl": 0.007059005386275063, "entropy": 0.422366633710842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 104408.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000, "num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 844000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 844000, "timers": {"training_iteration_time_ms": 21672.005, "sample_time_ms": 11581.529, "load_time_ms": 23.867, "load_throughput": 167597.021, "learn_time_ms": 10058.824, "learn_throughput": 397.661, "synch_weights_time_ms": 7.394}, "counters": {"num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000}, "done": false, "episodes_total": 24, "training_iteration": 211, "trial_id": "40f87_00000", "date": "2023-09-21_13-38-01", "timestamp": 1695274681, "time_this_iter_s": 21.658325672149658, "time_total_s": 4612.598140478134, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4612.598140478134, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 31.09333333333333, "ram_util_percent": 55.73333333333332}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5198683283862567, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.5599999999999992e-05, "total_loss": -0.05140910665091548, "policy_loss": -0.05628656745571906, "vf_loss": 0.09907914835944652, "vf_explained_var": 0.017662502825260162, "kl": 0.006409944284084128, "entropy": 0.4087299260521127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 104904.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 21685.152, "sample_time_ms": 11588.907, "load_time_ms": 23.869, "load_throughput": 167579.611, "learn_time_ms": 10064.19, "learn_throughput": 397.449, "synch_weights_time_ms": 7.594}, "counters": {"num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "episodes_total": 24, "training_iteration": 212, "trial_id": "40f87_00000", "date": "2023-09-21_13-38-22", "timestamp": 1695274702, "time_this_iter_s": 21.735950231552124, "time_total_s": 4634.334090709686, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4634.334090709686, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 32.16774193548387, "ram_util_percent": 55.593548387096774}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5358073558778532, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.520000000000001e-05, "total_loss": -0.03672762403702138, "policy_loss": -0.041168982455518185, "vf_loss": 0.10617780887461718, "vf_explained_var": -0.02168820113424332, "kl": 0.0058347217892287025, "entropy": 0.41643078985714144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 105400.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 21692.229, "sample_time_ms": 11595.88, "load_time_ms": 23.803, "load_throughput": 168044.897, "learn_time_ms": 10064.26, "learn_throughput": 397.446, "synch_weights_time_ms": 7.594}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 24, "training_iteration": 213, "trial_id": "40f87_00000", "date": "2023-09-21_13-38-44", "timestamp": 1695274724, "time_this_iter_s": 21.680233001708984, "time_total_s": 4656.014323711395, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4656.014323711395, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 29.566666666666666, "ram_util_percent": 55.55}}
{"custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5119336129977338, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.48e-05, "total_loss": -0.041978129285252505, "policy_loss": -0.04619324248614571, "vf_loss": 0.16413538707720657, "vf_explained_var": -0.09187732540792035, "kl": 0.005529154174305039, "entropy": 0.43879764749398154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 105896.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "sampler_results": {"episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 41.862500000000004, "portfolio_return_min": -100.0, "portfolio_return_max": 1076.91, "position_changes_mean": 34.846250000000005, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -89.8925, "max_drawdown_min": -100.0, "max_drawdown_max": -70.79}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}}, "episode_reward_max": -180.57731936483773, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -324.47329603069556, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4802459575645292, "mean_inference_ms": 3.0738773018021806, "mean_action_processing_ms": 0.14397294320529364, "mean_env_wait_ms": 2.0362089126820417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041673580805460615, "MeanStdObservationFilterAgentConnector_ms": 0.03760258356730143, "StateBufferConnector_ms": 0.0041484832763671875, "ViewRequirementAgentConnector_ms": 0.19810895125071207}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 21699.637, "sample_time_ms": 11603.595, "load_time_ms": 23.803, "load_throughput": 168046.075, "learn_time_ms": 10064.053, "learn_throughput": 397.454, "synch_weights_time_ms": 7.495}, "counters": {"num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "episodes_total": 24, "training_iteration": 214, "trial_id": "40f87_00000", "date": "2023-09-21_13-39-06", "timestamp": 1695274746, "time_this_iter_s": 21.719153881072998, "time_total_s": 4677.733477592468, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4677.733477592468, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 32.89666666666667, "ram_util_percent": 55.483333333333334}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5254753008184414, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.44e-05, "total_loss": -0.03572376407006936, "policy_loss": -0.04011383153603322, "vf_loss": 0.08421534995150362, "vf_explained_var": -0.22043471771382517, "kl": 0.005770065636196808, "entropy": 0.4137081078463985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.96774193548387, "num_grad_updates_lifetime": 106392.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000, "num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 21702.1, "sample_time_ms": 11603.803, "load_time_ms": 23.803, "load_throughput": 168045.234, "learn_time_ms": 10066.304, "learn_throughput": 397.365, "synch_weights_time_ms": 7.493}, "counters": {"num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "done": false, "episodes_total": 26, "training_iteration": 215, "trial_id": "40f87_00000", "date": "2023-09-21_13-39-28", "timestamp": 1695274768, "time_this_iter_s": 21.70306396484375, "time_total_s": 4699.436541557312, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4699.436541557312, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 30.461290322580645, "ram_util_percent": 55.58709677419354}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5949111204714544, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.3999999999999997e-05, "total_loss": -0.039024379783856394, "policy_loss": -0.04369456343016692, "vf_loss": 0.06313199484570613, "vf_explained_var": 0.1923484557097958, "kl": 0.006141720774865974, "entropy": 0.3604187256386203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 106888.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 21686.525, "sample_time_ms": 11595.971, "load_time_ms": 23.903, "load_throughput": 167344.094, "learn_time_ms": 10058.555, "learn_throughput": 397.671, "synch_weights_time_ms": 7.495}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 26, "training_iteration": 216, "trial_id": "40f87_00000", "date": "2023-09-21_13-39-49", "timestamp": 1695274789, "time_this_iter_s": 21.622129201889038, "time_total_s": 4721.058670759201, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4721.058670759201, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 29.956666666666656, "ram_util_percent": 55.47}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5674837246957806, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.3599999999999987e-05, "total_loss": -0.04782240379520977, "policy_loss": -0.051965027638230354, "vf_loss": 0.0638829028372833, "vf_explained_var": -0.005370659333082938, "kl": 0.0054468954351625225, "entropy": 0.36075265387133243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 107384.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 868000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 868000, "timers": {"training_iteration_time_ms": 21688.99, "sample_time_ms": 11595.829, "load_time_ms": 23.899, "load_throughput": 167368.3, "learn_time_ms": 10061.166, "learn_throughput": 397.568, "synch_weights_time_ms": 7.496}, "counters": {"num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "done": false, "episodes_total": 26, "training_iteration": 217, "trial_id": "40f87_00000", "date": "2023-09-21_13-40-11", "timestamp": 1695274811, "time_this_iter_s": 21.612464427947998, "time_total_s": 4742.671135187149, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4742.671135187149, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 31.79333333333333, "ram_util_percent": 55.56999999999998}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5580806264113034, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.32e-05, "total_loss": -0.03651972766261503, "policy_loss": -0.041096707383516215, "vf_loss": 0.06857732273337822, "vf_explained_var": -0.13035193650472549, "kl": 0.0060182718965985675, "entropy": 0.3511528945978611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 107880.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 21692.463, "sample_time_ms": 11600.276, "load_time_ms": 23.893, "load_throughput": 167410.052, "learn_time_ms": 10060.096, "learn_throughput": 397.611, "synch_weights_time_ms": 7.496}, "counters": {"num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "episodes_total": 26, "training_iteration": 218, "trial_id": "40f87_00000", "date": "2023-09-21_13-40-33", "timestamp": 1695274833, "time_this_iter_s": 21.658915519714355, "time_total_s": 4764.330050706863, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4764.330050706863, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 30.567741935483873, "ram_util_percent": 55.54838709677417}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.529379345596798, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.2800000000000005e-05, "total_loss": -0.03276173202527476, "policy_loss": -0.03679320543837563, "vf_loss": 0.0791637925337249, "vf_explained_var": -0.07600875535318928, "kl": 0.0052985099960210676, "entropy": 0.35142598775846345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 108376.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 21682.843, "sample_time_ms": 11582.573, "load_time_ms": 23.893, "load_throughput": 167410.219, "learn_time_ms": 10068.09, "learn_throughput": 397.295, "synch_weights_time_ms": 7.586}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 26, "training_iteration": 219, "trial_id": "40f87_00000", "date": "2023-09-21_13-40-54", "timestamp": 1695274854, "time_this_iter_s": 21.78412127494812, "time_total_s": 4786.1141719818115, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4786.1141719818115, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 29.876666666666665, "ram_util_percent": 55.646666666666675}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5671097925233264, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.2400000000000002e-05, "total_loss": -0.039112921490149964, "policy_loss": -0.04362438102755057, "vf_loss": 0.08967560005464381, "vf_explained_var": -0.05998937064601529, "kl": 0.005929205367647298, "entropy": 0.3522605275915515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 108872.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 21665.333, "sample_time_ms": 11566.271, "load_time_ms": 24.193, "load_throughput": 165334.794, "learn_time_ms": 10066.596, "learn_throughput": 397.354, "synch_weights_time_ms": 7.773}, "counters": {"num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "episodes_total": 26, "training_iteration": 220, "trial_id": "40f87_00000", "date": "2023-09-21_13-41-16", "timestamp": 1695274876, "time_this_iter_s": 21.61885094642639, "time_total_s": 4807.733022928238, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4807.733022928238, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 30.790322580645153, "ram_util_percent": 55.570967741935476}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5704192179104974, "cur_kl_coeff": 0.7593750000000001, "cur_lr": 2.1999999999999993e-05, "total_loss": -0.031593027496954515, "policy_loss": -0.035394989082687386, "vf_loss": 0.09416244097895199, "vf_explained_var": -0.1086331033898938, "kl": 0.0049942987336808915, "entropy": 0.3441158875282253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 109368.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000, "num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 884000, "timers": {"training_iteration_time_ms": 21663.591, "sample_time_ms": 11566.293, "load_time_ms": 24.193, "load_throughput": 165334.794, "learn_time_ms": 10064.835, "learn_throughput": 397.423, "synch_weights_time_ms": 7.77}, "counters": {"num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000}, "done": false, "episodes_total": 26, "training_iteration": 221, "trial_id": "40f87_00000", "date": "2023-09-21_13-41-38", "timestamp": 1695274898, "time_this_iter_s": 21.639925956726074, "time_total_s": 4829.372948884964, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4829.372948884964, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 30.720000000000002, "ram_util_percent": 55.663333333333334}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5313462687716368, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 2.1600000000000003e-05, "total_loss": -0.03216281172541541, "policy_loss": -0.03444151594791742, "vf_loss": 0.06849163514561951, "vf_explained_var": 0.04882155082398845, "kl": 0.005983494300599862, "entropy": 0.35128517989670077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 109864.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 21654.495, "sample_time_ms": 11559.597, "load_time_ms": 24.093, "load_throughput": 166023.271, "learn_time_ms": 10062.928, "learn_throughput": 397.499, "synch_weights_time_ms": 7.476}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 26, "training_iteration": 222, "trial_id": "40f87_00000", "date": "2023-09-21_13-41-59", "timestamp": 1695274919, "time_this_iter_s": 21.64539408683777, "time_total_s": 4851.018342971802, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4851.018342971802, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 30.376666666666665, "ram_util_percent": 55.52999999999999}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5371407022279117, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 2.1199999999999994e-05, "total_loss": -0.049539679347940214, "policy_loss": -0.051796981351681974, "vf_loss": 0.12444018427988575, "vf_explained_var": 0.04488825870137061, "kl": 0.005912378155018856, "entropy": 0.36205560269375003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 110360.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000, "num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 892000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 892000, "timers": {"training_iteration_time_ms": 21649.806, "sample_time_ms": 11555.548, "load_time_ms": 24.193, "load_throughput": 165338.379, "learn_time_ms": 10062.389, "learn_throughput": 397.52, "synch_weights_time_ms": 7.376}, "counters": {"num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000}, "done": false, "episodes_total": 26, "training_iteration": 223, "trial_id": "40f87_00000", "date": "2023-09-21_13-42-21", "timestamp": 1695274941, "time_this_iter_s": 21.633365154266357, "time_total_s": 4872.651708126068, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4872.651708126068, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 31.738709677419354, "ram_util_percent": 55.60322580645159}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6013266736220929, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 2.0800000000000008e-05, "total_loss": -0.04898513337379442, "policy_loss": -0.05121620226559424, "vf_loss": 0.07525171639938508, "vf_explained_var": 0.1150282132289102, "kl": 0.00585624506349955, "entropy": 0.3699226687031408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 110856.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 21636.176, "sample_time_ms": 11542.088, "load_time_ms": 24.093, "load_throughput": 166024.585, "learn_time_ms": 10062.31, "learn_throughput": 397.523, "synch_weights_time_ms": 7.384}, "counters": {"num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "episodes_total": 26, "training_iteration": 224, "trial_id": "40f87_00000", "date": "2023-09-21_13-42-43", "timestamp": 1695274963, "time_this_iter_s": 21.582844018936157, "time_total_s": 4894.234552145004, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4894.234552145004, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 30.376666666666665, "ram_util_percent": 55.51999999999999}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5749099822414498, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 2.0399999999999998e-05, "total_loss": -0.04263664259891694, "policy_loss": -0.04477578757219054, "vf_loss": 0.07617704978122586, "vf_explained_var": -0.18676801206123445, "kl": 0.005613896244974967, "entropy": 0.3734200738009907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 111352.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 21629.385, "sample_time_ms": 11536.482, "load_time_ms": 24.093, "load_throughput": 166024.092, "learn_time_ms": 10061.228, "learn_throughput": 397.566, "synch_weights_time_ms": 7.281}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 26, "training_iteration": 225, "trial_id": "40f87_00000", "date": "2023-09-21_13-43-04", "timestamp": 1695274984, "time_this_iter_s": 21.637181758880615, "time_total_s": 4915.871733903885, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4915.871733903885, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 31.435483870967737, "ram_util_percent": 55.63548387096772}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5999895286475939, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.9999999999999995e-05, "total_loss": -0.037211908243461364, "policy_loss": -0.039127350536986225, "vf_loss": 0.06017944880295545, "vf_explained_var": -0.12688796005902753, "kl": 0.005028939208817232, "entropy": 0.38063364133479133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 111848.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 21637.325, "sample_time_ms": 11536.272, "load_time_ms": 23.993, "load_throughput": 166714.026, "learn_time_ms": 10069.38, "learn_throughput": 397.244, "synch_weights_time_ms": 7.278}, "counters": {"num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "episodes_total": 26, "training_iteration": 226, "trial_id": "40f87_00000", "date": "2023-09-21_13-43-26", "timestamp": 1695275006, "time_this_iter_s": 21.70250415802002, "time_total_s": 4937.574238061905, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4937.574238061905, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 30.799999999999997, "ram_util_percent": 55.50666666666667}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5693226167631726, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.9599999999999995e-05, "total_loss": -0.04118031126563437, "policy_loss": -0.0432441688235192, "vf_loss": 0.08755039383146551, "vf_explained_var": -0.12644791482917725, "kl": 0.005412611573612721, "entropy": 0.38336728014532595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 112344.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000, "num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 908000, "timers": {"training_iteration_time_ms": 21629.698, "sample_time_ms": 11530.734, "load_time_ms": 24.096, "load_throughput": 166001.259, "learn_time_ms": 10067.209, "learn_throughput": 397.33, "synch_weights_time_ms": 7.258}, "counters": {"num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000}, "done": false, "episodes_total": 26, "training_iteration": 227, "trial_id": "40f87_00000", "date": "2023-09-21_13-43-48", "timestamp": 1695275028, "time_this_iter_s": 21.537378072738647, "time_total_s": 4959.111616134644, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4959.111616134644, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 30.47666666666667, "ram_util_percent": 55.58666666666665}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6003490394401935, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.9199999999999986e-05, "total_loss": -0.03867316019210604, "policy_loss": -0.04092855057528903, "vf_loss": 0.09508294481108145, "vf_explained_var": 0.032170065107845494, "kl": 0.005915085522032153, "entropy": 0.4314770148165764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 112840.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 21630.124, "sample_time_ms": 11532.413, "load_time_ms": 23.999, "load_throughput": 166671.793, "learn_time_ms": 10066.057, "learn_throughput": 397.375, "synch_weights_time_ms": 7.255}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 26, "training_iteration": 228, "trial_id": "40f87_00000", "date": "2023-09-21_13-44-09", "timestamp": 1695275049, "time_this_iter_s": 21.660879850387573, "time_total_s": 4980.772495985031, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4980.772495985031, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 30.16, "ram_util_percent": 55.513333333333335}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5563069191731272, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.8800000000000003e-05, "total_loss": -0.031338842005249216, "policy_loss": -0.03327755601428855, "vf_loss": 0.11120600727266602, "vf_explained_var": -0.06143351476038656, "kl": 0.00507677843092129, "entropy": 0.3747893020871185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 113336.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000, "num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 916000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 916000, "timers": {"training_iteration_time_ms": 21611.389, "sample_time_ms": 11531.069, "load_time_ms": 23.896, "load_throughput": 167389.842, "learn_time_ms": 10048.754, "learn_throughput": 398.059, "synch_weights_time_ms": 7.171}, "counters": {"num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000}, "done": false, "episodes_total": 26, "training_iteration": 229, "trial_id": "40f87_00000", "date": "2023-09-21_13-44-31", "timestamp": 1695275071, "time_this_iter_s": 21.591720819473267, "time_total_s": 5002.364216804504, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5002.364216804504, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 31.006451612903223, "ram_util_percent": 55.603225806451604}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6396707995764671, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.8400000000000007e-05, "total_loss": -0.04055320934675101, "policy_loss": -0.04266791252901443, "vf_loss": 0.0554918946732106, "vf_explained_var": -0.10785913383287768, "kl": 0.005554977322783593, "entropy": 0.42641618649565405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 113832.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 21611.3, "sample_time_ms": 11532.713, "load_time_ms": 23.596, "load_throughput": 169518.711, "learn_time_ms": 10047.308, "learn_throughput": 398.117, "synch_weights_time_ms": 7.183}, "counters": {"num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "episodes_total": 26, "training_iteration": 230, "trial_id": "40f87_00000", "date": "2023-09-21_13-44-52", "timestamp": 1695275092, "time_this_iter_s": 21.61693572998047, "time_total_s": 5023.981152534485, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5023.981152534485, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 31.07333333333333, "ram_util_percent": 55.529999999999994}}
{"custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5507957739154657, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.8000000000000004e-05, "total_loss": -0.04057923114962778, "policy_loss": -0.04270922169720389, "vf_loss": 0.10074037924078444, "vf_explained_var": -0.04996269328459617, "kl": 0.0055833239390967355, "entropy": 0.4259075096417819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 114328.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 249.60461538461536, "portfolio_return_min": -100.0, "portfolio_return_max": 2754.58, "position_changes_mean": 34.6523076923077, "position_changes_min": 32.03, "position_changes_max": 42.48, "max_drawdown_mean": -88.08500000000001, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}}, "episode_reward_max": -134.18816005950276, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -310.2513402080412, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4803896768309427, "mean_inference_ms": 3.0728887738144386, "mean_action_processing_ms": 0.14406803148974445, "mean_env_wait_ms": 2.0365767405336794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007693584148700421, "MeanStdObservationFilterAgentConnector_ms": 0.03855686921339769, "StateBufferConnector_ms": 0.003829369178185096, "ViewRequirementAgentConnector_ms": 0.19824504852294922}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 21615.258, "sample_time_ms": 11533.96, "load_time_ms": 23.596, "load_throughput": 169518.54, "learn_time_ms": 10049.932, "learn_throughput": 398.013, "synch_weights_time_ms": 7.269}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 26, "training_iteration": 231, "trial_id": "40f87_00000", "date": "2023-09-21_13-45-14", "timestamp": 1695275114, "time_this_iter_s": 21.68043351173401, "time_total_s": 5045.661586046219, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5045.661586046219, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 31.14666666666666, "ram_util_percent": 55.62333333333334}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5883132530256144, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.7599999999999994e-05, "total_loss": -0.05771479707313589, "policy_loss": -0.05981987386833005, "vf_loss": 0.09253367271289349, "vf_explained_var": 0.17771564736481635, "kl": 0.005519872569653348, "entropy": 0.38189281457133833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.93548387096774, "num_grad_updates_lifetime": 114824.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 21631.615, "sample_time_ms": 11532.26, "load_time_ms": 23.693, "load_throughput": 168827.331, "learn_time_ms": 10067.897, "learn_throughput": 397.302, "synch_weights_time_ms": 7.266}, "counters": {"num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "episodes_total": 28, "training_iteration": 232, "trial_id": "40f87_00000", "date": "2023-09-21_13-45-36", "timestamp": 1695275136, "time_this_iter_s": 21.808595895767212, "time_total_s": 5067.470181941986, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5067.470181941986, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 35.94838709677419, "ram_util_percent": 55.62580645161292}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6008089839691116, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.719999999999999e-05, "total_loss": -0.03612649298719912, "policy_loss": -0.03813874218124716, "vf_loss": 0.08205348291178985, "vf_explained_var": 0.0367177126388396, "kl": 0.0052781475756486975, "entropy": 0.35148158501232823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 115320.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000, "num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 932000, "timers": {"training_iteration_time_ms": 21631.633, "sample_time_ms": 11534.75, "load_time_ms": 23.693, "load_throughput": 168824.273, "learn_time_ms": 10065.324, "learn_throughput": 397.404, "synch_weights_time_ms": 7.265}, "counters": {"num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000}, "done": false, "episodes_total": 28, "training_iteration": 233, "trial_id": "40f87_00000", "date": "2023-09-21_13-45-58", "timestamp": 1695275158, "time_this_iter_s": 21.634194374084473, "time_total_s": 5089.104376316071, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5089.104376316071, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 30.796666666666667, "ram_util_percent": 55.76666666666665}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5771883351487979, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.6800000000000002e-05, "total_loss": -0.0285474966541158, "policy_loss": -0.030580643147151285, "vf_loss": 0.08484645346142052, "vf_explained_var": 0.00863227007850524, "kl": 0.005332450374135512, "entropy": 0.34124672013304885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 115816.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 21642.393, "sample_time_ms": 11538.259, "load_time_ms": 23.793, "load_throughput": 168115.452, "learn_time_ms": 10072.484, "learn_throughput": 397.121, "synch_weights_time_ms": 7.256}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 28, "training_iteration": 234, "trial_id": "40f87_00000", "date": "2023-09-21_13-46-19", "timestamp": 1695275179, "time_this_iter_s": 21.690455198287964, "time_total_s": 5110.7948315143585, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5110.7948315143585, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 31.354838709677416, "ram_util_percent": 55.63225806451614}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.557442439599864, "cur_kl_coeff": 0.37968750000000007, "cur_lr": 1.6400000000000012e-05, "total_loss": -0.03525645084183423, "policy_loss": -0.037077932656111735, "vf_loss": 0.11185402575234372, "vf_explained_var": -0.0038957134369880923, "kl": 0.004767858862495574, "entropy": 0.3423684057028544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 116312.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000, "num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 940000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 21651.421, "sample_time_ms": 11550.071, "load_time_ms": 23.693, "load_throughput": 168825.122, "learn_time_ms": 10069.697, "learn_throughput": 397.231, "synch_weights_time_ms": 7.256}, "counters": {"num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "done": false, "episodes_total": 28, "training_iteration": 235, "trial_id": "40f87_00000", "date": "2023-09-21_13-46-41", "timestamp": 1695275201, "time_this_iter_s": 21.72546100616455, "time_total_s": 5132.520292520523, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5132.520292520523, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 33.10666666666666, "ram_util_percent": 55.56333333333331}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.514234846998607, "cur_kl_coeff": 0.18984375000000003, "cur_lr": 1.6000000000000003e-05, "total_loss": -0.07296284623284478, "policy_loss": -0.07368411358003223, "vf_loss": 0.05685387108091926, "vf_explained_var": -0.0770640988503733, "kl": 0.0037693173017866915, "entropy": 0.35096961668422144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 116808.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 21643.146, "sample_time_ms": 11550.762, "load_time_ms": 23.793, "load_throughput": 168117.81, "learn_time_ms": 10060.632, "learn_throughput": 397.589, "synch_weights_time_ms": 7.356}, "counters": {"num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "episodes_total": 28, "training_iteration": 236, "trial_id": "40f87_00000", "date": "2023-09-21_13-47-03", "timestamp": 1695275223, "time_this_iter_s": 21.619756937026978, "time_total_s": 5154.14004945755, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5154.14004945755, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 30.16129032258064, "ram_util_percent": 55.480645161290326}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5682837899714228, "cur_kl_coeff": 0.09492187500000002, "cur_lr": 1.56e-05, "total_loss": -0.04858183536928282, "policy_loss": -0.04905223775037279, "vf_loss": 0.1212567301624785, "vf_explained_var": -0.021609673576970256, "kl": 0.0048279446764374415, "entropy": 0.3477651449220796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 117304.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 21657.776, "sample_time_ms": 11562.71, "load_time_ms": 23.693, "load_throughput": 168828.01, "learn_time_ms": 10063.393, "learn_throughput": 397.48, "synch_weights_time_ms": 7.375}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 28, "training_iteration": 237, "trial_id": "40f87_00000", "date": "2023-09-21_13-47-25", "timestamp": 1695275245, "time_this_iter_s": 21.68264675140381, "time_total_s": 5175.822696208954, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5175.822696208954, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 31.470000000000006, "ram_util_percent": 55.5}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5224842985551204, "cur_kl_coeff": 0.04746093750000001, "cur_lr": 1.5199999999999997e-05, "total_loss": -0.03472693423710523, "policy_loss": -0.034993204708781936, "vf_loss": 0.0943202558349097, "vf_explained_var": -0.14017995663227573, "kl": 0.005411639917200354, "entropy": 0.3328648824845591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 117800.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 21671.251, "sample_time_ms": 11571.466, "load_time_ms": 23.693, "load_throughput": 168825.632, "learn_time_ms": 10067.716, "learn_throughput": 397.31, "synch_weights_time_ms": 7.775}, "counters": {"num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "episodes_total": 28, "training_iteration": 238, "trial_id": "40f87_00000", "date": "2023-09-21_13-47-46", "timestamp": 1695275266, "time_this_iter_s": 21.797561645507812, "time_total_s": 5197.620257854462, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5197.620257854462, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 32.203225806451606, "ram_util_percent": 55.483870967741936}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.632885462874847, "cur_kl_coeff": 0.04746093750000001, "cur_lr": 1.4799999999999987e-05, "total_loss": -0.024853245141721637, "policy_loss": -0.025104255617759096, "vf_loss": 0.06681537704782621, "vf_explained_var": -0.10589040875915558, "kl": 0.005148011902249978, "entropy": 0.35563537766856534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 118296.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000, "num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 956000, "timers": {"training_iteration_time_ms": 21667.989, "sample_time_ms": 11565.364, "load_time_ms": 23.796, "load_throughput": 168097.934, "learn_time_ms": 10070.562, "learn_throughput": 397.197, "synch_weights_time_ms": 7.767}, "counters": {"num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000}, "done": false, "episodes_total": 28, "training_iteration": 239, "trial_id": "40f87_00000", "date": "2023-09-21_13-48-08", "timestamp": 1695275288, "time_this_iter_s": 21.55915379524231, "time_total_s": 5219.179411649704, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5219.179411649704, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 30.30666666666666, "ram_util_percent": 55.559999999999974}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5724222948774695, "cur_kl_coeff": 0.04746093750000001, "cur_lr": 1.4399999999999996e-05, "total_loss": -0.036154187920704225, "policy_loss": -0.03638838464793216, "vf_loss": 0.15909015114659503, "vf_explained_var": 0.15773473271439153, "kl": 0.004599365963201861, "entropy": 0.356018616247081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 118792.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 21676.193, "sample_time_ms": 11573.127, "load_time_ms": 23.796, "load_throughput": 168098.102, "learn_time_ms": 10071.103, "learn_throughput": 397.176, "synch_weights_time_ms": 7.668}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 28, "training_iteration": 240, "trial_id": "40f87_00000", "date": "2023-09-21_13-48-30", "timestamp": 1695275310, "time_this_iter_s": 21.69799542427063, "time_total_s": 5240.877407073975, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5240.877407073975, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 30.68666666666666, "ram_util_percent": 55.50333333333333}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5380160321271227, "cur_kl_coeff": 0.023730468750000004, "cur_lr": 1.4000000000000008e-05, "total_loss": -0.029927020890740567, "policy_loss": -0.030046866303652473, "vf_loss": 0.09692987659946084, "vf_explained_var": -0.05298343805536147, "kl": 0.004641700710550406, "entropy": 0.3594231908359835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 119288.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000, "num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 964000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 964000, "timers": {"training_iteration_time_ms": 21671.59, "sample_time_ms": 11568.542, "load_time_ms": 23.796, "load_throughput": 168095.744, "learn_time_ms": 10070.764, "learn_throughput": 397.189, "synch_weights_time_ms": 7.987}, "counters": {"num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000}, "done": false, "episodes_total": 28, "training_iteration": 241, "trial_id": "40f87_00000", "date": "2023-09-21_13-48-51", "timestamp": 1695275331, "time_this_iter_s": 21.634180545806885, "time_total_s": 5262.5115876197815, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5262.5115876197815, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 29.193548387096776, "ram_util_percent": 55.56129032258062}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5446271330959374, "cur_kl_coeff": 0.011865234375000002, "cur_lr": 1.3600000000000005e-05, "total_loss": -0.030769238790408934, "policy_loss": -0.03083015022404593, "vf_loss": 0.08051279479367358, "vf_explained_var": -0.27184316780297985, "kl": 0.004455179459696862, "entropy": 0.36934407175548617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 119784.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 21655.927, "sample_time_ms": 11569.132, "load_time_ms": 23.799, "load_throughput": 168074.863, "learn_time_ms": 10054.612, "learn_throughput": 397.827, "synch_weights_time_ms": 7.984}, "counters": {"num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "episodes_total": 28, "training_iteration": 242, "trial_id": "40f87_00000", "date": "2023-09-21_13-49-13", "timestamp": 1695275353, "time_this_iter_s": 21.651973962783813, "time_total_s": 5284.163561582565, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5284.163561582565, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 30.48, "ram_util_percent": 55.489999999999995}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5868055995914244, "cur_kl_coeff": 0.005932617187500001, "cur_lr": 1.3199999999999996e-05, "total_loss": -0.038428370387856785, "policy_loss": -0.038460175308926176, "vf_loss": 0.09264379508432842, "vf_explained_var": -0.022311794421365185, "kl": 0.0037994334174890395, "entropy": 0.37103069723854143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 120280.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 21655.076, "sample_time_ms": 11563.775, "load_time_ms": 23.699, "load_throughput": 168786.567, "learn_time_ms": 10059.312, "learn_throughput": 397.642, "synch_weights_time_ms": 7.992}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 28, "training_iteration": 243, "trial_id": "40f87_00000", "date": "2023-09-21_13-49-35", "timestamp": 1695275375, "time_this_iter_s": 21.62601089477539, "time_total_s": 5305.789572477341, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5305.789572477341, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 30.949999999999996, "ram_util_percent": 55.563333333333304}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6359195087345377, "cur_kl_coeff": 0.0029663085937500005, "cur_lr": 1.2799999999999996e-05, "total_loss": -0.041845755298591907, "policy_loss": -0.04187474549173437, "vf_loss": 0.09341351054007968, "vf_explained_var": -0.17704130480847052, "kl": 0.006623122365347244, "entropy": 0.4166343374958923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 120776.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 21653.223, "sample_time_ms": 11568.976, "load_time_ms": 23.999, "load_throughput": 166675.601, "learn_time_ms": 10051.888, "learn_throughput": 397.935, "synch_weights_time_ms": 8.062}, "counters": {"num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "episodes_total": 28, "training_iteration": 244, "trial_id": "40f87_00000", "date": "2023-09-21_13-49-56", "timestamp": 1695275396, "time_this_iter_s": 21.671923637390137, "time_total_s": 5327.461496114731, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5327.461496114731, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 30.164516129032258, "ram_util_percent": 55.55806451612903}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5795222071990851, "cur_kl_coeff": 0.0029663085937500005, "cur_lr": 1.2399999999999986e-05, "total_loss": -0.014528298335086044, "policy_loss": -0.014553619416537619, "vf_loss": 0.13837249426456588, "vf_explained_var": -0.06867136037157427, "kl": 0.0038720100225845796, "entropy": 0.4101242093789962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 121272.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 21644.211, "sample_time_ms": 11557.092, "load_time_ms": 24.099, "load_throughput": 165984.507, "learn_time_ms": 10054.862, "learn_throughput": 397.818, "synch_weights_time_ms": 8.062}, "counters": {"num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "done": false, "episodes_total": 28, "training_iteration": 245, "trial_id": "40f87_00000", "date": "2023-09-21_13-50-18", "timestamp": 1695275418, "time_this_iter_s": 21.63533639907837, "time_total_s": 5349.096832513809, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5349.096832513809, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 31.316666666666666, "ram_util_percent": 55.593333333333334}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6273362455709327, "cur_kl_coeff": 0.0014831542968750003, "cur_lr": 1.200000000000001e-05, "total_loss": -0.02835445101379352, "policy_loss": -0.028373443198160524, "vf_loss": 0.11721174797839334, "vf_explained_var": -0.12630105547366605, "kl": 0.004902797346999064, "entropy": 0.40828928201188963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 121768.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 21640.803, "sample_time_ms": 11555.909, "load_time_ms": 24.096, "load_throughput": 166004.872, "learn_time_ms": 10052.64, "learn_throughput": 397.905, "synch_weights_time_ms": 7.964}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 28, "training_iteration": 246, "trial_id": "40f87_00000", "date": "2023-09-21_13-50-40", "timestamp": 1695275440, "time_this_iter_s": 21.584747791290283, "time_total_s": 5370.6815803050995, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5370.6815803050995, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 55.556666666666665}}
{"custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6416604501465636, "cur_kl_coeff": 0.0007415771484375001, "cur_lr": 1.16e-05, "total_loss": -0.03309439722440197, "policy_loss": -0.03310843364082053, "vf_loss": 0.105664232580532, "vf_explained_var": -0.03251181314549138, "kl": 0.00467934908551699, "entropy": 0.43333212250182707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 122264.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000}, "sampler_results": {"episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 542.9267857142858, "portfolio_return_min": -100.0, "portfolio_return_max": 6283.45, "position_changes_mean": 34.46, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -86.54464285714288, "max_drawdown_min": -100.0, "max_drawdown_max": -61.64}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}}, "episode_reward_max": -123.42765195624845, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -297.52718171363097, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48051326205746536, "mean_inference_ms": 3.07192416514891, "mean_action_processing_ms": 0.14416300997281423, "mean_env_wait_ms": 2.03688676281111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007144042423793248, "MeanStdObservationFilterAgentConnector_ms": 0.04293663161141532, "StateBufferConnector_ms": 0.003555842808314732, "ViewRequirementAgentConnector_ms": 0.1982637814113072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000, "num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 988000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 988000, "timers": {"training_iteration_time_ms": 21647.978, "sample_time_ms": 11565.288, "load_time_ms": 24.068, "load_throughput": 166194.311, "learn_time_ms": 10050.466, "learn_throughput": 397.991, "synch_weights_time_ms": 7.86}, "counters": {"num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000}, "done": false, "episodes_total": 28, "training_iteration": 247, "trial_id": "40f87_00000", "date": "2023-09-21_13-51-01", "timestamp": 1695275461, "time_this_iter_s": 21.75442385673523, "time_total_s": 5392.436004161835, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5392.436004161835, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 30.119354838709672, "ram_util_percent": 55.49354838709678}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6656546404044474, "cur_kl_coeff": 0.00037078857421875007, "cur_lr": 1.1200000000000001e-05, "total_loss": -0.027675115837595396, "policy_loss": -0.027683426406339653, "vf_loss": 0.06795467853906655, "vf_explained_var": -0.09408011984440588, "kl": 0.004087655728831152, "entropy": 0.4134383142114647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.90322580645162, "num_grad_updates_lifetime": 122760.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 21636.597, "sample_time_ms": 11554.629, "load_time_ms": 24.065, "load_throughput": 166218.516, "learn_time_ms": 10050.044, "learn_throughput": 398.008, "synch_weights_time_ms": 7.363}, "counters": {"num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "episodes_total": 30, "training_iteration": 248, "trial_id": "40f87_00000", "date": "2023-09-21_13-51-23", "timestamp": 1695275483, "time_this_iter_s": 21.681152820587158, "time_total_s": 5414.117156982422, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5414.117156982422, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 32.236666666666665, "ram_util_percent": 55.383333333333326}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6665887786075473, "cur_kl_coeff": 0.00018539428710937503, "cur_lr": 1.0799999999999991e-05, "total_loss": -0.0331285523791467, "policy_loss": -0.033139818849327464, "vf_loss": 0.1054169657797883, "vf_explained_var": 0.07194595050907904, "kl": 0.003910374865735035, "entropy": 0.3411852443410504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 123256.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 21642.84, "sample_time_ms": 11563.747, "load_time_ms": 24.488, "load_throughput": 163344.543, "learn_time_ms": 10046.345, "learn_throughput": 398.155, "synch_weights_time_ms": 7.763}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 30, "training_iteration": 249, "trial_id": "40f87_00000", "date": "2023-09-21_13-51-45", "timestamp": 1695275505, "time_this_iter_s": 21.62225580215454, "time_total_s": 5435.739412784576, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5435.739412784576, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 29.58387096774193, "ram_util_percent": 55.40967741935485}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6427081586011956, "cur_kl_coeff": 9.269714355468752e-05, "cur_lr": 1.0399999999999992e-05, "total_loss": -0.026447037020848402, "policy_loss": -0.026453575774447076, "vf_loss": 0.06196947437110207, "vf_explained_var": -0.0932847875500879, "kl": 0.0036636586091159115, "entropy": 0.3299853963056399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 123752.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 21640.129, "sample_time_ms": 11557.496, "load_time_ms": 24.507, "load_throughput": 163221.861, "learn_time_ms": 10049.867, "learn_throughput": 398.015, "synch_weights_time_ms": 7.763}, "counters": {"num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "episodes_total": 30, "training_iteration": 250, "trial_id": "40f87_00000", "date": "2023-09-21_13-52-06", "timestamp": 1695275526, "time_this_iter_s": 21.6708664894104, "time_total_s": 5457.410279273987, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5457.410279273987, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 30.18, "ram_util_percent": 55.410000000000004}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6268217360540744, "cur_kl_coeff": 4.634857177734376e-05, "cur_lr": 1.0000000000000003e-05, "total_loss": -0.02869764156052805, "policy_loss": -0.028708072554793268, "vf_loss": 0.1027961112709055, "vf_explained_var": -0.0314759824785494, "kl": 0.0033149716051968387, "entropy": 0.33117385569118685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 124248.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000, "num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1004000, "timers": {"training_iteration_time_ms": 21647.541, "sample_time_ms": 11570.383, "load_time_ms": 24.503, "load_throughput": 163248.225, "learn_time_ms": 10044.703, "learn_throughput": 398.22, "synch_weights_time_ms": 7.457}, "counters": {"num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000}, "done": false, "episodes_total": 30, "training_iteration": 251, "trial_id": "40f87_00000", "date": "2023-09-21_13-52-28", "timestamp": 1695275548, "time_this_iter_s": 21.707581043243408, "time_total_s": 5479.11786031723, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5479.11786031723, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 29.810000000000002, "ram_util_percent": 55.45666666666667}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6812036132980739, "cur_kl_coeff": 2.317428588867188e-05, "cur_lr": 9.996000000000002e-06, "total_loss": -0.021611495835391143, "policy_loss": -0.02161759239313523, "vf_loss": 0.05989436678318007, "vf_explained_var": -0.10507098705537858, "kl": 0.0046537698908261805, "entropy": 0.3280434494597777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 124744.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 21644.326, "sample_time_ms": 11568.318, "load_time_ms": 24.499, "load_throughput": 163268.878, "learn_time_ms": 10043.452, "learn_throughput": 398.269, "synch_weights_time_ms": 7.46}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 30, "training_iteration": 252, "trial_id": "40f87_00000", "date": "2023-09-21_13-52-50", "timestamp": 1695275570, "time_this_iter_s": 21.61982488632202, "time_total_s": 5500.737685203552, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5500.737685203552, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 31.016129032258068, "ram_util_percent": 55.461290322580666}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.628275097257668, "cur_kl_coeff": 1.158714294433594e-05, "cur_lr": 9.992e-06, "total_loss": -0.02797418480528699, "policy_loss": -0.02798273817414508, "vf_loss": 0.08515713507339599, "vf_explained_var": -0.1437681986679954, "kl": 0.0034480005596714165, "entropy": 0.343591584974239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 125240.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000, "num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1012000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1012000, "timers": {"training_iteration_time_ms": 21650.145, "sample_time_ms": 11574.085, "load_time_ms": 24.597, "load_throughput": 162624.761, "learn_time_ms": 10043.413, "learn_throughput": 398.271, "synch_weights_time_ms": 7.354}, "counters": {"num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000}, "done": false, "episodes_total": 30, "training_iteration": 253, "trial_id": "40f87_00000", "date": "2023-09-21_13-53-12", "timestamp": 1695275592, "time_this_iter_s": 21.68421983718872, "time_total_s": 5522.421905040741, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5522.421905040741, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 31.053333333333335, "ram_util_percent": 55.44666666666667}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6458161947347464, "cur_kl_coeff": 5.79357147216797e-06, "cur_lr": 9.988000000000002e-06, "total_loss": -0.022580741370538525, "policy_loss": -0.022587137803824472, "vf_loss": 0.06381737376232782, "vf_explained_var": -0.11813683086825956, "kl": 0.003004360623184679, "entropy": 0.32138722456030305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 125736.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 21654.893, "sample_time_ms": 11575.071, "load_time_ms": 24.293, "load_throughput": 164654.428, "learn_time_ms": 10047.552, "learn_throughput": 398.107, "synch_weights_time_ms": 7.281}, "counters": {"num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "episodes_total": 30, "training_iteration": 254, "trial_id": "40f87_00000", "date": "2023-09-21_13-53-33", "timestamp": 1695275613, "time_this_iter_s": 21.71943235397339, "time_total_s": 5544.141337394714, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5544.141337394714, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 30.809677419354838, "ram_util_percent": 55.454838709677446}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6094512173365201, "cur_kl_coeff": 2.896785736083985e-06, "cur_lr": 9.984000000000001e-06, "total_loss": -0.02363441362103913, "policy_loss": -0.02364062244047208, "vf_loss": 0.06201807662446593, "vf_explained_var": -0.03664651428980212, "kl": 0.003635346492242145, "entropy": 0.3246506091748034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 126232.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 21663.404, "sample_time_ms": 11582.611, "load_time_ms": 24.29, "load_throughput": 164675.6, "learn_time_ms": 10048.522, "learn_throughput": 398.068, "synch_weights_time_ms": 7.284}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 30, "training_iteration": 255, "trial_id": "40f87_00000", "date": "2023-09-21_13-53-55", "timestamp": 1695275635, "time_this_iter_s": 21.720415353775024, "time_total_s": 5565.861752748489, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5565.861752748489, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 30.3, "ram_util_percent": 55.46333333333335}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6815600457090524, "cur_kl_coeff": 1.4483928680419924e-06, "cur_lr": 9.980000000000001e-06, "total_loss": -0.01877870455932533, "policy_loss": -0.018789192237290402, "vf_loss": 0.1048750743953391, "vf_explained_var": 0.05007398116492456, "kl": 0.0033354459290992895, "entropy": 0.3470190190259487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 126728.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 21673.807, "sample_time_ms": 11585.586, "load_time_ms": 24.293, "load_throughput": 164654.913, "learn_time_ms": 10055.948, "learn_throughput": 397.775, "synch_weights_time_ms": 7.382}, "counters": {"num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "episodes_total": 30, "training_iteration": 256, "trial_id": "40f87_00000", "date": "2023-09-21_13-54-17", "timestamp": 1695275657, "time_this_iter_s": 21.689737558364868, "time_total_s": 5587.551490306854, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5587.551490306854, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 29.81935483870968, "ram_util_percent": 55.367741935483856}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7139771848075813, "cur_kl_coeff": 7.241964340209962e-07, "cur_lr": 9.976000000000002e-06, "total_loss": -0.021903819032764484, "policy_loss": -0.02191146189767507, "vf_loss": 0.07643329733682255, "vf_explained_var": 0.09324296419658969, "kl": 0.004162209092106401, "entropy": 0.3529629271116949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 127224.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000, "num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1028000, "timers": {"training_iteration_time_ms": 21664.749, "sample_time_ms": 11572.528, "load_time_ms": 24.282, "load_throughput": 164729.928, "learn_time_ms": 10059.958, "learn_throughput": 397.616, "synch_weights_time_ms": 7.483}, "counters": {"num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000}, "done": false, "episodes_total": 30, "training_iteration": 257, "trial_id": "40f87_00000", "date": "2023-09-21_13-54-38", "timestamp": 1695275678, "time_this_iter_s": 21.663811206817627, "time_total_s": 5609.215301513672, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5609.215301513672, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 30.92333333333334, "ram_util_percent": 55.29333333333332}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6678909521790282, "cur_kl_coeff": 3.620982170104981e-07, "cur_lr": 9.972000000000002e-06, "total_loss": -0.026683877150888644, "policy_loss": -0.02669121020834052, "vf_loss": 0.07330219998144574, "vf_explained_var": -0.26209250657308486, "kl": 0.0031941559926414974, "entropy": 0.352379469621566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 127720.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 21668.91, "sample_time_ms": 11574.404, "load_time_ms": 24.688, "load_throughput": 162018.87, "learn_time_ms": 10061.84, "learn_throughput": 397.542, "synch_weights_time_ms": 7.68}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 30, "training_iteration": 258, "trial_id": "40f87_00000", "date": "2023-09-21_13-55-00", "timestamp": 1695275700, "time_this_iter_s": 21.723739624023438, "time_total_s": 5630.939041137695, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5630.939041137695, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 29.86129032258064, "ram_util_percent": 55.29032258064517}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6734751384825476, "cur_kl_coeff": 1.8104910850524906e-07, "cur_lr": 9.968e-06, "total_loss": -0.016535468604190334, "policy_loss": -0.016541881412605666, "vf_loss": 0.06414109863145577, "vf_explained_var": -0.2518911789501867, "kl": 0.0024864029313068484, "entropy": 0.37249771685850236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 128216.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1036000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1036000, "timers": {"training_iteration_time_ms": 21671.489, "sample_time_ms": 11569.851, "load_time_ms": 24.266, "load_throughput": 164840.148, "learn_time_ms": 10069.801, "learn_throughput": 397.227, "synch_weights_time_ms": 7.274}, "counters": {"num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "done": false, "episodes_total": 30, "training_iteration": 259, "trial_id": "40f87_00000", "date": "2023-09-21_13-55-22", "timestamp": 1695275722, "time_this_iter_s": 21.647400617599487, "time_total_s": 5652.586441755295, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5652.586441755295, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 30.916666666666664, "ram_util_percent": 55.309999999999995}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6436266615506141, "cur_kl_coeff": 9.052455425262453e-08, "cur_lr": 9.964000000000002e-06, "total_loss": -0.03251694018704696, "policy_loss": -0.03252572348191602, "vf_loss": 0.08779576677648772, "vf_explained_var": -0.05707771931925128, "kl": 0.003052618214943135, "entropy": 0.3797824868872281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 128712.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 21673.193, "sample_time_ms": 11576.192, "load_time_ms": 24.148, "load_throughput": 165647.237, "learn_time_ms": 10065.085, "learn_throughput": 397.413, "synch_weights_time_ms": 7.274}, "counters": {"num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "episodes_total": 30, "training_iteration": 260, "trial_id": "40f87_00000", "date": "2023-09-21_13-55-44", "timestamp": 1695275744, "time_this_iter_s": 21.68693208694458, "time_total_s": 5674.273373842239, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5674.273373842239, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 31.87, "ram_util_percent": 55.34999999999999}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6719819187156616, "cur_kl_coeff": 4.5262277126312264e-08, "cur_lr": 9.960000000000001e-06, "total_loss": -0.029654614083776853, "policy_loss": -0.029663407015417056, "vf_loss": 0.08793398508081032, "vf_explained_var": -0.0147703334448799, "kl": 0.005151717560511653, "entropy": 0.44512973401334976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 129208.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 21670.161, "sample_time_ms": 11575.067, "load_time_ms": 24.149, "load_throughput": 165640.532, "learn_time_ms": 10063.176, "learn_throughput": 397.489, "synch_weights_time_ms": 7.174}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 30, "training_iteration": 261, "trial_id": "40f87_00000", "date": "2023-09-21_13-56-05", "timestamp": 1695275765, "time_this_iter_s": 21.677237510681152, "time_total_s": 5695.9506113529205, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5695.9506113529205, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 30.07741935483871, "ram_util_percent": 55.33870967741937}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6503564586802837, "cur_kl_coeff": 4.5262277126312264e-08, "cur_lr": 9.956000000000001e-06, "total_loss": -0.030225803317021457, "policy_loss": -0.0302355186863532, "vf_loss": 0.09714150394973976, "vf_explained_var": -0.06203538491841285, "kl": 0.002676123632651298, "entropy": 0.37382473448111164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 129704.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 21675.968, "sample_time_ms": 11583.403, "load_time_ms": 24.149, "load_throughput": 165638.733, "learn_time_ms": 10060.651, "learn_throughput": 397.589, "synch_weights_time_ms": 7.173}, "counters": {"num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "episodes_total": 30, "training_iteration": 262, "trial_id": "40f87_00000", "date": "2023-09-21_13-56-27", "timestamp": 1695275787, "time_this_iter_s": 21.67789602279663, "time_total_s": 5717.628507375717, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5717.628507375717, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 32.49666666666666, "ram_util_percent": 55.320000000000014}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6712805330152473, "cur_kl_coeff": 2.2631138563156132e-08, "cur_lr": 9.952e-06, "total_loss": -0.02539074949805992, "policy_loss": -0.025397937193036475, "vf_loss": 0.07186001786331256, "vf_explained_var": -0.26924078815406366, "kl": 0.0037596531390595585, "entropy": 0.42278092829210145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 130200.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000, "num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1052000, "timers": {"training_iteration_time_ms": 21672.051, "sample_time_ms": 11588.797, "load_time_ms": 24.052, "load_throughput": 166303.533, "learn_time_ms": 10051.337, "learn_throughput": 397.957, "synch_weights_time_ms": 7.273}, "counters": {"num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000}, "done": false, "episodes_total": 30, "training_iteration": 263, "trial_id": "40f87_00000", "date": "2023-09-21_13-56-49", "timestamp": 1695275809, "time_this_iter_s": 21.644052982330322, "time_total_s": 5739.2725603580475, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5739.2725603580475, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 30.07096774193549, "ram_util_percent": 55.03870967741935}}
{"custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6777073226628765, "cur_kl_coeff": 1.1315569281578066e-08, "cur_lr": 9.947999999999999e-06, "total_loss": -0.021880387976770797, "policy_loss": -0.02188908538048582, "vf_loss": 0.08698876749258488, "vf_explained_var": -0.09855475024350228, "kl": 0.003877306312215434, "entropy": 0.43189896522991117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 130696.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1121.6986666666667, "portfolio_return_min": -100.0, "portfolio_return_max": 13486.72, "position_changes_mean": 34.30566666666667, "position_changes_min": 31.87, "position_changes_max": 42.48, "max_drawdown_mean": -84.18066666666668, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}}, "episode_reward_max": -109.66995991224961, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -285.94242139226577, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48062369350145734, "mean_inference_ms": 3.0710012147018935, "mean_action_processing_ms": 0.14425757665623437, "mean_env_wait_ms": 2.037190182270123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667772928873698, "MeanStdObservationFilterAgentConnector_ms": 0.043403307596842446, "StateBufferConnector_ms": 0.00331878662109375, "ViewRequirementAgentConnector_ms": 0.20849386850992838}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 21662.834, "sample_time_ms": 11584.832, "load_time_ms": 24.056, "load_throughput": 166277.327, "learn_time_ms": 10045.98, "learn_throughput": 398.169, "synch_weights_time_ms": 7.273}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 30, "training_iteration": 264, "trial_id": "40f87_00000", "date": "2023-09-21_13-57-10", "timestamp": 1695275830, "time_this_iter_s": 21.6272611618042, "time_total_s": 5760.899821519852, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5760.899821519852, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 30.39666666666667, "ram_util_percent": 54.96333333333335}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6644983305445602, "cur_kl_coeff": 5.657784640789033e-09, "cur_lr": 9.944000000000002e-06, "total_loss": -0.01663559837822592, "policy_loss": -0.016644979000932748, "vf_loss": 0.09378632737488876, "vf_explained_var": -0.06784393950816124, "kl": 0.003294155339368275, "entropy": 0.3634991567702063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.87096774193549, "num_grad_updates_lifetime": 131192.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000, "num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1060000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1060000, "timers": {"training_iteration_time_ms": 21666.009, "sample_time_ms": 11589.221, "load_time_ms": 24.06, "load_throughput": 166249.646, "learn_time_ms": 10044.463, "learn_throughput": 398.229, "synch_weights_time_ms": 7.573}, "counters": {"num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "done": false, "episodes_total": 32, "training_iteration": 265, "trial_id": "40f87_00000", "date": "2023-09-21_13-57-32", "timestamp": 1695275852, "time_this_iter_s": 21.752169132232666, "time_total_s": 5782.651990652084, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5782.651990652084, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 31.53870967741935, "ram_util_percent": 54.97096774193548}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6522528737062409, "cur_kl_coeff": 2.8288923203945165e-09, "cur_lr": 9.940000000000001e-06, "total_loss": -0.020382560160566842, "policy_loss": -0.020390842819676524, "vf_loss": 0.08283748413856712, "vf_explained_var": 0.07370314506753799, "kl": 0.003344058699799729, "entropy": 0.3474280662954815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 131688.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 21661.362, "sample_time_ms": 11588.439, "load_time_ms": 24.06, "load_throughput": 166250.14, "learn_time_ms": 10040.693, "learn_throughput": 398.379, "synch_weights_time_ms": 7.479}, "counters": {"num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "episodes_total": 32, "training_iteration": 266, "trial_id": "40f87_00000", "date": "2023-09-21_13-57-54", "timestamp": 1695275874, "time_this_iter_s": 21.64321494102478, "time_total_s": 5804.295205593109, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5804.295205593109, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 30.366666666666667, "ram_util_percent": 54.996666666666684}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5573404819193867, "cur_kl_coeff": 1.4144461601972582e-09, "cur_lr": 9.935999999999998e-06, "total_loss": -0.024601976449165733, "policy_loss": -0.02461764935223102, "vf_loss": 0.15673789238527178, "vf_explained_var": -0.001628706532139932, "kl": 0.002833104212630182, "entropy": 0.31864157634516876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 132184.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 21661.027, "sample_time_ms": 11585.322, "load_time_ms": 24.099, "load_throughput": 165983.686, "learn_time_ms": 10043.436, "learn_throughput": 398.27, "synch_weights_time_ms": 7.279}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 32, "training_iteration": 267, "trial_id": "40f87_00000", "date": "2023-09-21_13-58-15", "timestamp": 1695275895, "time_this_iter_s": 21.660484313964844, "time_total_s": 5825.955689907074, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5825.955689907074, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 31.386666666666667, "ram_util_percent": 55.00333333333332}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6380553684167324, "cur_kl_coeff": 7.072230800986291e-10, "cur_lr": 9.932e-06, "total_loss": -0.034057634543358056, "policy_loss": -0.03406367115238965, "vf_loss": 0.06035696706479235, "vf_explained_var": -0.11276700203457186, "kl": 0.0038183915693773838, "entropy": 0.32921998461167656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 132680.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 21648.084, "sample_time_ms": 11577.952, "load_time_ms": 23.796, "load_throughput": 168097.26, "learn_time_ms": 10037.86, "learn_throughput": 398.491, "synch_weights_time_ms": 7.582}, "counters": {"num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "episodes_total": 32, "training_iteration": 268, "trial_id": "40f87_00000", "date": "2023-09-21_13-58-37", "timestamp": 1695275917, "time_this_iter_s": 21.59433388710022, "time_total_s": 5847.550023794174, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5847.550023794174, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 30.938709677419347, "ram_util_percent": 55.051612903225816}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.638735712956517, "cur_kl_coeff": 3.5361154004931456e-10, "cur_lr": 9.928e-06, "total_loss": -0.031188836188859217, "policy_loss": -0.03119484347717521, "vf_loss": 0.06005675811320543, "vf_explained_var": -0.2892419722291731, "kl": 0.0032965746319594223, "entropy": 0.32387781756058814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 133176.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000, "num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1076000, "timers": {"training_iteration_time_ms": 21653.375, "sample_time_ms": 11586.179, "load_time_ms": 23.795, "load_throughput": 168101.471, "learn_time_ms": 10034.918, "learn_throughput": 398.608, "synch_weights_time_ms": 7.588}, "counters": {"num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000}, "done": false, "episodes_total": 32, "training_iteration": 269, "trial_id": "40f87_00000", "date": "2023-09-21_13-58-59", "timestamp": 1695275939, "time_this_iter_s": 21.700284957885742, "time_total_s": 5869.25030875206, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5869.25030875206, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 31.39333333333333, "ram_util_percent": 55.003333333333316}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6473718342641669, "cur_kl_coeff": 1.7680577002465728e-10, "cur_lr": 9.923999999999998e-06, "total_loss": -0.029061648764162153, "policy_loss": -0.02907091285493196, "vf_loss": 0.09260382097695143, "vf_explained_var": -0.022147769889523907, "kl": 0.0032164604338930907, "entropy": 0.33949352836897295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 133672.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 21642.261, "sample_time_ms": 11573.606, "load_time_ms": 23.795, "load_throughput": 168101.471, "learn_time_ms": 10036.377, "learn_throughput": 398.55, "synch_weights_time_ms": 7.585}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 32, "training_iteration": 270, "trial_id": "40f87_00000", "date": "2023-09-21_13-59-20", "timestamp": 1695275960, "time_this_iter_s": 21.578794479370117, "time_total_s": 5890.82910323143, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5890.82910323143, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 29.519999999999996, "ram_util_percent": 55.030000000000015}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6294939672994998, "cur_kl_coeff": 8.840288501232864e-11, "cur_lr": 9.920000000000003e-06, "total_loss": -0.023256455889842924, "policy_loss": -0.023263225283083177, "vf_loss": 0.06770962669378927, "vf_explained_var": -0.24529630798966653, "kl": 0.0024028510082225248, "entropy": 0.29326340565157516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 134168.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000, "num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1084000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1084000, "timers": {"training_iteration_time_ms": 21641.072, "sample_time_ms": 11563.415, "load_time_ms": 23.795, "load_throughput": 168104.166, "learn_time_ms": 10045.475, "learn_throughput": 398.189, "synch_weights_time_ms": 7.589}, "counters": {"num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000}, "done": false, "episodes_total": 32, "training_iteration": 271, "trial_id": "40f87_00000", "date": "2023-09-21_13-59-42", "timestamp": 1695275982, "time_this_iter_s": 21.666339635849, "time_total_s": 5912.495442867279, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5912.495442867279, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 30.458064516129035, "ram_util_percent": 54.96451612903226}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6093035595070931, "cur_kl_coeff": 4.420144250616432e-11, "cur_lr": 9.916000000000003e-06, "total_loss": -0.018844999326956307, "policy_loss": -0.018854577897957737, "vf_loss": 0.09580496800011926, "vf_explained_var": -0.08314741967666534, "kl": 0.0030486329061486656, "entropy": 0.33330216054474154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 134664.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 21663.697, "sample_time_ms": 11557.142, "load_time_ms": 23.798, "load_throughput": 168080.251, "learn_time_ms": 10074.37, "learn_throughput": 397.047, "synch_weights_time_ms": 7.687}, "counters": {"num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "episodes_total": 32, "training_iteration": 272, "trial_id": "40f87_00000", "date": "2023-09-21_14-00-04", "timestamp": 1695276004, "time_this_iter_s": 21.905155897140503, "time_total_s": 5934.40059876442, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5934.40059876442, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 34.416666666666664, "ram_util_percent": 55.03333333333333}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6613468872683663, "cur_kl_coeff": 2.210072125308216e-11, "cur_lr": 9.912e-06, "total_loss": -0.009838770299504704, "policy_loss": -0.009849002277464493, "vf_loss": 0.10231988585644192, "vf_explained_var": 0.15054538197094394, "kl": 0.002746607900094866, "entropy": 0.34257229838159775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 135160.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 21665.989, "sample_time_ms": 11553.533, "load_time_ms": 23.898, "load_throughput": 167380.49, "learn_time_ms": 10080.173, "learn_throughput": 396.819, "synch_weights_time_ms": 7.786}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 32, "training_iteration": 273, "trial_id": "40f87_00000", "date": "2023-09-21_14-00-26", "timestamp": 1695276026, "time_this_iter_s": 21.66675615310669, "time_total_s": 5956.067354917526, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5956.067354917526, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 30.116129032258065, "ram_util_percent": 55.16451612903224}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.691316566279819, "cur_kl_coeff": 1.105036062654108e-11, "cur_lr": 9.907999999999997e-06, "total_loss": -0.027285716911295263, "policy_loss": -0.027291921604024362, "vf_loss": 0.06205494053691866, "vf_explained_var": -0.15273731526347897, "kl": 0.00350755231429205, "entropy": 0.35229489711984513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 135656.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 21675.35, "sample_time_ms": 11554.564, "load_time_ms": 24.014, "load_throughput": 166568.867, "learn_time_ms": 10088.383, "learn_throughput": 396.496, "synch_weights_time_ms": 7.889}, "counters": {"num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "episodes_total": 32, "training_iteration": 274, "trial_id": "40f87_00000", "date": "2023-09-21_14-00-47", "timestamp": 1695276047, "time_this_iter_s": 21.722960710525513, "time_total_s": 5977.790315628052, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5977.790315628052, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 30.616666666666667, "ram_util_percent": 55.09666666666667}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5935566846521632, "cur_kl_coeff": 5.52518031327054e-12, "cur_lr": 9.904e-06, "total_loss": -0.023589371523807894, "policy_loss": -0.023596985911060454, "vf_loss": 0.07614267964081298, "vf_explained_var": -0.27440189726410374, "kl": 0.0026321304002315787, "entropy": 0.35747942058069093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 136152.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000, "num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1100000, "timers": {"training_iteration_time_ms": 21682.115, "sample_time_ms": 11560.927, "load_time_ms": 24.016, "load_throughput": 166552.827, "learn_time_ms": 10088.981, "learn_throughput": 396.472, "synch_weights_time_ms": 7.589}, "counters": {"num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "done": false, "episodes_total": 32, "training_iteration": 275, "trial_id": "40f87_00000", "date": "2023-09-21_14-01-09", "timestamp": 1695276069, "time_this_iter_s": 21.821818113327026, "time_total_s": 5999.612133741379, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5999.612133741379, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 31.109677419354835, "ram_util_percent": 55.054838709677405}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6846451297883065, "cur_kl_coeff": 2.76259015663527e-12, "cur_lr": 9.899999999999998e-06, "total_loss": -0.025963456324872472, "policy_loss": -0.025969928990478716, "vf_loss": 0.06473623828271464, "vf_explained_var": -0.0682453191088092, "kl": 0.0032704986204549927, "entropy": 0.3594863433390856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 136648.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 21686.935, "sample_time_ms": 11564.706, "load_time_ms": 24.016, "load_throughput": 166552.661, "learn_time_ms": 10089.929, "learn_throughput": 396.435, "synch_weights_time_ms": 7.684}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 32, "training_iteration": 276, "trial_id": "40f87_00000", "date": "2023-09-21_14-01-31", "timestamp": 1695276091, "time_this_iter_s": 21.690334796905518, "time_total_s": 6021.302468538284, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6021.302468538284, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 30.143333333333334, "ram_util_percent": 55.1}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6591569576412439, "cur_kl_coeff": 1.381295078317635e-12, "cur_lr": 9.896000000000005e-06, "total_loss": -0.0304179937236533, "policy_loss": -0.030426645019976984, "vf_loss": 0.08650788134189262, "vf_explained_var": -0.2074896359155255, "kl": 0.003647675509562358, "entropy": 0.40943821940210556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 137144.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000, "num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1108000, "timers": {"training_iteration_time_ms": 21686.006, "sample_time_ms": 11568.008, "load_time_ms": 24.017, "load_throughput": 166551.339, "learn_time_ms": 10085.694, "learn_throughput": 396.601, "synch_weights_time_ms": 7.887}, "counters": {"num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000}, "done": false, "episodes_total": 32, "training_iteration": 277, "trial_id": "40f87_00000", "date": "2023-09-21_14-01-53", "timestamp": 1695276113, "time_this_iter_s": 21.652170181274414, "time_total_s": 6042.954638719559, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6042.954638719559, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 31.22903225806452, "ram_util_percent": 55.0548387096774}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6231580568898109, "cur_kl_coeff": 6.906475391588175e-13, "cur_lr": 9.892000000000003e-06, "total_loss": -0.03030914909991665, "policy_loss": -0.03031809816386686, "vf_loss": 0.08948947008579008, "vf_explained_var": -0.008619698425454477, "kl": 0.003766306117342146, "entropy": 0.40883685342006143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 137640.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 21695.128, "sample_time_ms": 11576.229, "load_time_ms": 24.03, "load_throughput": 166458.635, "learn_time_ms": 10086.983, "learn_throughput": 396.551, "synch_weights_time_ms": 7.487}, "counters": {"num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "episodes_total": 32, "training_iteration": 278, "trial_id": "40f87_00000", "date": "2023-09-21_14-02-14", "timestamp": 1695276134, "time_this_iter_s": 21.68552827835083, "time_total_s": 6064.64016699791, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6064.64016699791, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 31.68, "ram_util_percent": 55.083333333333336}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6297116438527742, "cur_kl_coeff": 3.4532376957940875e-13, "cur_lr": 9.888e-06, "total_loss": -0.031339537893091476, "policy_loss": -0.03135305392225423, "vf_loss": 0.13517003275469067, "vf_explained_var": -0.19145237822686473, "kl": 0.002867585627126414, "entropy": 0.38894221054450157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 138136.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 21689.097, "sample_time_ms": 11570.286, "load_time_ms": 24.03, "load_throughput": 166457.809, "learn_time_ms": 10086.791, "learn_throughput": 396.558, "synch_weights_time_ms": 7.49}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 32, "training_iteration": 279, "trial_id": "40f87_00000", "date": "2023-09-21_14-02-36", "timestamp": 1695276156, "time_this_iter_s": 21.63897681236267, "time_total_s": 6086.279143810272, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6086.279143810272, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 29.953333333333333, "ram_util_percent": 55.05333333333331}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7196821037439569, "cur_kl_coeff": 1.7266188478970438e-13, "cur_lr": 9.883999999999999e-06, "total_loss": -0.03143735761864997, "policy_loss": -0.03144332929138815, "vf_loss": 0.05973011229164718, "vf_explained_var": -0.15775284291275085, "kl": 0.004184961735356135, "entropy": 0.4242892881795283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 138632.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 21698.462, "sample_time_ms": 11582.39, "load_time_ms": 24.034, "load_throughput": 166433.535, "learn_time_ms": 10084.146, "learn_throughput": 396.662, "synch_weights_time_ms": 7.493}, "counters": {"num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "episodes_total": 32, "training_iteration": 280, "trial_id": "40f87_00000", "date": "2023-09-21_14-02-58", "timestamp": 1695276178, "time_this_iter_s": 21.670449256896973, "time_total_s": 6107.949593067169, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6107.949593067169, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 31.08064516129032, "ram_util_percent": 55.15161290322582}}
{"custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6468058617845658, "cur_kl_coeff": 8.633094239485219e-14, "cur_lr": 9.880000000000004e-06, "total_loss": -0.016713340897225745, "policy_loss": -0.016719852707483957, "vf_loss": 0.06512500321672808, "vf_explained_var": -0.2461785466199921, "kl": 0.002770501166937459, "entropy": 0.4029179089852879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 139128.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000}, "sampler_results": {"episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 1974.3690625000002, "portfolio_return_min": -100.0, "portfolio_return_max": 17786.46, "position_changes_mean": 34.09375, "position_changes_min": 30.89, "position_changes_max": 42.48, "max_drawdown_mean": -82.85968749999999, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}}, "episode_reward_max": -83.3128126086049, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -273.7085963178064, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480725475526186, "mean_inference_ms": 3.070146153961715, "mean_action_processing_ms": 0.14434569303390285, "mean_env_wait_ms": 2.0374942348261507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009375065565109253, "MeanStdObservationFilterAgentConnector_ms": 0.05016252398490906, "StateBufferConnector_ms": 0.0031113624572753906, "ViewRequirementAgentConnector_ms": 0.20181983709335327}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000, "num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1124000, "timers": {"training_iteration_time_ms": 21703.51, "sample_time_ms": 11587.534, "load_time_ms": 24.037, "load_throughput": 166412.569, "learn_time_ms": 10083.95, "learn_throughput": 396.67, "synch_weights_time_ms": 7.49}, "counters": {"num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000}, "done": false, "episodes_total": 32, "training_iteration": 281, "trial_id": "40f87_00000", "date": "2023-09-21_14-03-20", "timestamp": 1695276200, "time_this_iter_s": 21.715845823287964, "time_total_s": 6129.665438890457, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6129.665438890457, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 31.669999999999998, "ram_util_percent": 55.08333333333332}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6802788629767395, "cur_kl_coeff": 4.3165471197426094e-14, "cur_lr": 9.876000000000002e-06, "total_loss": -0.019749065358800798, "policy_loss": -0.019757898639234613, "vf_loss": 0.08835150373558845, "vf_explained_var": 0.0944517147877524, "kl": 0.00337467725443804, "entropy": 0.3379580274584793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.83870967741936, "num_grad_updates_lifetime": 139624.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 21686.241, "sample_time_ms": 11589.017, "load_time_ms": 23.939, "load_throughput": 167088.268, "learn_time_ms": 10064.898, "learn_throughput": 397.421, "synch_weights_time_ms": 7.589}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 34, "training_iteration": 282, "trial_id": "40f87_00000", "date": "2023-09-21_14-03-41", "timestamp": 1695276221, "time_this_iter_s": 21.731455087661743, "time_total_s": 6151.396893978119, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6151.396893978119, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 31.2, "ram_util_percent": 55.141935483870974}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6468977993654628, "cur_kl_coeff": 2.1582735598713047e-14, "cur_lr": 9.872000000000001e-06, "total_loss": -0.03236478895782526, "policy_loss": -0.03237092914253393, "vf_loss": 0.06139250707647373, "vf_explained_var": -0.10830460368625579, "kl": 0.0036514401843869486, "entropy": 0.32987953112610885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 140120.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000, "num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1132000, "timers": {"training_iteration_time_ms": 21686.058, "sample_time_ms": 11588.259, "load_time_ms": 23.84, "load_throughput": 167788.435, "learn_time_ms": 10065.571, "learn_throughput": 397.394, "synch_weights_time_ms": 7.493}, "counters": {"num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000}, "done": false, "episodes_total": 34, "training_iteration": 283, "trial_id": "40f87_00000", "date": "2023-09-21_14-04-03", "timestamp": 1695276243, "time_this_iter_s": 21.6651029586792, "time_total_s": 6173.061996936798, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6173.061996936798, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 31.826666666666664, "ram_util_percent": 55.046666666666646}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.636726021646492, "cur_kl_coeff": 1.0791367799356523e-14, "cur_lr": 9.868000000000004e-06, "total_loss": -0.0251462445344406, "policy_loss": -0.02515426063297538, "vf_loss": 0.08015372106550081, "vf_explained_var": -0.10928127998786588, "kl": 0.003866394466129127, "entropy": 0.3222046214486322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 140616.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 21686.477, "sample_time_ms": 11590.182, "load_time_ms": 23.723, "load_throughput": 168616.083, "learn_time_ms": 10064.187, "learn_throughput": 397.449, "synch_weights_time_ms": 7.489}, "counters": {"num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "episodes_total": 34, "training_iteration": 284, "trial_id": "40f87_00000", "date": "2023-09-21_14-04-25", "timestamp": 1695276265, "time_this_iter_s": 21.7260525226593, "time_total_s": 6194.788049459457, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6194.788049459457, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 32.35666666666667, "ram_util_percent": 55.12666666666667}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6590578377006515, "cur_kl_coeff": 5.395683899678262e-15, "cur_lr": 9.864e-06, "total_loss": -0.019472224649410737, "policy_loss": -0.019478320503235263, "vf_loss": 0.06095228104987332, "vf_explained_var": -0.11156799055395587, "kl": 0.0033491798270682657, "entropy": 0.32003582341055714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 141112.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 21676.458, "sample_time_ms": 11580.708, "load_time_ms": 23.688, "load_throughput": 168859.616, "learn_time_ms": 10063.713, "learn_throughput": 397.468, "synch_weights_time_ms": 7.553}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 34, "training_iteration": 285, "trial_id": "40f87_00000", "date": "2023-09-21_14-04-46", "timestamp": 1695276286, "time_this_iter_s": 21.71975016593933, "time_total_s": 6216.507799625397, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6216.507799625397, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 30.35483870967742, "ram_util_percent": 55.038709677419334}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6970256919101361, "cur_kl_coeff": 2.697841949839131e-15, "cur_lr": 9.86e-06, "total_loss": -0.009632885014364165, "policy_loss": -0.009640549624060852, "vf_loss": 0.07665374067296545, "vf_explained_var": -0.1003655166395249, "kl": 0.0028987631865888966, "entropy": 0.33834445722881823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 141608.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 21668.061, "sample_time_ms": 11575.86, "load_time_ms": 23.685, "load_throughput": 168883.243, "learn_time_ms": 10060.22, "learn_throughput": 397.606, "synch_weights_time_ms": 7.4}, "counters": {"num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "episodes_total": 34, "training_iteration": 286, "trial_id": "40f87_00000", "date": "2023-09-21_14-05-08", "timestamp": 1695276308, "time_this_iter_s": 21.607203006744385, "time_total_s": 6238.115002632141, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6238.115002632141, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 30.37666666666666, "ram_util_percent": 55.13}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5631410414052587, "cur_kl_coeff": 1.3489209749195654e-15, "cur_lr": 9.856e-06, "total_loss": -0.01983789395495889, "policy_loss": -0.019850652773804482, "vf_loss": 0.12760031502693892, "vf_explained_var": -0.08474120437618225, "kl": 0.002600698603763233, "entropy": 0.31378631299782184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 142104.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1148000, "timers": {"training_iteration_time_ms": 21725.904, "sample_time_ms": 11592.039, "load_time_ms": 23.585, "load_throughput": 169598.053, "learn_time_ms": 10101.783, "learn_throughput": 395.97, "synch_weights_time_ms": 7.297}, "counters": {"num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "done": false, "episodes_total": 34, "training_iteration": 287, "trial_id": "40f87_00000", "date": "2023-09-21_14-05-30", "timestamp": 1695276330, "time_this_iter_s": 22.23059892654419, "time_total_s": 6260.345601558685, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6260.345601558685, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 34.05806451612903, "ram_util_percent": 55.267741935483876}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.600797448818001, "cur_kl_coeff": 6.744604874597827e-16, "cur_lr": 9.852000000000002e-06, "total_loss": -0.01401192706168419, "policy_loss": -0.014021073069964205, "vf_loss": 0.09145302827575154, "vf_explained_var": -0.046317946165800095, "kl": 0.002436051089640844, "entropy": 0.31820503411994827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 142600.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 21878.161, "sample_time_ms": 11636.294, "load_time_ms": 23.572, "load_throughput": 169693.257, "learn_time_ms": 10209.501, "learn_throughput": 391.792, "synch_weights_time_ms": 7.694}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 34, "training_iteration": 288, "trial_id": "40f87_00000", "date": "2023-09-21_14-05-54", "timestamp": 1695276354, "time_this_iter_s": 23.20909857749939, "time_total_s": 6283.554700136185, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6283.554700136185, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 40.86363636363637, "ram_util_percent": 55.88484848484848}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6148099016037679, "cur_kl_coeff": 3.3723024372989136e-16, "cur_lr": 9.848000000000001e-06, "total_loss": -0.015458048652714839, "policy_loss": -0.01546966264868388, "vf_loss": 0.11611909809101734, "vf_explained_var": 0.0531203375468331, "kl": 0.0029596365562095293, "entropy": 0.3327244243794872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 143096.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000, "num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1156000, "timers": {"training_iteration_time_ms": 22028.118, "sample_time_ms": 11747.193, "load_time_ms": 23.472, "load_throughput": 170417.205, "learn_time_ms": 10248.76, "learn_throughput": 390.291, "synch_weights_time_ms": 7.694}, "counters": {"num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000}, "done": false, "episodes_total": 34, "training_iteration": 289, "trial_id": "40f87_00000", "date": "2023-09-21_14-06-17", "timestamp": 1695276377, "time_this_iter_s": 23.13954210281372, "time_total_s": 6306.694242238998, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6306.694242238998, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 39.815625, "ram_util_percent": 55.853125}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6008327949431634, "cur_kl_coeff": 1.6861512186494568e-16, "cur_lr": 9.844000000000001e-06, "total_loss": -0.06684279450799353, "policy_loss": -0.06685006410577532, "vf_loss": 0.0726889663511106, "vf_explained_var": 0.003752700984477997, "kl": 0.0034151750806430277, "entropy": 0.34572057738419504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 143592.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 22086.806, "sample_time_ms": 11782.628, "load_time_ms": 23.569, "load_throughput": 169714.886, "learn_time_ms": 10271.819, "learn_throughput": 389.415, "synch_weights_time_ms": 7.691}, "counters": {"num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "episodes_total": 34, "training_iteration": 290, "trial_id": "40f87_00000", "date": "2023-09-21_14-06-39", "timestamp": 1695276399, "time_this_iter_s": 22.25730586051941, "time_total_s": 6328.951548099518, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6328.951548099518, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 33.99032258064516, "ram_util_percent": 55.64516129032259}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6506748311822453, "cur_kl_coeff": 8.430756093247284e-17, "cur_lr": 9.84e-06, "total_loss": -0.04071722023593705, "policy_loss": -0.04072346522157351, "vf_loss": 0.06245004643325604, "vf_explained_var": -0.1521790937310265, "kl": 0.003047550322197253, "entropy": 0.3382628179726101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 144088.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 22257.032, "sample_time_ms": 11918.641, "load_time_ms": 23.566, "load_throughput": 169737.379, "learn_time_ms": 10306.035, "learn_throughput": 388.122, "synch_weights_time_ms": 7.79}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 34, "training_iteration": 291, "trial_id": "40f87_00000", "date": "2023-09-21_14-07-02", "timestamp": 1695276422, "time_this_iter_s": 23.419100999832153, "time_total_s": 6352.37064909935, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6352.37064909935, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 42.13333333333333, "ram_util_percent": 55.96666666666667}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6419700552378932, "cur_kl_coeff": 4.215378046623642e-17, "cur_lr": 9.836e-06, "total_loss": -0.02255807400891377, "policy_loss": -0.022563309293717235, "vf_loss": 0.05236741789286175, "vf_explained_var": -0.3631804322283114, "kl": 0.0032135092097992754, "entropy": 0.3560329145120998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 144584.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 22294.771, "sample_time_ms": 11943.711, "load_time_ms": 23.572, "load_throughput": 169695.145, "learn_time_ms": 10319.195, "learn_throughput": 387.627, "synch_weights_time_ms": 7.49}, "counters": {"num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "episodes_total": 34, "training_iteration": 292, "trial_id": "40f87_00000", "date": "2023-09-21_14-07-25", "timestamp": 1695276445, "time_this_iter_s": 22.108853578567505, "time_total_s": 6374.4795026779175, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6374.4795026779175, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 34.9225806451613, "ram_util_percent": 55.78387096774192}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6545837460866859, "cur_kl_coeff": 2.107689023311821e-17, "cur_lr": 9.832e-06, "total_loss": -0.029496702425897258, "policy_loss": -0.02950436600522446, "vf_loss": 0.0766319967768786, "vf_explained_var": -0.19640662388936167, "kl": 0.004021146332725131, "entropy": 0.37840285308418736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 145080.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000, "num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1172000, "timers": {"training_iteration_time_ms": 22465.455, "sample_time_ms": 12086.94, "load_time_ms": 23.672, "load_throughput": 168977.306, "learn_time_ms": 10346.556, "learn_throughput": 386.602, "synch_weights_time_ms": 7.488}, "counters": {"num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000}, "done": false, "episodes_total": 34, "training_iteration": 293, "trial_id": "40f87_00000", "date": "2023-09-21_14-07-48", "timestamp": 1695276468, "time_this_iter_s": 23.3756685256958, "time_total_s": 6397.855171203613, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6397.855171203613, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 44.303030303030305, "ram_util_percent": 56.5909090909091}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6302273490976903, "cur_kl_coeff": 1.0538445116559105e-17, "cur_lr": 9.828e-06, "total_loss": -0.018508419777537064, "policy_loss": -0.01851950424362815, "vf_loss": 0.1108485936833125, "vf_explained_var": -0.1382976972287701, "kl": 0.004651381560780774, "entropy": 0.42296171146294764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 145576.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 22642.107, "sample_time_ms": 12181.932, "load_time_ms": 23.672, "load_throughput": 168977.817, "learn_time_ms": 10428.313, "learn_throughput": 383.571, "synch_weights_time_ms": 7.391}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 34, "training_iteration": 294, "trial_id": "40f87_00000", "date": "2023-09-21_14-08-12", "timestamp": 1695276492, "time_this_iter_s": 23.49554181098938, "time_total_s": 6421.350713014603, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6421.350713014603, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 42.803030303030305, "ram_util_percent": 56.618181818181824}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6397143111474091, "cur_kl_coeff": 5.2692225582795525e-18, "cur_lr": 9.824000000000001e-06, "total_loss": -0.02003076276460272, "policy_loss": -0.02004019373505857, "vf_loss": 0.09429703368955562, "vf_explained_var": 0.012298778300323793, "kl": 0.0035269450863519613, "entropy": 0.3753972731290325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 146072.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000, "num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1180000, "timers": {"training_iteration_time_ms": 22753.434, "sample_time_ms": 12281.221, "load_time_ms": 23.703, "load_throughput": 168755.838, "learn_time_ms": 10440.284, "learn_throughput": 383.131, "synch_weights_time_ms": 7.327}, "counters": {"num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "done": false, "episodes_total": 34, "training_iteration": 295, "trial_id": "40f87_00000", "date": "2023-09-21_14-08-34", "timestamp": 1695276514, "time_this_iter_s": 22.834927082061768, "time_total_s": 6444.185640096664, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6444.185640096664, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 39.183870967741946, "ram_util_percent": 56.40645161290325}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6457700216842275, "cur_kl_coeff": 2.6346112791397762e-18, "cur_lr": 9.820000000000001e-06, "total_loss": -0.035849504568989596, "policy_loss": -0.03585784288401145, "vf_loss": 0.08336562423726483, "vf_explained_var": -0.17842092593350717, "kl": 0.0032445728481413486, "entropy": 0.40483327185915363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 146568.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 22842.49, "sample_time_ms": 12322.077, "load_time_ms": 23.706, "load_throughput": 168730.21, "learn_time_ms": 10488.527, "learn_throughput": 381.369, "synch_weights_time_ms": 7.38}, "counters": {"num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "episodes_total": 34, "training_iteration": 296, "trial_id": "40f87_00000", "date": "2023-09-21_14-08-57", "timestamp": 1695276537, "time_this_iter_s": 22.497029781341553, "time_total_s": 6466.682669878006, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6466.682669878006, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 36.415625000000006, "ram_util_percent": 56.178124999999994}}
{"custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7319836307677531, "cur_kl_coeff": 1.3173056395698881e-18, "cur_lr": 9.816e-06, "total_loss": -0.03639646734471523, "policy_loss": -0.03640334115874383, "vf_loss": 0.06871688728701443, "vf_explained_var": -0.14544761481304322, "kl": 0.002996317536547513, "entropy": 0.4242808006463512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.74193548387096, "num_grad_updates_lifetime": 147064.5, "diff_num_grad_updates_vs_sampler_policy": 247.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"portfolio_return_mean": 2960.9523529411767, "portfolio_return_min": -100.0, "portfolio_return_max": 20316.2, "position_changes_mean": 33.89470588235294, "position_changes_min": 30.61, "position_changes_max": 42.48, "max_drawdown_mean": -81.07470588235294, "max_drawdown_min": -100.0, "max_drawdown_max": -50.23}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}}, "episode_reward_max": -76.72511490060833, "episode_reward_min": -645.2592399041613, "episode_reward_mean": -262.52280522542503, "episode_len_mean": 33059.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-645.2592399041613, -635.5095288966203, -463.94474069421307, -480.9107218744635, -399.667962140952, -381.9306348211175, -392.88995814233385, -385.3771935504596, -342.95932716537146, -383.7222933805521, -298.20876741041553, -299.5892383674506, -271.80540610776194, -281.8817221388749, -226.92375382589813, -223.3248565851711, -220.79148023077298, -233.57818206297722, -244.8168792540177, -230.60773429879296, -185.3377381591695, -193.32933886890473, -184.41508749140255, -180.57731936483773, -134.18816005950276, -144.9875806128748, -140.7985906163479, -123.42765195624845, -109.66995991224961, -137.84159387405683, -83.3128126086049, -97.08962779322727, -90.37518059403929, -76.72511490060833], "episode_lengths": [33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059, 33059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.480823679126972, "mean_inference_ms": 3.069339256990927, "mean_action_processing_ms": 0.14444246120955279, "mean_env_wait_ms": 2.0377648291651616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008823591120102826, "MeanStdObservationFilterAgentConnector_ms": 0.05603327470667222, "StateBufferConnector_ms": 0.002928341136259191, "ViewRequirementAgentConnector_ms": 0.2017063253066119}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 22963.3, "sample_time_ms": 12417.655, "load_time_ms": 23.706, "load_throughput": 168732.756, "learn_time_ms": 10513.962, "learn_throughput": 380.446, "synch_weights_time_ms": 7.379}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 34, "training_iteration": 297, "trial_id": "40f87_00000", "date": "2023-09-21_14-09-20", "timestamp": 1695276560, "time_this_iter_s": 23.43769931793213, "time_total_s": 6490.120369195938, "pid": 24712, "hostname": "DESKTOP-VQNVLBP", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "TradingEnv2", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 8e-06, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.3, vf_clip_param=10.0, entropy_coeff=0.0, vf_loss_coeff=0.0001, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": [[0, 0.1], [1000, 0.01], [10000, 0.001], [100000, 0.0001], [1000000, 1e-05], [10000000, 1e-06], [100000000, 1e-07]], "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 16, "shuffle_sequences": true, "vf_loss_coeff": 0.0001, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000216FC186A60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray_callback.TradeMetricsCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6490.120369195938, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 44.76363636363637, "ram_util_percent": 56.127272727272725}}
